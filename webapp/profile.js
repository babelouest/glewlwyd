!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var a=t();for(var n in a)("object"==typeof exports?exports:e)[n]=a[n]}}(window,function(){return function(e){function t(t){for(var n,i,o=t[0],l=t[1],c=t[2],m=0,f=[];m<o.length;m++)i=o[m],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&f.push(r[i][0]),r[i]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);for(u&&u(t);f.length;)f.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],n=!0,o=1;o<a.length;o++){var l=a[o];0!==r[l]&&(n=!1)}n&&(s.splice(t--,1),e=i(i.s=a[0]))}return e}var n={},r={4:0},s=[];function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=n,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var o=window.webpackJsonp=window.webpackJsonp||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=l;return s.push([22,0,5]),a()}({12:function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(1);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,n.Component);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=u(e);if(t){var r=u(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return function(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?c(e):t}(this,a)}}(t);function t(a){var n;return function(e,a){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),(n=e.call(this,a)).state={title:a.title,message:a.message,cb:a.callback},n.closeModal=n.closeModal.bind(c(n)),n}return function(e,t,a){t&&o(e.prototype,t)}(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({title:e.title,message:e.message,cb:e.callback})}},{key:"closeModal",value:function(e,t){this.state.cb&&this.state.cb(t)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"modal fade on-top",id:"confirmModal",tabIndex:"-1",role:"dialog","aria-labelledby":"confirmModalLabel","aria-hidden":"true"},r.a.createElement("div",{className:"modal-dialog",role:"document"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title",id:"confirmModalLabel"},this.state.title),r.a.createElement("button",{type:"button",className:"close","aria-label":s.a.t("modal.close"),onClick:function(t){return e.closeModal(t,!1)}},r.a.createElement("span",{"aria-hidden":"true"},"×"))),r.a.createElement("div",{className:"modal-body"},this.state.message),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(t){return e.closeModal(t,!1)}},s.a.t("modal.close")),r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(t){return e.closeModal(t,!0)}},s.a.t("modal.ok"))))))}}]),t}();t.a=m},2:function(e,t,a){"use strict";function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=new(function(){function e(){!function(t,a){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.subscriberList={}}return function(e,t,a){t&&n(e.prototype,t)}(e,[{key:"subscribe",value:function(e,t){this.subscriberList[e]=t}},{key:"sendMessage",value:function(e,t){if(Array.isArray(e)||(e=[e]),"broadcast"===e[0])this.subscriberList.forEach(function(e,a){e({type:"broadcast",message:t})});else for(var a in this.subscriberList)0<=e.indexOf(a)&&this.subscriberList[a](t)}}]),e}());t.a=r},22:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(5),i=a.n(s),o=a(1),l=a(10),c=a(11),u=a(3),m=a(2),f=a(4);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function g(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,n.Component);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=b(e);if(t){var r=b(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return function(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?y(e):t}(this,a)}}(t);function t(a){var n;return function(e,a){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),(n=e.call(this,a)).state={config:a.config,curNav:"profile",loggedIn:a.loggedIn,schemeList:a.schemeList,profileList:a.profileList,dataHighlight:a.dataHighlight,schemeHighlight:a.schemeHighlight,registering:a.registering},n.navigate=n.navigate.bind(y(n)),n.toggleLogin=n.toggleLogin.bind(y(n)),n.changeLang=n.changeLang.bind(y(n)),n.changeProfile=n.changeProfile.bind(y(n)),n.gotoManageUsers=n.gotoManageUsers.bind(y(n)),m.a.subscribe("Nav",function(e){"profile"===e.type?n.navigate(!1,"profile",null):n.navigate(!1,e.page,e.type)}),n}return function(e,t,a){t&&g(e.prototype,t)}(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({loggedIn:e.loggedIn,schemeList:e.schemeList,profileList:e.profileList,dataHighlight:e.dataHighlight,schemeHighlight:e.schemeHighlight,registering:e.registering})}},{key:"navigate",value:function(e,t,a){e&&e.preventDefault(),m.a.sendMessage("App",{type:"nav",page:t,module:a}),this.setState({curNav:t})}},{key:"toggleLogin",value:function(){if(this.state.loggedIn)u.a.glewlwydRequest("/auth/?username="+encodeURIComponent(this.state.profileList[0].username),"DELETE").then(function(){m.a.sendMessage("Notification",{type:"info",message:o.a.t("login.success-delete-session")}),m.a.sendMessage("App",{type:"loggedIn",loggedIn:!1})}).fail(function(e){401!==e.status&&m.a.sendMessage("Notification",{type:"danger",message:o.a.t("login.error-delete-session")}),m.a.sendMessage("App",{type:"loggedIn",loggedIn:!1})});else{var e=!1;this.state.config.sessionSchemes.forEach(function(t){t.scheme_default&&t.scheme_default.forEach(function(a){"profile"===a&&(e=t.scheme_name)})}),document.location.href=this.state.config.LoginUrl+"?callback_url="+encodeURIComponent([location.protocol,"//",location.host,location.pathname].join(""))+"&scope="+encodeURIComponent(this.state.config.profile_scope)+(e?"&scheme="+encodeURIComponent(e):"")}}},{key:"changeLang",value:function(e,t){var a=this;o.a.changeLanguage(t).then(function(){a.setState({lang:t}),m.a.sendMessage("App",{type:"lang"})})}},{key:"changeProfile",value:function(e,t){if(t)u.a.glewlwydRequest("/auth/","POST",{username:t.username}).then(function(){m.a.sendMessage("App",{type:"profile"})}).fail(function(){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("login.error-login")})});else{var a=!1;this.state.config.sessionSchemes.forEach(function(e){e.scheme_default&&e.scheme_default.forEach(function(t){"admin"===t&&(a=e.scheme_name)})}),document.location.href=this.state.config.LoginUrl+"?callback_url="+encodeURIComponent([location.protocol,"//",location.host,location.pathname].join(""))+"&scope="+encodeURIComponent(this.state.config.profile_scope)+(a?"&scheme="+encodeURIComponent(a):"")+"&prompt=login"}}},{key:"gotoManageUsers",value:function(e){e.preventDefault(),document.location.href=this.state.config.LoginUrl+"?callback_url="+encodeURIComponent([location.protocol,"//",location.host,location.pathname].join(""))+"&scope="+encodeURIComponent(this.state.config.profile_scope)+"&prompt=select_account"}},{key:"userHasScope",value:function(e,t){var a=!1;return t&&e.scope&&e.scope.length&&t.split(" ").forEach(function(t){-1<e.scope.indexOf(t)&&(a=!0)}),a}},{key:"render",value:function(){var e,t,a,n,s,i,l,c=this,u=[],m=[],f=[],p="",g="",h=!0;if(this.state.config.lang.forEach(function(e,t){e===o.a.language?u.push(r.a.createElement("a",{className:"dropdown-item active",href:"#",key:t},e)):u.push(r.a.createElement("a",{className:"dropdown-item",href:"#",onClick:function(t){return c.changeLang(t,e)},key:t},e))}),this.state.schemeList.forEach(function(e,t){var a="";c.state.schemeHighlight[e.name]&&(h=!1,a=" required-field"),"retype-password"!==e.module&&"email"!==e.module&&m.push(r.a.createElement("li",{className:"nav-item"+(c.state.curNav===e.name?" active":""),key:t},r.a.createElement("a",{className:"nav-link"+a,href:"#","data-toggle":"collapse","data-target":".navbar-collapse.show",onClick:function(t){return c.navigate(t,e.name,e.module)}},e.display_name||e.name)))}),this.state.config.params.delegate||this.state.config.params.register||!this.state.loggedIn||(n=r.a.createElement("li",{className:"nav-item"+("password"===this.state.curNav?" active":"")},r.a.createElement("a",{className:"nav-link",href:"#","data-toggle":"collapse","data-target":".navbar-collapse.show",onClick:function(e){return c.navigate(e,"password",null)}},o.a.t("profile.menu-password")))),this.state.profileList&&!this.state.config.params.register&&(s=r.a.createElement("li",{className:"nav-item"+("session"===this.state.curNav?" active":"")},r.a.createElement("a",{className:"nav-link",href:"#","data-toggle":"collapse","data-target":".navbar-collapse.show",onClick:function(e){return c.navigate(e,"session",null)}},o.a.t("profile.menu-session")))),this.state.profileList&&this.state.profileList.forEach(function(e,t){c.userHasScope(e,c.state.config.profile_scope)?f.push(r.a.createElement("a",{className:"dropdown-item"+(t?"":" active"),href:"#","data-toggle":"collapse","data-target":".navbar-collapse.show",onClick:function(t){return c.changeProfile(t,e)},key:t},e.name||e.username)):f.push(r.a.createElement("a",{className:"dropdown-item glwd-nav-user-unavailable"+(t?"":" active"),key:t,href:"#",disabled:!0},e.name||e.username))}),(this.state.loggedIn||this.state.config.params.register&&this.state.registering)&&(i=r.a.createElement("li",{className:"nav-item"+("profile"===this.state.curNav?" active":"")},r.a.createElement("a",{className:"nav-link"+p,href:"#","data-toggle":"collapse","data-target":".navbar-collapse.show",onClick:function(e){return c.navigate(e,"profile",null)}},o.a.t("profile.menu-user")))),this.state.config.params.delegate||(f.push(r.a.createElement("div",{className:"dropdown-divider",key:f.length})),f.push(r.a.createElement("a",{className:"dropdown-item",href:"#",onClick:function(e){return c.changeProfile(e,null)},key:f.length},o.a.t("profile.menu-session-new"))),f.push(r.a.createElement("a",{className:"dropdown-item",href:"#",onClick:function(e){return c.gotoManageUsers(e)},key:f.length},o.a.t("login.manage-users")))),!this.state.config.params.register&&this.state.profileList&&this.state.profileList[0]){if(this.state.config.profilePicture&&this.state.profileList[0][this.state.config.profilePicture.property]){var y=this.state.profileList[0][this.state.config.profilePicture.property];Array.isArray(y)&&(y=y[0]),l=r.a.createElement("div",{className:"glwd-nav-picture-div"},r.a.createElement("img",{className:"img-medium glwd-nav-picture-image",src:"data:image/*;base64,"+y}),this.state.profileList[0].username)}else l=r.a.createElement("div",{className:"glwd-nav-picture-div"},r.a.createElement("img",{className:"img-medium glwd-nav-picture-spacer",src:"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="})," ",r.a.createElement("i",{className:"fas fa-user"}," "),this.state.profileList[0].username);t=r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{className:"btn btn-secondary dropdown-toggle",type:"button",id:"dropdownProfile","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},r.a.createElement("div",{className:"glwd-nav-picture-container"},l)),r.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"dropdownProfile"},f)),this.state.config.params.delegate||(a=r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:this.toggleLogin,title:o.a.t(this.state.loggedIn?"title-logout":"title-login")},this.state.loggedIn?r.a.createElement("i",{className:"fas fa-sign-out-alt btn-icon"}):r.a.createElement("i",{className:"fas fa-sign-in-alt btn-icon"})))}else this.state.config.params.register||this.state.config.params.delegate?this.state.dataHighlight&&(h=!1,p=" required-field"):a=r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:this.toggleLogin,title:o.a.t(this.state.loggedIn?"title-logout":"title-login")},this.state.loggedIn?r.a.createElement("i",{className:"fas fa-sign-out-alt btn-icon"}):r.a.createElement("i",{className:"fas fa-sign-in-alt btn-icon"}));return this.state.registering&&(g=h?r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{className:"btn btn-success",href:"#","data-toggle":"collapse","data-target":".navbar-collapse.show",onClick:function(e){return c.navigate(e,"profile",null)}},o.a.t("profile.register-profile-nav-complete"))):r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{className:"btn btn-danger",href:"#","data-toggle":"collapse","data-target":".navbar-collapse.show",onClick:function(e){return c.navigate(e,"profile",null)}},o.a.t("profile.register-profile-nav-incomplete")))),r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},r.a.createElement("a",{className:"navbar-brand",href:"#","data-toggle":"collapse"},r.a.createElement("img",{className:"mr-3",src:"img/logo-profile.png",alt:"logo"}),o.a.t("profile.menu-title")),r.a.createElement("button",(d(e={className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":".navbar-collapse.show"},"data-target","#navbarSupportedContent"),d(e,"aria-controls","navbarSupportedContent"),d(e,"aria-expanded","false"),d(e,"aria-label","Toggle navigation"),e),r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent"},r.a.createElement("ul",{className:"navbar-nav mr-auto"},i,s,n,m,g),r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{className:"btn btn-secondary dropdown-toggle",type:"button",id:"dropdownLang","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},r.a.createElement("i",{className:"fas fa-language"})),r.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"dropdownLang"},u)),t,a)))}}]),t}();function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var S=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(t,n.Component);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=C(e);if(t){var r=C(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return function(e,t){return!t||"object"!==E(t)&&"function"!=typeof t?k(e):t}(this,a)}}(t);function t(a){var n;return function(e,a){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),(n=e.call(this,a)).state={config:a.config,pattern:a.pattern,profile:a.profile,profileUpdate:a.profileUpdate,loggedIn:a.loggedIn,listAddValue:n.initListAdd(a.pattern),listEltConfirm:n.initListConfirm(a.pattern),updateEmail:a.updateEmail,listError:{}},n.editElt=n.editElt.bind(k(n)),n.createData=n.createData.bind(k(n)),n.initListAdd=n.initListAdd.bind(k(n)),n.initListConfirm=n.initListConfirm.bind(k(n)),n.deleteListElt=n.deleteListElt.bind(k(n)),n.changeElt=n.changeElt.bind(k(n)),n.toggleBooleanElt=n.toggleBooleanElt.bind(k(n)),n.changeListAddElt=n.changeListAddElt.bind(k(n)),n.AddListElt=n.AddListElt.bind(k(n)),n.changeEltConfirm=n.changeEltConfirm.bind(k(n)),n.changeTextArea=n.changeTextArea.bind(k(n)),n.uploadFile=n.uploadFile.bind(k(n)),n.uploadImage=n.uploadImage.bind(k(n)),n.removeImage=n.removeImage.bind(k(n)),n.editElt=n.editElt.bind(k(n)),n.saveProfile=n.saveProfile.bind(k(n)),n.confirmDeleteProfile=n.confirmDeleteProfile.bind(k(n)),n}return function(e,t,a){t&&w(e.prototype,t)}(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({config:e.config,pattern:e.pattern,profile:e.profile,profileUpdate:e.profileUpdate,loggedIn:e.loggedIn,listAddValue:this.initListAdd(e.pattern),listEltConfirm:this.initListConfirm(e.pattern),updateEmail:e.updateEmail,listError:{}},function(){t.state.loggedIn||t.setState({pattern:[],profile:[]})})}},{key:"createData",value:function(){var e={};this.state.pattern.forEach(function(t,a){t.list?e[t.name]=[]:t.defaultValue?e[t.name]=t.defaultValue:e[t.name]=""}),this.setState({data:e})}},{key:"initListAdd",value:function(e){var t={};return e&&e.forEach(function(e){e.list&&(t[e.name]="")}),t}},{key:"initListConfirm",value:function(e){var t={};return e&&e.forEach(function(e){e.confirm&&(t[e.name]="")}),t}},{key:"deleteListElt",value:function(e,t,a){var n=this.state.profile;n[t]&&(n[t].splice(a,1),this.setState({profile:n}))}},{key:"changeElt",value:function(e,t){var a=this.state.profile;a[t]=e.target.value,this.setState({profile:a})}},{key:"toggleBooleanElt",value:function(e,t){var a=this.state.profile;a[t]=!a[t],this.setState({profile:a})}},{key:"changeListAddElt",value:function(e,t){var a=this.state.listAddValue;a[t]=e.target.value,this.setState({listAddValue:a})}},{key:"AddListElt",value:function(e,t,a){var n=2<arguments.length&&void 0!==a&&a;if(e.preventDefault(),n)(r=this.state.profile)[t]||(r[t]=[]),r[t].push(n),this.setState({profile:r});else if(this.state.listAddValue[t]){var r=this.state.profile,s=this.state.listAddValue;r[t].push(this.state.listAddValue[t]),this.state.listAddValue[t]="",this.setState({profile:r,listAddValue:s})}}},{key:"changeEltConfirm",value:function(e,t){var a=this.state.listEltConfirm;a[t]=e.target.value,this.setState({listEltConfirm:a})}},{key:"changeTextArea",value:function(e,t,a){var n=this.state.profile;n[t]=a?e.target.value.split("\n"):e.target.value,this.setState({profile:n})}},{key:"uploadFile",value:function(e,t,a){var n=this,r=this.state.profile,s=e.target.files[0],i=new FileReader;i.onload=function(e){a?(r[t]||(r[t]=[]),r[t].push(s.name+"/"+btoa(e.target.result))):r[t]=s.name+"/"+btoa(e.target.result),n.setState({profile:r})},i.readAsText(s)}},{key:"uploadImage",value:function(e,t,a){var n=this,r=this.state.profile,s=e.target.files[0],i=new FileReader;i.onload=function(e){a?(r[t]||(r[t]=[]),r[t].push(btoa(e.target.result))):r[t]=btoa(e.target.result),n.setState({profile:r})},i.readAsBinaryString(s)}},{key:"removeImage",value:function(e,t,a){var n=this.state.profile;-1<a?n[t].splice(a,1):delete n[t],this.setState({profile:n})}},{key:"saveProfile",value:function(e){u.a.glewlwydRequest("/profile","PUT",this.state.profile).then(function(e){m.a.sendMessage("Notification",{type:"success",message:o.a.t("profile.save-profile-success")})}).fail(function(e){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("profile.save-profile-error")})})}},{key:"deleteProfile",value:function(e){m.a.sendMessage("App",{type:"confirm",title:o.a.t("profile.delete-profile-title"),message:o.a.t("profile.delete-profile-message"),callback:this.confirmDeleteProfile})}},{key:"confirmDeleteProfile",value:function(e){e&&u.a.glewlwydRequest("/profile","DELETE",this.state.profile).then(function(e){m.a.sendMessage("Notification",{type:"success",message:o.a.t("profile.delete-profile-success")}),m.a.sendMessage("App",{type:"profile"})}).fail(function(e){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("profile.delete-profile-error")})}),m.a.sendMessage("App",{type:"closeConfirm"})}},{key:"updateEmailModal",value:function(e){m.a.sendMessage("App",{type:"updateEmail",module:e})}},{key:"editElt",value:function(e,t,a){var n,s,i=this,l=[],c=!1;if((void 0!==t||"password"===e.type||e.forceShow)&&e["profile-read"]){var u="",m="";if(this.state.listError[e.name]&&(u=" is-invalid",m=r.a.createElement("span",{className:"error-input"},o.a.t(this.state.listError[e.name]))),n=r.a.createElement("label",{htmlFor:"modal-edit-"+e.name},o.a.t(e.label)),e.list){if(t=t||[],e.listElements){var f=[];e.listElements.forEach(function(t,a){f.push(r.a.createElement("a",{className:"dropdown-item",key:a,href:"#",onClick:function(a){return i.AddListElt(a,e.name,t)}},t))}),s=r.a.createElement("div",{className:"dropdown"},r.a.createElement("button",{className:"btn btn-secondary btn-sm dropdown-toggle",type:"button",id:"modal-edit-"+e.name,"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},r.a.createElement("i",{className:"fas fa-plus"})),r.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"modal-edit-"+e.name},f))}else if("textarea"===e.type)s=r.a.createElement("textarea",{className:"form-control"+u,onChange:function(t){return i.changeTextArea(t,e.name,!0)},value:t.join("\n"),placeholder:e.placeholder?o.a.t(e.placeholder):""});else if("file"===e.type)s=e["profile-write"]||this.state.add?r.a.createElement("input",{type:"file",className:"form-control"+u,onChange:function(t){return i.uploadFile(t,e.name,!0)}}):r.a.createElement("input",{type:"file",disabled:!0,className:"form-control"});else if(e.type&&e.type.startsWith("image")){var p=[];t.forEach(function(t,a){p.push(r.a.createElement("a",{href:"#",onClick:function(t){return i.removeImage(t,e.name,a)},title:o.a.t("remove")},r.a.createElement("img",{key:a,className:"btn-icon-right img-thumb",src:"data:"+e.type+";base64,"+t,alt:e.name+"-"+a}),r.a.createElement("span",{className:"badge badge-secondary align-top"},r.a.createElement("i",{className:"fas fa-trash"}))))}),e.edit||this.state.add?s=r.a.createElement("div",null,r.a.createElement("div",{className:"custom-file"},r.a.createElement("input",{type:"file",className:"custom-file-input"+u,accept:"image/*",onChange:function(t){return i.uploadImage(t,e.name,!0)},id:"modal-image-"+e.name}),r.a.createElement("label",{className:"custom-file-label",htmlFor:"modal-image-"+e.name},o.a.t("browse"))),p):(p=[],t.forEach(function(t,a){p.push(r.a.createElement("img",{key:a,className:"btn-icon-right img-thumb",src:"data:"+e.type+";base64,"+t,alt:e.name+"-"+a}))}),s=p)}else e["profile-write"]&&(s=r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{type:"text",className:"form-control"+u,id:"modal-edit-"+e.name,placeholder:e.placeholder?o.a.t(e.placeholder):"",onChange:function(t){return i.changeListAddElt(t,e.name)},value:this.state.listAddValue[e.name]}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("button",{className:"btn btn-outline-secondary",type:"button",onClick:function(t){return i.AddListElt(t,e.name)},title:o.a.t("modal.list-add-title")},r.a.createElement("i",{className:"fas fa-plus"})))));t.forEach(function(t,a){var n=t;"file"===e.type&&(n=t.substring(0,t.indexOf("/"))),(!e.type||"textarea"===e.type||e.type.startsWith("image"))&&e.type||(!0===e["profile-write"]||i.state.add?l.push(r.a.createElement("a",{href:"#",onClick:function(t){return i.deleteListElt(t,e.name,a)},key:a},r.a.createElement("span",{className:"badge badge-primary btn-icon-right"},n,r.a.createElement("span",{className:"badge badge-light btn-icon-right"},r.a.createElement("i",{className:"fas fa-times"}))))):l.push(r.a.createElement("span",{className:"badge badge-primary btn-icon-right",key:a},n)))})}else if("boolean"===e.type)c=!0===e["profile-write"]||this.state.add?r.a.createElement("div",{className:"form-group form-check"},r.a.createElement("input",{type:"checkbox",className:"form-check-input"+u,id:"modal-edit-"+e.name,onChange:function(t){return i.toggleBooleanElt(t,e.name)},checked:t}),r.a.createElement("label",{className:"form-check-label",htmlFor:"modal-edit-"+e.name},o.a.t(e.label))):r.a.createElement("div",{className:"form-group form-check"},r.a.createElement("input",{disabled:!0,type:"checkbox",className:"form-check-input",id:"modal-edit-"+e.name,checked:t}),r.a.createElement("label",{className:"form-check-label",htmlFor:"modal-edit-"+e.name},o.a.t(e.label)));else if("textarea"===e.type)s=!0===e["profile-write"]||this.state.add?r.a.createElement("textarea",{className:"form-control"+u,onChange:function(t){return i.changeTextArea(t,e.name,!1)},value:t||"",placeholder:e.placeholder?o.a.t(e.placeholder):""}):r.a.createElement("textarea",{className:"form-control",disabled:!0,value:t||""});else if("file"===e.type)t&&l.push(r.a.createElement("a",{href:"#",key:0,onClick:function(t){return i.deleteFile(t,e.name)}},r.a.createElement("span",{className:"badge badge-primary"},t.substring(0,t.indexOf("/")),r.a.createElement("span",{className:"badge badge-light btn-icon-right"},r.a.createElement("i",{className:"fas fa-times"}))))),s=e["profile-write"]||this.state.add?r.a.createElement("input",{type:"file",className:"form-control"+u,onChange:function(t){return i.uploadFile(t,e.name)}}):r.a.createElement("input",{type:"file",disabled:!0,className:"form-control"});else if(e.type&&e.type.startsWith("image"))t&&(p=r.a.createElement("a",{href:"#",onClick:function(t){return i.removeImage(t,e.name,-1)},title:o.a.t("remove")},r.a.createElement("img",{className:"btn-icon-right img-thumb",src:"data:"+e.type+";base64,"+t,alt:e.name}),r.a.createElement("span",{className:"badge badge-secondary align-top"},r.a.createElement("i",{className:"fas fa-trash"})))),s=e.edit||this.state.add?r.a.createElement("div",null,r.a.createElement("div",{className:"custom-file"},r.a.createElement("input",{type:"file",accept:"image/*",className:"custom-file-input"+u,onChange:function(t){return i.uploadImage(t,e.name)},id:"modal-image-"+e.name}),r.a.createElement("label",{className:"custom-file-label",htmlFor:"modal-image-"+e.name},o.a.t("browse"))),p):r.a.createElement("img",{className:"btn-icon-right img-thumb",src:"data:"+e.type+";base64,"+t,alt:e.name});else if(!0===e["profile-write"]||this.state.add)s="password"===e.type?r.a.createElement("div",null,r.a.createElement("input",{type:"password",className:"form-control"+u,id:"modal-edit-"+e.name,placeholder:e.placeholder?o.a.t(e.placeholder):"",onChange:function(t){return i.changeElt(t,e.name)},value:t||"",autoComplete:"new-password"}),r.a.createElement("input",{type:"password",className:"form-control"+u,id:"modal-edit-confirm"+e.name,placeholder:o.a.t(e.placeholderConfirm),value:this.state.listEltConfirm[e.name]||"",onChange:function(t){return i.changeEltConfirm(t,e.name)},autoComplete:"new-password"})):r.a.createElement("input",{type:e.type||"text",className:"form-control"+u,id:"modal-edit-"+e.name,placeholder:e.placeholder?o.a.t(e.placeholder):"",value:t,onChange:function(t){return i.changeElt(t,e.name)}});else if("email"===e.name){var d=[];this.state.updateEmail.forEach(function(e,t){d.push(r.a.createElement("button",{key:t,className:"btn btn-outline-secondary",type:"button",onClick:function(t){return i.updateEmailModal(e)},title:o.a.t("profile.update-email-modal-title")},r.a.createElement("i",{className:"fas fa-edit"})))}),s=r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{disabled:!0,type:"text",className:"form-control"+u,id:"modal-edit-"+e.name,placeholder:e.placeholder?o.a.t(e.placeholder):"",value:t}),r.a.createElement("div",{className:"input-group-append"},d))}else s=r.a.createElement("input",{disabled:!0,type:e.type||"text",className:"form-control"+u,id:"modal-edit-"+e.name,placeholder:e.placeholder?o.a.t(e.placeholder):"",value:t})}return c||r.a.createElement("div",{className:"form-group",key:a},n,s,r.a.createElement("div",null,l),m)}},{key:"render",value:function(){var e,t=this,a=[];return this.state.pattern&&this.state.profile&&this.state.pattern.forEach(function(e,n){var r=t.editElt(e,t.state.profile[e.name],n);r&&a.push(r)}),"no"!==this.state.config.delete_profile&&(e=r.a.createElement("button",{type:"button",className:"btn btn-danger btn-icon",onClick:function(e){return t.deleteProfile(e)},disabled:!this.state.profile||!this.state.profileUpdate},o.a.t("profile.delete"))),this.state.loggedIn?r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,o.a.t("profile.hello",{name:this.state.profile.name||this.state.profile.username})))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("form",{className:"needs-validation",noValidate:!0},a))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6"},e),r.a.createElement("div",{className:"col-md-6 text-right"},r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return t.saveProfile(e)},disabled:!this.state.profile||!this.state.profileUpdate},o.a.t("profile.save"))))):r.a.createElement("div",null)}}]),t}();function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var R=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(t,n.Component);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=M(e);if(t){var r=M(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return function(e,t){return!t||"object"!==_(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}(this,a)}}(t);function t(a){var n;return function(e,a){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),(n=e.call(this,a)).state={profile:a.profile},n}return function(e,t,a){t&&P(e.prototype,t)}(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({profile:e.profile})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,o.a.t("profile.hello-delegate",{name:this.state.profile.name||this.state.profile.username})))))}}]),t}();function L(e){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var I=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(t,n.Component);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=x(e);if(t){var r=x(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return function(e,t){return!t||"object"!==L(t)&&"function"!=typeof t?A(e):t}(this,a)}}(t);function t(a){var n;return function(e,a){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),(n=e.call(this,a)).state={config:a.config,registerConfig:a.registerConfig,registerProfile:a.registerProfile,registerSchemes:a.registerSchemes,token:a.token,registerValid:a.registerValid,registerDefaultLang:a.registerDefaultLang,username:"",email:"",code:"",password:"",passwordConfirm:"",usernameValid:!1,usernameInvalid:!1,verificationSent:!1,invalidCode:!1,showCode:!1,timeout:!1,checkingUsername:!1,checkingEmail:!1,invalidMessage:!1,validMessage:!1,invalidEmailMessage:!0,invalidPassword:!1,registerComplete:!1,modifyPassword:!1},n.confirmCancelRegistration=n.confirmCancelRegistration.bind(A(n)),n.updatePassword=n.updatePassword.bind(A(n)),document.title=o.a.t("profile.register-title"),n}return function(e,t,a){t&&T(e.prototype,t)}(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,registerConfig:e.registerConfig,registerProfile:e.registerProfile,token:e.token,registerValid:e.registerValid,registerDefaultLang:e.registerDefaultLang})}},{key:"checkUsername",value:function(){var e=this;this.state.timeout&&clearTimeout(this.state.timeout),this.state.username?u.a.glewlwydRequest("/"+this.state.config.params.register+"/username","POST",{username:this.state.username}).then(function(){e.setState({timeout:!1,usernameValid:!0,usernameInvalid:!1,checkingUsername:!1,invalidMessage:!1,validMessage:!0})}).fail(function(t){400!==t.status&&m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")}),e.setState({timeout:!1,usernameValid:!1,usernameInvalid:!0,checkingUsername:!1,invalidMessage:!0,validMessage:!1})}):this.setState({timeout:!1,usernameValid:!1,usernameInvalid:!1,checkingUsername:!1,invalidMessage:!1,validMessage:!1})}},{key:"checkEmailAsUsername",value:function(){var e=this;this.state.timeout&&clearTimeout(this.state.timeout),this.state.email?u.a.glewlwydRequest("/"+this.state.config.params.register+"/username","POST",{username:this.state.email}).then(function(){e.setState({timeout:!1,usernameValid:!0,usernameInvalid:!1,checkingEmail:!1,invalidMessage:!1,validMessage:!0})}).fail(function(t){400!==t.status?(m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")}),e.setState({timeout:!1,usernameValid:!1,usernameInvalid:!0,checkingEmail:!1,invalidMessage:!0,validMessage:!1})):e.setState({timeout:!1,usernameValid:!1,usernameInvalid:!0,checkingEmail:!1,invalidMessage:!1,validMessage:!1})}):this.setState({timeout:!1,usernameValid:!1,usernameInvalid:!1,checkingEmail:!1,invalidMessage:!1,validMessage:!1})}},{key:"changeUsername",value:function(e){var t=this;e.preventDefault(),this.setState({username:e.target.value,usernameValid:!1},function(){t.state.timeout&&clearTimeout(t.state.timeout),t.setState({checkingUsername:!0,timeout:setTimeout(function(){t.checkUsername()},1e3)})})}},{key:"changeEmailVerification",value:function(e){var t=this.state.usernameValid;this.state.registerConfig["email-is-username"]&&(t=!0),this.setState({email:e.target.value,invalidEmailMessage:!e.target.value,usernameValid:t})}},{key:"changeEmailAsUsername",value:function(e){var t=this;this.setState({email:e.target.value,invalidEmailMessage:!e.target.value,usernameValid:!0},function(){t.state.timeout&&clearTimeout(t.state.timeout),t.setState({checkingEmail:!0,timeout:setTimeout(function(){t.checkEmailAsUsername()},1e3)})})}},{key:"changeCode",value:function(e){this.setState({code:e.target.value,invalidCode:!e.target.value})}},{key:"changeName",value:function(e){e.preventDefault();var t=this.state.registerProfile;t.name=e.target.value,this.setState({registerProfile:t})}},{key:"changePassword",value:function(e){var t=this;this.setState({password:e.target.value},function(){t.checkPassword()})}},{key:"changeConfirmPassword",value:function(e){var t=this;this.setState({passwordConfirm:e.target.value},function(){t.checkPassword()})}},{key:"checkPassword",value:function(){var e=!1;""===this.state.password&&""===this.state.passwordConfirm||(this.state.password!==this.state.passwordConfirm?e=o.a.t("profile.register-password-error-not-match"):this.state.password.length<(this.state.config.PasswordMinLength||8)&&(e=o.a.t("profile.register-password-ph",{car:this.state.config.PasswordMinLength||8}))),this.setState({invalidPassword:e})}},{key:"registerUsername",value:function(){u.a.glewlwydRequest("/"+this.state.config.params.register+"/register","POST",{username:this.state.username}).then(function(){m.a.sendMessage("App",{type:"registration"})}).fail(function(){400!==err.status&&m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})}},{key:"noSubmit",value:function(e){return e.preventDefault(),!1}},{key:"saveName",value:function(e){e.preventDefault(),u.a.glewlwydRequest("/"+this.state.config.params.register+"/profile","PUT",this.state.registerProfile).then(function(){m.a.sendMessage("App",{type:"registration"}),m.a.sendMessage("Notification",{type:"info",message:o.a.t("profile.register-profile-saved")})}).fail(function(e){400!==e.status&&m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})}},{key:"savePassword",value:function(e){var t=this;e.preventDefault(),!this.state.invalidPassword&&this.state.password.length>=(this.state.config.PasswordMinLength||8)?u.a.glewlwydRequest("/"+this.state.config.params.register+"/profile/password","POST",{password:this.state.password}).then(function(){m.a.sendMessage("App",{type:"registration"}),m.a.sendMessage("Notification",{type:"info",message:o.a.t("profile.register-password-saved")})}).fail(function(){400!==err.status&&m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})}).always(function(){t.setState({password:"",passwordConfirm:"",modifyPassword:!1})}):m.a.sendMessage("App",{type:"registration"})}},{key:"sendVerificationEmail",value:function(){var e=this;u.a.glewlwydRequest("/"+this.state.config.params.register+"/verify","PUT",{username:this.state.username,email:this.state.email,lang:this.state.registerDefaultLang}).then(function(){m.a.sendMessage("Notification",{type:"info",message:o.a.t("profile.register-profile-email-sent",{email:e.state.email})}),e.setState({verificationSent:!0})}).fail(function(e){400!==e.status&&m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})}},{key:"verifyCode",value:function(){var e=this;u.a.glewlwydRequest("/"+this.state.config.params.register+"/verify","POST",{username:this.state.username,email:this.state.email,code:this.state.code}).then(function(){m.a.sendMessage("App",{type:"registration"}),m.a.sendMessage("Notification",{type:"info",message:o.a.t("profile.register-profile-created")})}).fail(function(t){e.setState({invalidCode:!0},function(){400!==t.status&&m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})})}},{key:"completeRegistration",value:function(){var e=this;u.a.glewlwydRequest("/"+this.state.config.params.register+"/profile/complete","POST").then(function(){e.setState({registerComplete:!0,username:""},function(){m.a.sendMessage("Notification",{type:"info",message:o.a.t("profile.register-profile-completed")}),m.a.sendMessage("App",{type:"registrationComplete"})})}).fail(function(e){400!==e.status?m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")}):m.a.sendMessage("Notification",{type:"warning",message:o.a.t("profile.register-profile-incomplete")})})}},{key:"cancelRegistration",value:function(){m.a.sendMessage("App",{type:"confirm",title:o.a.t("profile.register-profile-cancel-title"),message:o.a.t("profile.register-profile-cancel-message"),callback:this.confirmCancelRegistration})}},{key:"confirmCancelRegistration",value:function(e){var t=this;e&&u.a.glewlwydRequest("/"+this.state.config.params.register+"/profile","DELETE").then(function(){t.setState({username:"",usernameValid:!1,email:"",verificationSent:!1,code:"",validMessage:!1,invalidMessage:!1},function(){m.a.sendMessage("Notification",{type:"info",message:o.a.t("profile.register-profile-cancelled")}),m.a.sendMessage("App",{type:"registration"})})}).fail(function(){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})}),m.a.sendMessage("App",{type:"closeConfirm"})}},{key:"updatePassword",value:function(){this.setState({modifyPassword:!0})}},{key:"changeLang",value:function(e,t){this.setState({registerDefaultLang:t})}},{key:"render",value:function(){var e,t,a,n,s=this;if(this.state.registerComplete){var i=[];if(this.state.config["register-complete"])for(var l=0;l<this.state.config["register-complete"].length;l++)this.state.config["register-complete"][l]["complete-link"]&&this.state.config["register-complete"][l].name===this.state.config.params.register&&i.push(r.a.createElement("a",{key:l,className:"btn btn-primary btn-icon-right",href:this.state.config["register-complete"][l]["complete-link"]},o.a.t(this.state.config["register-complete"][l]["complete-link-label"])));t=r.a.createElement("div",null,r.a.createElement("div",{className:"alert alert-info",role:"alert"},o.a.t("profile.register-profile-complete-message")),r.a.createElement("div",null,r.a.createElement("a",{className:"btn btn-primary",href:this.state.config.ProfileUrl},o.a.t("profile.register-profile-complete-link")),i))}else if(this.state.registerProfile){var c,u=[];if("always"!==this.state.registerConfig["set-password"]||this.state.registerProfile.password_set||u.push(r.a.createElement("li",{key:0},o.a.t("profile.register-profile-complete-step-password"))),this.state.registerConfig.schemes&&this.state.registerConfig.schemes.forEach(function(e,t){"always"!=e.register||s.state.registerSchemes[e.name]||u.push(r.a.createElement("li",{key:t+1},o.a.t("profile.register-profile-complete-step-scheme",{scheme:e.display_name||e.name})))}),c=u.length?r.a.createElement("div",{className:"alert alert-danger",role:"alert"},o.a.t("profile.register-profile-complete-steps"),r.a.createElement("ul",null,u),r.a.createElement("button",{className:"btn btn-primary btn-icon",type:"button",disabled:!0,title:o.a.t("profile.register-profile-complete")},o.a.t("profile.register-profile-complete")),r.a.createElement("button",{className:"btn btn-primary",type:"button",onClick:function(){return s.cancelRegistration()},title:o.a.t("profile.register-profile-cancel")},o.a.t("profile.register-profile-cancel"))):r.a.createElement("div",{className:"alert alert-info",role:"alert"},o.a.t("profile.register-profile-complete-possible"),r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-primary btn-icon",type:"button",onClick:function(){return s.completeRegistration()},title:o.a.t("profile.register-profile-complete")},o.a.t("profile.register-profile-complete")),r.a.createElement("button",{className:"btn btn-primary",type:"button",onClick:function(){return s.cancelRegistration()},title:o.a.t("profile.register-profile-cancel")},o.a.t("profile.register-profile-cancel")))),"no"!==this.state.registerConfig["set-password"]){var m="";!this.state.modifyPassword&&this.state.registerProfile.password_set&&(m=r.a.createElement("button",{type:"button",className:"btn btn-outline-secondary btn-sm btn-icon-right",onClick:this.updatePassword},r.a.createElement("i",{className:"fas fa-edit"}))),a=r.a.createElement("div",null,r.a.createElement("hr",null),r.a.createElement("label",{htmlFor:"password-input"},o.a.t("profile.register-password-label"),m),r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{type:"password",className:"form-control",id:"password-input",placeholder:!this.state.modifyPassword&&this.state.registerProfile.password_set?o.a.t("profile.register-password-set-ph"):o.a.t("profile.register-password-ph",{car:this.state.config.PasswordMinLength||8}),disabled:!this.state.modifyPassword&&this.state.registerProfile.password_set,onChange:function(e){return s.changePassword(e)},value:this.state.password})),r.a.createElement("label",{htmlFor:"confirm-password-input"},o.a.t("profile.register-confirm-password-label")),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("input",{type:"password",className:"form-control",id:"confirm-password-input",disabled:!this.state.modifyPassword&&this.state.registerProfile.password_set,placeholder:o.a.t(!this.state.modifyPassword&&this.state.registerProfile.password_set?"profile.register-password-set-ph":"profile.register-confirm-password-ph"),onChange:function(e){return s.changeConfirmPassword(e)},value:this.state.passwordConfirm}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("button",{className:"btn btn-secondary btn-icon",type:"button",onClick:function(e){return s.savePassword(e)},disabled:this.state.invalidPassword,title:o.a.t("save")},o.a.t("save")))),this.state.invalidPassword?r.a.createElement("span",{className:"badge badge-danger"},this.state.invalidPassword):"")}this.state.registerConfig["verify-email"]&&(n=r.a.createElement("div",null,r.a.createElement("hr",null),r.a.createElement("label",{htmlFor:"email-input"},o.a.t("profile.register-email-label")),r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{type:"text",className:"form-control",id:"email-input",disabled:!0,value:this.state.registerProfile.email||""})))),e=r.a.createElement("form",{className:"needs-validation",noValidate:!0,onSubmit:function(e){return s.noSubmit(e)}},r.a.createElement("label",{htmlFor:"username-input"},o.a.t("profile.register-profile-username-label")),r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{type:"text",className:"form-control",value:this.state.registerProfile.username,disabled:!0})),n,r.a.createElement("hr",null),r.a.createElement("label",{htmlFor:"name-input"},o.a.t("profile.register-name-label")),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("input",{type:"text",className:"form-control",id:"name-input",placeholder:o.a.t("profile.register-name-ph"),onChange:function(e){return s.changeName(e)},value:this.state.registerProfile.name||""}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("button",{className:"btn btn-secondary btn-icon",type:"button",onClick:function(e){return s.saveName(e)},title:o.a.t("save")},o.a.t("save")))),a)}else if(!this.state.registerProfile)if(this.state.registerConfig["verify-email"]){var f,p,d;if(this.state.registerDefaultLang&&1<this.state.registerConfig.languages.length){var g=[];this.state.registerConfig.languages.forEach(function(e,t){g.push(r.a.createElement("a",{key:t,className:"dropdown-item"+(s.state.registerDefaultLang===e?" active":""),href:"#",onClick:function(t){return s.changeLang(t,e)}},e))}),d=r.a.createElement("div",{className:"btn-group dropup",role:"group"},r.a.createElement("button",{className:"btn btn-success dropdown-toggle",type:"button",id:"register-profile-lang","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",disabled:!this.state.usernameValid||!this.state.email||!this.state.registerValid},this.state.registerDefaultLang),r.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"register-profile-lang"},g))}f=this.state.verificationSent?(p=r.a.createElement("div",null,r.a.createElement("hr",null),r.a.createElement("label",{htmlFor:"code-input"},o.a.t("profile.register-code-label")),r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{type:"text",className:"form-control",id:"code-input",placeholder:o.a.t("profile.register-code-ph"),onChange:function(e){return s.changeCode(e)},value:this.state.code})),this.state.invalidCode?r.a.createElement("span",{className:"badge badge-danger"},o.a.t("profile.register-code-error")):""),r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-success btn-icon",type:"button",onClick:function(){return s.verifyCode()},title:o.a.t("profile.register-profile-verify-code")},o.a.t("profile.register-profile-verify-code")),r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{className:"btn btn-success",type:"button",onClick:function(){return s.sendVerificationEmail()},title:o.a.t("profile.register-profile-reverify-email")},o.a.t("profile.register-profile-reverify-email")),d))):r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{className:"btn btn-success",type:"button",onClick:function(){return s.sendVerificationEmail()},disabled:!this.state.usernameValid||!this.state.email||!this.state.registerValid,title:o.a.t("profile.register-profile-verify-email")},o.a.t("profile.register-profile-verify-email")),d),e=this.state.registerConfig["email-is-username"]?r.a.createElement("form",{className:"needs-validation",noValidate:!0},r.a.createElement("label",{htmlFor:"email-input"},o.a.t("profile.register-email-label")),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("input",{type:"text",className:"form-control",id:"email-input",placeholder:o.a.t("profile.register-email-ph"),onChange:function(e){return s.changeEmailAsUsername(e)},disabled:this.state.verificationSent||!this.state.registerValid,value:this.state.email}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:this.state.checkingEmail?"fas fa-compass fa-spin":this.state.usernameValid?"fas fa-check":"fas fa-exclamation"})))),this.state.email?"":r.a.createElement("span",{className:"badge badge-danger"},o.a.t("profile.register-email-error")),!this.state.usernameValid&&this.state.email?r.a.createElement("span",{className:"badge badge-danger"},o.a.t("profile.register-username-error")):"",this.state.validMessage?r.a.createElement("span",{className:"badge badge-success"},o.a.t("profile.register-username-valid")):"",this.state.checkingEmail?r.a.createElement("span",{className:"badge badge-info"},o.a.t("profile.register-username-checking")):"",p,r.a.createElement("hr",null),r.a.createElement("div",{className:"input-group-append"},f)):r.a.createElement("form",{className:"needs-validation",noValidate:!0},r.a.createElement("label",{htmlFor:"username-input"},o.a.t("profile.register-username-label")),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("input",{type:"text",className:"form-control",id:"username-input",placeholder:o.a.t("profile.register-username-ph"),onChange:function(e){return s.changeUsername(e)},disabled:!this.state.registerValid,value:this.state.username}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:this.state.checkingUsername?"fas fa-compass fa-spin":this.state.invalidMessage?"fas fa-exclamation":"fas fa-check"})))),this.state.invalidMessage?r.a.createElement("span",{className:"badge badge-danger"},o.a.t("profile.register-username-error")):"",this.state.validMessage?r.a.createElement("span",{className:"badge badge-success"},o.a.t("profile.register-username-valid")):"",this.state.validMessage||this.state.invalidMessage?"":r.a.createElement("span",{className:"badge badge-info"},o.a.t("profile.register-username-empty")),r.a.createElement("hr",null),r.a.createElement("label",{htmlFor:"email-input"},o.a.t("profile.register-email-label")),r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{type:"text",className:"form-control",id:"email-input",placeholder:o.a.t("profile.register-email-ph"),onChange:function(e){return s.changeEmailVerification(e)},disabled:this.state.verificationSent||!this.state.registerValid,value:this.state.email})),this.state.invalidEmailMessage?r.a.createElement("span",{className:"badge badge-danger"},o.a.t("profile.register-email-error")):"",p,r.a.createElement("hr",null),r.a.createElement("div",{className:"input-group-append"},f))}else e=r.a.createElement("form",{className:"needs-validation",noValidate:!0},r.a.createElement("label",{htmlFor:"username-input"},o.a.t("profile.register-username-label")),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("input",{type:"text",className:"form-control",id:"username-input",placeholder:o.a.t("profile.register-username-ph"),onChange:function(e){return s.changeUsername(e)},disabled:!this.state.registerValid,value:this.state.username}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:this.state.checkingUsername?"fas fa-compass fa-spin":this.state.invalidMessage?"fas fa-exclamation":"fas fa-check"})))),this.state.invalidMessage?r.a.createElement("span",{className:"badge badge-danger"},o.a.t("profile.register-username-error")):"",this.state.validMessage?r.a.createElement("span",{className:"badge badge-success"},o.a.t("profile.register-username-valid")):"",this.state.validMessage||this.state.invalidMessage?"":r.a.createElement("span",{className:"badge badge-info"},o.a.t("profile.register-username-empty")),r.a.createElement("hr",null),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("button",{className:"btn btn-success",type:"button",onClick:function(){return s.registerUsername()},disabled:!this.state.usernameValid||!this.state.registerValid,title:o.a.t("profile.register-username-create")},o.a.t("profile.register-profile-create"))));return r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,o.a.t("profile.register-title")))),t,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6"},e)),r.a.createElement("hr",null),c)}}]),t}();function U(e){return(U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function q(e,t){return(q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function V(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var H=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&q(e,t)}(t,n.Component);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=F(e);if(t){var r=F(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return function(e,t){return!t||"object"!==U(t)&&"function"!=typeof t?V(e):t}(this,a)}}(t);function t(a){var n;return function(e,a){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),(n=e.call(this,a)).state={config:a.config,sessionList:[],plugins:a.plugins,disableObject:!1},n.fetchLists=n.fetchLists.bind(V(n)),n.getTable=n.getTable.bind(V(n)),n.disableSession=n.disableSession.bind(V(n)),n.disableSessionConfirm=n.disableSessionConfirm.bind(V(n)),n.disableToken=n.disableToken.bind(V(n)),n.disableTokenConfirm=n.disableTokenConfirm.bind(V(n)),n.fetchLists(),n}return function(e,t,a){t&&D(e.prototype,t)}(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({config:e.config,plugins:e.plugins},function(){t.fetchLists()})}},{key:"fetchLists",value:function(){var e=this;u.a.glewlwydRequest("/profile/session").then(function(t){e.setState({sessionList:t})}).fail(function(){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})}},{key:"getTable",value:function(e,t){return r.a.createElement("table",{className:"table table-responsive table-striped"},r.a.createElement("thead",null,e),r.a.createElement("tbody",null,t))}},{key:"disableSession",value:function(e){var t=this;this.setState({disableObject:e},function(){m.a.sendMessage("App",{type:"confirm",title:o.a.t("profile.session-disable-title"),message:o.a.t("profile.session-disable-message"),callback:t.disableSessionConfirm})})}},{key:"disableSessionConfirm",value:function(e){var t=this;e&&this.state.disableObject&&u.a.glewlwydRequest("/profile/session/"+this.state.disableObject.session_hash,"DELETE").then(function(e){m.a.sendMessage("Notification",{type:"info",message:o.a.t("profile.session-disabled")})}).fail(function(){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})}).always(function(){t.fetchLists(),t.setState({disableObject:!1})}),m.a.sendMessage("App",{type:"closeConfirm"})}},{key:"disableToken",value:function(e,t,a){var n=this;this.setState({disableObject:{type:e,key:t,token:a}},function(){m.a.sendMessage("App",{type:"confirm",title:o.a.t("profile.session-disable-token-title"),message:o.a.t("profile.session-disable-token-message"),callback:n.disableTokenConfirm})})}},{key:"disableTokenConfirm",value:function(e){var t=this;e&&this.state.disableObject&&("oauth2"===this.state.disableObject.type?u.a.glewlwydRequestSub("/"+this.state.disableObject.key+"/profile/token/"+this.state.disableObject.token.token_hash+(this.state.config.params.delegate?"?impersonate="+this.state.config.params.delegate:""),"DELETE").then(function(e){m.a.sendMessage("Notification",{type:"info",message:o.a.t("profile.token-disabled")})}).fail(function(){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})}).always(function(){t.fetchLists(),t.setState({disableObject:!1}),m.a.sendMessage("App",{type:"closeConfirm"})}):"oidc"===this.state.disableObject.type&&u.a.glewlwydRequestSub("/"+this.state.disableObject.key+"/token/"+this.state.disableObject.token.token_hash+(this.state.config.params.delegate?"?impersonate="+this.state.config.params.delegate:""),"DELETE").then(function(e){m.a.sendMessage("Notification",{type:"info",message:o.a.t("profile.token-disabled")})}).fail(function(){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})}).always(function(){t.fetchLists(),t.setState({disableObject:!1})})),m.a.sendMessage("App",{type:"closeConfirm"})}},{key:"render",value:function(){var e=this,t=r.a.createElement("tr",null,r.a.createElement("th",null,o.a.t("profile.session-table-last-login")),r.a.createElement("th",null,o.a.t("profile.session-table-exiration")),r.a.createElement("th",null,o.a.t("profile.session-table-issued-for")),r.a.createElement("th",null,o.a.t("profile.session-table-user-agent")),r.a.createElement("th",null,o.a.t("admin.enabled")),r.a.createElement("th",null)),a=[],n=[];this.state.sessionList.forEach(function(t,n){var s=new Date(1e3*t.last_login),i=new Date(1e3*t.expiration);a.push(r.a.createElement("tr",{key:n},r.a.createElement("td",null,s.toLocaleString()),r.a.createElement("td",null,i.toLocaleString()),r.a.createElement("td",null,t.issued_for),r.a.createElement("td",null,t.user_agent),r.a.createElement("td",null,t.enabled?o.a.t("profile.session-enabled-true"):o.a.t("profile.session-enabled-false")),r.a.createElement("td",null,r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(a){return e.disableSession(t)},title:o.a.t("admin.delete"),disabled:!t.enabled},r.a.createElement("i",{className:"fas fa-trash"})))))});var s=0;for(var i in n=[],this.state.plugins.oauth2){var l=this.state.plugins.oauth2[i],c=r.a.createElement("tr",null,r.a.createElement("th",null,o.a.t("profile.session-table-last-login")),r.a.createElement("th",null,o.a.t("profile.session-table-exiration")),r.a.createElement("th",null,o.a.t("profile.session-table-client")),r.a.createElement("th",null,o.a.t("profile.session-table-issued-for")),r.a.createElement("th",null,o.a.t("profile.session-table-user-agent")),r.a.createElement("th",null,o.a.t("admin.enabled")),r.a.createElement("th",null)),u=[];l.forEach(function(t,a){var n=new Date(1e3*t.last_seen),s=new Date(1e3*t.expires_at);u.push(r.a.createElement("tr",{key:a},r.a.createElement("td",null,n.toLocaleString()),r.a.createElement("td",null,s.toLocaleString()),r.a.createElement("td",null,t.client_id),r.a.createElement("td",null,t.issued_for),r.a.createElement("td",null,t.user_agent),r.a.createElement("td",null,t.enabled?o.a.t("profile.session-enabled-true"):o.a.t("profile.session-enabled-false")),r.a.createElement("td",null,r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(a){return e.disableToken("oauth2",i,t)},title:o.a.t("admin.delete"),disabled:!t.enabled},r.a.createElement("i",{className:"fas fa-trash"})))))}),n.push(r.a.createElement("div",{className:"card",key:++s},r.a.createElement("div",{className:"card-header",id:"dataFormatCard"},r.a.createElement("h2",{className:"mb-0"},r.a.createElement("button",{className:"btn btn-link",type:"button","data-toggle":"collapse","data-target":"#collapseOauth2-"+i,"aria-expanded":"true","aria-controls":"collapseOauth2-"+i},o.a.t("profile.session-token-oauth2-table",{name:i})))),r.a.createElement("div",{id:"collapseOauth2-"+i,className:"collapse","aria-labelledby":"dataFormatCard","data-parent":"#accordionParams"},r.a.createElement("div",{className:"card-body"},this.getTable(c,u)))))}for(var i in s=n.length,this.state.plugins.oidc){var m=this.state.plugins.oidc[i],f=r.a.createElement("tr",null,r.a.createElement("th",null,o.a.t("profile.session-table-last-login")),r.a.createElement("th",null,o.a.t("profile.session-table-exiration")),r.a.createElement("th",null,o.a.t("profile.session-table-client")),r.a.createElement("th",null,o.a.t("profile.session-table-issued-for")),r.a.createElement("th",null,o.a.t("profile.session-table-user-agent")),r.a.createElement("th",null,o.a.t("admin.enabled")),r.a.createElement("th",null));u=[],m.forEach(function(t,a){var n=new Date(1e3*t.last_seen),s=new Date(1e3*t.expires_at);u.push(r.a.createElement("tr",{key:a},r.a.createElement("td",null,n.toLocaleString()),r.a.createElement("td",null,s.toLocaleString()),r.a.createElement("td",null,t.client_id),r.a.createElement("td",null,t.issued_for),r.a.createElement("td",null,t.user_agent),r.a.createElement("td",null,t.enabled?o.a.t("profile.session-enabled-true"):o.a.t("profile.session-enabled-false")),r.a.createElement("td",null,r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(a){return e.disableToken("oidc",i,t)},title:o.a.t("admin.delete"),disabled:!t.enabled},r.a.createElement("i",{className:"fas fa-trash"})))))}),n.push(r.a.createElement("div",{className:"card",key:++s},r.a.createElement("div",{className:"card-header",id:"dataFormatCard"},r.a.createElement("h2",{className:"mb-0"},r.a.createElement("button",{className:"btn btn-link",type:"button","data-toggle":"collapse","data-target":"#collapseOauth2-"+i,"aria-expanded":"true","aria-controls":"collapseOauth2-"+i},o.a.t("profile.session-token-oidc-table",{name:i})))),r.a.createElement("div",{id:"collapseOauth2-"+i,className:"collapse","aria-labelledby":"dataFormatCard","data-parent":"#accordionParams"},r.a.createElement("div",{className:"card-body"},this.getTable(f,u)))))}return r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,o.a.t("profile.session-title")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"accordion",id:"accordionParams"},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header",id:"dataFormatCard"},r.a.createElement("h2",{className:"mb-0"},r.a.createElement("button",{className:"btn btn-link",type:"button","data-toggle":"collapse","data-target":"#collapseSession","aria-expanded":"true","aria-controls":"collapseSession"},o.a.t("profile.session-table")))),r.a.createElement("div",{id:"collapseSession",className:"collapse","aria-labelledby":"dataFormatCard","data-parent":"#accordionParams"},r.a.createElement("div",{className:"card-body"},this.getTable(t,a)))),n))))}}]),t}();function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function W(e,t){return(W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function J(e){return(J=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Q=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W(e,t)}(t,n.Component);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=J(e);if(t){var r=J(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return function(e,t){return!t||"object"!==G(t)&&"function"!=typeof t?z(e):t}(this,a)}}(t);function t(a){var n;return function(e,a){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),(n=e.call(this,a)).state={config:a.config,passwordMinLength:a.config.PasswordMinLength||8,callback:a.callback,old_password:"",password:"",password_confirm:"",oldPasswordInvalid:!1,passwordInvalid:!1,passwordConfirmInvalid:!1,loggedIn:!1},n.passwordButtonHandler=n.passwordButtonHandler.bind(z(n)),n.changeOldPassword=n.changeOldPassword.bind(z(n)),n.changeNewPassword=n.changeNewPassword.bind(z(n)),n.changeNewPasswordConfirm=n.changeNewPasswordConfirm.bind(z(n)),n.checkPassword=n.checkPassword.bind(z(n)),n}return function(e,t,a){t&&B(e.prototype,t)}(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({config:e.config,passwordMinLength:e.config.PasswordMinLength||8,callback:e.callback,loggedIn:e.loggedIn},function(){t.state.loggedIn||t.setState({password:"",old_password:"",password_confirm:"",passwordMinLength:0})})}},{key:"passwordButtonHandler",value:function(e,t){var a=this;t?this.checkPassword()&&u.a.glewlwydRequest("/profile/password","PUT",{old_password:this.state.old_password,password:this.state.password}).then(function(){a.setState({old_password:"",password:"",password_confirm:"",oldPasswordInvalid:!1,oldPasswordInvalidMessage:"",passwordInvalid:!1,passwordInvalidMessage:"",passwordConfirmInvalid:!1,passwordConfirmInvalidMessage:""},function(){a.state.callback(t)})}).fail(function(e){400==e.status?a.setState({oldPasswordInvalid:!0,oldPasswordInvalidMessage:o.a.t("profile.password-invalid")}):m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})}):this.state.callback(t)}},{key:"changeOldPassword",value:function(e){this.setState({old_password:e.target.value})}},{key:"changeNewPassword",value:function(e){this.setState({password:e.target.value})}},{key:"changeNewPasswordConfirm",value:function(e){this.setState({password_confirm:e.target.value})}},{key:"checkPassword",value:function(){var e=!1,t=!1,a="",n="";return this.state.password.length<this.state.passwordMinLength&&(e=!0,a=o.a.t("profile.password-min-characters",{minLength:this.state.passwordMinLength})),this.state.password!==this.state.password_confirm&&(t=!0,n=o.a.t("profile.password-not-match")),this.setState({passwordInvalid:e,passwordConfirmInvalid:t,passwordInvalidMessage:a,passwordConfirmInvalidMessage:n}),!e&&!t}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",{className:"row",id:"password"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,o.a.t("profile.password-title")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("form",{className:"needs-validation",noValidate:!0},r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("label",{className:"input-group-text",htmlFor:"mod-old-password"},o.a.t("profile.password-old-password"))),r.a.createElement("input",{type:"password",autoComplete:"current-password",className:"form-control"+(this.state.oldPasswordInvalid?" is-invalid":""),id:"oldPassword",placeholder:o.a.t("profile.password-old-password-ph"),value:this.state.old_password,onChange:function(t){return e.changeOldPassword(t)}})),r.a.createElement("span",{className:"error-input"+(this.state.oldPasswordInvalid?"":" hidden")},this.state.oldPasswordInvalidMessage)),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("label",{className:"input-group-text",htmlFor:"mod-new-password"},o.a.t("profile.password-new-password"))),r.a.createElement("input",{type:"password",autoComplete:"new-password",className:"form-control"+(this.state.passwordInvalid?" is-invalid":""),id:"newPassword",placeholder:o.a.t("profile.password-new-password-ph",{minLength:this.state.passwordMinLength}),value:this.state.password,onChange:function(t){return e.changeNewPassword(t)}})),r.a.createElement("span",{className:"error-input"+(this.state.passwordInvalid?"":" hidden")},this.state.passwordInvalidMessage)),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("label",{className:"input-group-text",htmlFor:"mod-new-password-confirm"},o.a.t("profile.password-new-password-confirm"))),r.a.createElement("input",{type:"password",autoComplete:"new-password",className:"form-control"+(this.state.passwordConfirmInvalid?" is-invalid":""),id:"retypeNewPassword",placeholder:o.a.t("profile.password-new-password-confirm-ph",{minLength:this.state.passwordMinLength}),value:this.state.password_confirm,onChange:function(t){return e.changeNewPasswordConfirm(t)}})),r.a.createElement("span",{className:"error-input"+(this.state.passwordConfirmInvalid?"":" hidden")},this.state.passwordConfirmInvalidMessage))))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12 text-right"},r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(t){return e.passwordButtonHandler(t,!0)}},o.a.t("profile.save")))))}}]),t}();function K(e){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function X(e,t){return(X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var te=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X(e,t)}(t,n.Component);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=ee(e);if(t){var r=ee(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return function(e,t){return!t||"object"!==K(t)&&"function"!=typeof t?Z(e):t}(this,a)}}(t);function t(a){var n;return function(e,a){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),(n=e.call(this,a)).state={config:a.config,module:a.module,name:a.name,profile:a.profile,registered:!1,registration:!1,registerUrl:a.config.params.register?"/"+a.config.params.register+"/profile":"/profile"},n.getRegister=n.getRegister.bind(Z(n)),n.register=n.register.bind(Z(n)),n.getRegister(),n}return function(e,t,a){t&&Y(e.prototype,t)}(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({config:e.config,module:e.module,name:e.name,profile:e.profile,registered:!1,registration:!1,registerUrl:e.config.params.register?"/"+e.config.params.register+"/profile":"/profile"},function(){t.getRegister()})}},{key:"getRegister",value:function(){var e=this;this.state.profile&&u.a.glewlwydRequest(this.state.registerUrl+"/scheme/register/","PUT",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name},!0).then(function(t){e.setState({registration:o.a.t("profile.scheme-mock-register-status-registered"),registered:!0})}).fail(function(t){400===t.status?e.setState({registration:o.a.t("profile.scheme-mock-register-status-not-registered"),registered:!1}):m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})}},{key:"register",value:function(){var e=this;u.a.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{register:!this.state.registered}}).fail(function(e){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})}).always(function(){m.a.sendMessage("App",{type:"registration"}),e.getRegister()})}},{key:"render",value:function(){var e,t=this;return this.state.registration&&(e=r.a.createElement("div",null,r.a.createElement("h4",null,o.a.t("profile.scheme-mock-register-status")),r.a.createElement("span",{className:"badge badge-primary"},this.state.registration))),r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,o.a.t("profile.scheme-mock-title",{module:this.state.module,name:this.state.name})))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},e)),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("hr",null))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return t.register(e)}},this.state.registered?o.a.t("profile.scheme-mock-deregister"):o.a.t("profile.scheme-mock-register"))))))}}]),t}();function ae(e){return(ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ne(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function re(e,t){return(re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function se(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ie(e){return(ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var oe=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&re(e,t)}(t,n.Component);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=ie(e);if(t){var r=ie(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return function(e,t){return!t||"object"!==ae(t)&&"function"!=typeof t?se(e):t}(this,a)}}(t);function t(a){var n;return function(e,a){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),(n=e.call(this,a)).state={config:a.config,module:a.module,name:a.name,profile:a.profile,registered:!1,registration:!1,credentialList:[],credentialAvailable:!1,editIndex:-1,editValue:"",removeIndex:-1,credAssertion:!1,webauthnEnabled:!!window.PublicKeyCredential,registerUrl:a.config.params.register?"/"+a.config.params.register+"/profile":"/profile"},n.getCredentials=n.getCredentials.bind(se(n)),n.createCredential=n.createCredential.bind(se(n)),n.testAssertion=n.testAssertion.bind(se(n)),n.editNameCred=n.editNameCred.bind(se(n)),n.changeName=n.changeName.bind(se(n)),n.saveName=n.saveName.bind(se(n)),n.cancelSaveName=n.cancelSaveName.bind(se(n)),n.switchCred=n.switchCred.bind(se(n)),n.removeCred=n.removeCred.bind(se(n)),n.confirmRemoveCred=n.confirmRemoveCred.bind(se(n)),n.getCredentials(),n}return function(e,t,a){t&&ne(e.prototype,t)}(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({config:e.config,module:e.module,name:e.name,profile:e.profile,registered:!1,registration:!1,registerUrl:e.config.params.register?"/"+e.config.params.register+"/profile":"/profile"},function(){t.getCredentials()})}},{key:"strToBin",value:function(e){return Uint8Array.from(atob(e),function(e){return e.charCodeAt(0)})}},{key:"binToStr",value:function(e){return btoa(new Uint8Array(e).reduce(function(e,t){return e+String.fromCharCode(t)},""))}},{key:"getCredentials",value:function(){var e=this;this.state.profile&&u.a.glewlwydRequest(this.state.registerUrl+"/scheme/register/","PUT",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name},!0).then(function(t){var a=!1;t.forEach(function(e){"registered"==e.status&&(a=!0)}),e.setState({credentialList:t,credentialAvailable:a,credAssertion:!1})}).fail(function(t){401===t.status?e.setState({registration:o.a.t("profile.scheme-webauthn-register-status-not-registered"),registered:!1,credentialList:[],credAssertion:!1}):m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})}},{key:"createCredential",value:function(){var e=this;u.a.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{register:"new-credential"}}).then(function(t){var a=[];e.state.credentialList.forEach(function(t){a.push({id:e.strToBin(t.credential_id),type:"public-key"})});var n={authenticatorSelection:{requireResidentKey:!1},rp:{name:t.rpId.split("://")[1]},user:{id:Uint8Array.from(atob(t.user.id),function(e){return e.charCodeAt(0)}),name:t.user.name,displayName:e.state.profile.name||t.user.name},pubKeyCredParams:t["pubKey-cred-params"],challenge:e.strToBin(t.challenge),excludeCredentials:a};t["attestation-required"]&&(n.attestation=t["attestation-required"]),t.timeout&&(n.timeout=t.timeout),navigator.credentials.create({publicKey:n}).then(function(a){var n={};"id"in a&&(n.id=a.id),"type"in a&&(n.type=a.type),"rawId"in a&&(n.rawId=e.binToStr(a.rawId));var r={};r.clientDataJSON=e.binToStr(a.response.clientDataJSON),r.attestationObject=e.binToStr(a.response.attestationObject),a.response.getTransports&&(r.transports=a.response.getTransports()),n.response=r,u.a.glewlwydRequest(e.state.registerUrl+"/scheme/register/","POST",{username:e.state.profile.username,scheme_type:e.state.module,scheme_name:e.state.name,value:{register:"register-credential",session:t.session,credential:n}}).then(function(){m.a.sendMessage("Notification",{type:"info",message:o.a.t("profile.scheme-webauthn-register-credential-success")}),e.getCredentials(),e.state.config.params.register&&m.a.sendMessage("App",{type:"registration"})}).fail(function(e,t){400===e.status?(m.a.sendMessage("Notification",{type:"danger",message:o.a.t("profile.scheme-webauthn-register-credential-error")}),m.a.sendMessage("App",{type:"message",title:o.a.t("profile.scheme-webauthn-register-credential-error"),message:e.responseJSON})):m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})}).catch(function(e){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("profile.scheme-webauthn-error-registration")}),m.a.sendMessage("App",{type:"message",title:o.a.t("profile.scheme-webauthn-register-credential-error"),message:[e.toString()]})})}).fail(function(e){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})}},{key:"testAssertion",value:function(e){var t=this;u.a.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{register:"trigger-assertion"}}).then(function(e){var a=[];e.allowCredentials.forEach(function(e){a.push({id:t.strToBin(e.credential_id),type:"public-key"})});var n={allowCredentials:a,challenge:t.strToBin(e.challenge)};navigator.credentials.get({publicKey:n}).then(function(a){var n={};"id"in a&&(n.id=a.id),"type"in a&&(n.type=a.type),"rawId"in a&&(n.rawId=t.binToStr(a.rawId)),t.setState({credAssertion:n.rawId}),n.response={clientDataJSON:t.binToStr(a.response.clientDataJSON),authenticatorData:t.binToStr(a.response.authenticatorData),signature:t.binToStr(a.response.signature),userHandle:t.binToStr(a.response.userHandle)},a.response.getTransports&&(response.transports=a.response.getTransports()),u.a.glewlwydRequest(t.state.registerUrl+"/scheme/register/","POST",{username:t.state.profile.username,scheme_type:t.state.module,scheme_name:t.state.name,value:{register:"validate-assertion",session:e.session,credential:n}},!0).then(function(){t.state.config.params.register&&m.a.sendMessage("App",{type:"registration"}),m.a.sendMessage("Notification",{type:"info",message:o.a.t("profile.scheme-webauthn-assertion-success")})}).fail(function(e){401===e.status?m.a.sendMessage("Notification",{type:"danger",message:o.a.t("profile.scheme-webauthn-assertion-error")}):m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})}).catch(function(e){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("profile.scheme-webauthn-error-assertion")}),m.a.sendMessage("App",{type:"message",title:o.a.t("profile.scheme-webauthn-register-credential-error"),message:[e.toString()]})})}).fail(function(e){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})}},{key:"editNameCred",value:function(e){this.setState({editIndex:e,editValue:this.state.credentialList[e].name,credAssertion:!1})}},{key:"changeName",value:function(e){this.setState({editValue:e.target.value,credAssertion:!1})}},{key:"saveName",value:function(e,t){var a=this;e.preventDefault(),u.a.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{register:"edit-credential",credential_id:this.state.credentialList[t].credential_id,name:this.state.editValue}}).then(function(e){a.setState({editIndex:-1,editValue:""},function(){a.getCredentials()})}).fail(function(e){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})}},{key:"cancelSaveName",value:function(){this.setState({editIndex:-1,editValue:""})}},{key:"switchCred",value:function(e){var t=this;u.a.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{register:"registered"===this.state.credentialList[e].status?"disable-credential":"enable-credential",credential_id:this.state.credentialList[e].credential_id}}).then(function(e){t.state.config.params.register&&m.a.sendMessage("App",{type:"registration"}),t.getCredentials()}).fail(function(e){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})}},{key:"removeCred",value:function(e){var t=this;this.setState({removeIndex:e},function(){m.a.sendMessage("App",{type:"confirm",title:o.a.t("profile.scheme-webauthn-confirm-title"),message:o.a.t("profile.scheme-webauthn-confirm-message"),callback:t.confirmRemoveCred})})}},{key:"confirmRemoveCred",value:function(e){var t=this;e?u.a.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{register:"remove-credential",credential_id:this.state.credentialList[this.state.removeIndex].credential_id}}).then(function(e){t.getCredentials(),m.a.sendMessage("Notification",{type:"info",message:o.a.t("profile.scheme-webauthn-removed")}),t.state.config.params.register&&m.a.sendMessage("App",{type:"registration"})}).fail(function(e){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})}).always(function(){m.a.sendMessage("App",{type:"closeConfirm"})}):m.a.sendMessage("App",{type:"closeConfirm"})}},{key:"render",value:function(){var e,t=this,a=[];return this.state.credentialList.forEach(function(e,n){var s=new Date(1e3*e.created_at);if(t.state.editIndex===n)a.push(r.a.createElement("tr",{key:n},r.a.createElement("td",{className:"d-none d-md-block"},s.toLocaleString()),r.a.createElement("td",null,r.a.createElement("form",{className:"needs-validation",noValidate:!0,onSubmit:function(e){return t.saveName(e,n)}},r.a.createElement("input",{type:"text",className:"form-control",value:t.state.editValue,onChange:function(e){return t.changeName(e,n)},placeholder:o.a.t("profile.webauthn-edit-placeholder")}))),r.a.createElement("td",{className:"d-none d-md-block"},o.a.t("admin.yes")),r.a.createElement("td",null,r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return t.saveName(e,n)},title:o.a.t("modal.ok")},r.a.createElement("i",{className:"fas fa-save"})),r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return t.cancelSaveName()},title:o.a.t("modal.close")},r.a.createElement("i",{className:"fas fa-times"}))))));else if("registered"===e.status){var i="";e.credential_id===t.state.credAssertion&&(i=r.a.createElement("i",{className:"far fa-check-circle btn-icon-right text-success"})),a.push(r.a.createElement("tr",{key:n},r.a.createElement("td",{className:"d-none d-md-block"},s.toLocaleString()),r.a.createElement("td",null,r.a.createElement("span",{className:"badge badge-success"},e.name),i),r.a.createElement("td",{className:"d-none d-md-block"},o.a.t("admin.yes")),r.a.createElement("td",null,r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return t.switchCred(n)},title:o.a.t("profile.scheme-webauthn-btn-switch-off")},r.a.createElement("i",{className:"fas fa-toggle-on"})),r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return t.editNameCred(n)},title:o.a.t("profile.scheme-webauthn-btn-edit")},r.a.createElement("i",{className:"fas fa-edit"})),r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return t.removeCred(n)},title:o.a.t("profile.scheme-webauthn-btn-remove")},r.a.createElement("i",{className:"fas fa-trash"}))))))}else a.push(r.a.createElement("tr",{key:n},r.a.createElement("td",{className:"d-none d-md-block"},s.toLocaleString()),r.a.createElement("td",null,r.a.createElement("span",{className:"badge badge-danger"},e.name)),r.a.createElement("td",{className:"d-none d-md-block"},o.a.t("admin.no")),r.a.createElement("td",null,r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return t.switchCred(n)},title:o.a.t("profile.scheme-webauthn-btn-switch-on")},r.a.createElement("i",{className:"fas fa-toggle-off"})),r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return t.editNameCred(n)},title:o.a.t("profile.scheme-webauthn-btn-edit")},r.a.createElement("i",{className:"fas fa-edit"})),r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return t.removeCred(n)},title:o.a.t("profile.scheme-webauthn-btn-remove")},r.a.createElement("i",{className:"fas fa-trash"}))))))}),this.state.webauthnEnabled||(e=r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"alert alert-danger",role:"alert"},o.a.t("profile.scheme-webauthn-disabled"))))),r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,o.a.t("profile.scheme-webauthn-title",{module:this.state.module,name:this.state.name})))),e,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return t.getCredentials(e)}},o.a.t("login.btn-reload")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("table",{className:"table table-responsive table-striped"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:"d-none d-md-block"},o.a.t("profile.scheme-webauthn-table-created_at")),r.a.createElement("th",null,o.a.t("profile.scheme-webauthn-table-name")),r.a.createElement("th",{className:"d-none d-md-block"},o.a.t("profile.scheme-webauthn-table-enabled")),r.a.createElement("th",null))),r.a.createElement("tbody",null,a)))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("hr",null))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{type:"button",disabled:!this.state.webauthnEnabled,className:"btn btn-primary",onClick:function(e){return t.createCredential(e)},title:o.a.t("profile.scheme-webauthn-register-title")},o.a.t("profile.scheme-webauthn-register")),r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return t.testAssertion(e)},disabled:!this.state.credentialAvailable||!this.state.webauthnEnabled,title:o.a.t("profile.scheme-webauthn-test-registration-title")},o.a.t("profile.scheme-webauthn-test-registration"))))))}}]),t}(),le=a(15),ce=a.n(le);function ue(e){return(ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function me(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function fe(e,t){return(fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function de(e){return(de=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ge=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fe(e,t)}(t,n.Component);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=de(e);if(t){var r=de(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return function(e,t){return!t||"object"!==ue(t)&&"function"!=typeof t?pe(e):t}(this,a)}}(t);function t(a){var n;return function(e,a){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),(n=e.call(this,a)).state={config:a.config,module:a.module,name:a.name,profile:a.profile,myOtp:!1,errorList:{},otpUrl:!1,qrcode:"",allowHotp:!1,allowTotp:!1,registerUrl:a.config.params.register?"/"+a.config.params.register+"/profile":"/profile"},n.getRegister=n.getRegister.bind(pe(n)),n.register=n.register.bind(pe(n)),n.changeParam=n.changeParam.bind(pe(n)),n.changeType=n.changeType.bind(pe(n)),n.generateSecret=n.generateSecret.bind(pe(n)),n.showQRCode=n.showQRCode.bind(pe(n)),n.getRegister(),n}return function(e,t,a){t&&me(e.prototype,t)}(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({config:e.config,module:e.module,name:e.name,profile:e.profile,registerUrl:e.config.params.register?"/"+e.config.params.register+"/profile":"/profile"},function(){t.getRegister()})}},{key:"getRegister",value:function(){var e=this;this.state.profile&&u.a.glewlwydRequest(this.state.registerUrl+"/scheme/register/","PUT",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name}).then(function(t){var a;a="NONE"!==t.type&&t.type?t:{type:"NONE",secret:"",moving_factor:0,time_step_size:t["totp-window"]},e.setState({myOtp:a,allowHotp:t["hotp-allow"],allowTotp:t["totp-allow"]})}).fail(function(e){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})}).always(function(){e.showQRCode()})}},{key:"showQRCode",value:function(){var e=!1;if(this.state.myOtp.issuer&&this.state.profile.username&&this.state.myOtp.secret&&this.state.myOtp.digits&&("HOTP"===this.state.myOtp.type&&void 0!==this.state.myOtp.moving_factor?e="otpauth://hotp/"+encodeURIComponent(this.state.myOtp.issuer)+":"+encodeURIComponent(this.state.profile.username)+"?issuer="+encodeURIComponent([location.protocol,"//",location.host].join(""))+"&secret="+encodeURIComponent(this.state.myOtp.secret)+"&digits="+this.state.myOtp.digits+"&algorithm=SHA1&counter="+this.state.myOtp.moving_factor:"TOTP"===this.state.myOtp.type&&this.state.myOtp.time_step_size&&(e="otpauth://totp/"+encodeURIComponent(this.state.myOtp.issuer)+":"+encodeURIComponent(this.state.profile.username)+"?issuer="+encodeURIComponent([location.protocol,"//",location.host].join(""))+"&secret="+encodeURIComponent(this.state.myOtp.secret)+"&digits="+this.state.myOtp.digits+"&algorithm=SHA1&period="+this.state.myOtp.time_step_size)),e){var t=ce()(0,"L");t.addData(e),t.make(),this.setState({otpUrl:e,qrcode:t.createSvgTag(4)})}else this.setState({otpUrl:!1,qrcode:""})}},{key:"changeParam",value:function(e,t,a){var n=this,r=this.state.myOtp;r[t]=a?parseInt(e.target.value):e.target.value,this.setState({myOtp:r},function(){n.showQRCode()})}},{key:"changeType",value:function(e,t){var a=this;e.preventDefault();var n=this.state.myOtp;n.type=t,this.setState({myOtp:n},function(){a.showQRCode()})}},{key:"generateSecret",value:function(){var e=this;u.a.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{"generate-secret":!0}}).then(function(t){var a=e.state.myOtp;a.secret=t.secret,e.setState({myOtp:a},function(){e.showQRCode()})}).fail(function(e){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})}},{key:"register",value:function(){var e=this,t={},a=!1;"NONE"!==this.state.myOtp.type&&(this.state.myOtp.secret||(t.secret=o.a.t("profile.scheme-otp-secret-error"),a=!0),"HOTP"===this.state.myOtp.type?""!==this.state.myOtp.moving_factor&&void 0!==this.state.myOtp.moving_factor||(t.moving_factor=o.a.t("profile.scheme-otp-moving_factor-error"),a=!0):"TOTP"===this.state.myOtp.type&&(""!==this.state.myOtp.time_step_size&&void 0!==this.state.myOtp.time_step_size||(t.time_step_size=o.a.t("profile.scheme-otp-time_step_size-error"),a=!0),""===this.state.myOtp.start_offset&&(t.start_offset=o.a.t("profile.scheme-otp-start_offset-error"),a=!0))),this.setState({errorList:t},function(){a||u.a.glewlwydRequest(e.state.registerUrl+"/scheme/register/","POST",{username:e.state.profile.username,scheme_type:e.state.module,scheme_name:e.state.name,value:e.state.myOtp}).then(function(t){m.a.sendMessage("Notification",{type:"info",message:o.a.t("profile.scheme-otp-save-ok")}),e.getRegister(),e.state.config.params.register&&m.a.sendMessage("App",{type:"registration"})}).fail(function(e){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("profile.scheme-otp-save-error")})})})}},{key:"render",value:function(){var e,t,a,n,s,i,l=this;return a=r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"input-group input-group-sm mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},o.a.t("profile.scheme-otp-secret"))),r.a.createElement("input",{type:"text",maxLength:"128",className:this.state.errorList.secret?"form-control is-invalid":"form-control",id:"scheme-otp-secret",onChange:function(e){return l.changeParam(e,"secret")},value:this.state.myOtp.secret,placeholder:o.a.t("profile.scheme-otp-secret-ph")}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("button",{className:"btn btn-outline-secondary",type:"button",onClick:this.generateSecret},o.a.t("profile.scheme-otp-generate-secret"))),this.state.errorList.secret?r.a.createElement("span",{className:"error-input"},this.state.errorList.secret):""))),"HOTP"===this.state.myOtp.type?e=r.a.createElement("div",null,a,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"input-group input-group-sm mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},o.a.t("profile.scheme-otp-moving_factor"))),r.a.createElement("input",{type:"number",min:"0",step:"1",className:this.state.errorList.moving_factor?"form-control is-invalid":"form-control",id:"scheme-otp-moving_factor",onChange:function(e){return l.changeParam(e,"moving_factor",1)},value:this.state.myOtp.moving_factor,placeholder:o.a.t("profile.scheme-otp-moving_factor-ph")}),this.state.errorList.moving_factor?r.a.createElement("span",{className:"error-input"},this.state.errorList.moving_factor):"")))):"TOTP"===this.state.myOtp.type&&(t=r.a.createElement("div",null,a,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"input-group input-group-sm mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},o.a.t("profile.scheme-otp-time_step_size"))),r.a.createElement("input",{type:"number",min:"0",step:"1",className:this.state.errorList.time_step_size?"form-control is-invalid":"form-control",id:"scheme-otp-time_step_size",onChange:function(e){return l.changeParam(e,"time_step_size",1)},value:this.state.myOtp.time_step_size,placeholder:o.a.t("profile.scheme-otp-time_step_size-ph")}),this.state.errorList.time_step_size?r.a.createElement("span",{className:"error-input"},this.state.errorList.time_step_size):""))))),this.state.allowHotp&&(n=r.a.createElement("a",{className:"dropdown-item"+("HOTP"===this.state.myOtp.type?" active":""),href:"#",onClick:function(e){return l.changeType(e,"HOTP")}},o.a.t("profile.scheme-otp-type-HOTP"))),this.state.allowTotp&&(s=r.a.createElement("a",{className:"dropdown-item"+("TOTP"===this.state.myOtp.type?" active":""),href:"#",onClick:function(e){return l.changeType(e,"TOTP")}},o.a.t("profile.scheme-otp-type-TOTP"))),this.state.otpUrl&&(i=r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-4"},r.a.createElement("a",{href:this.state.otpUrl,title:this.state.otpUrl},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.state.qrcode}}))),r.a.createElement("div",{className:"col-md-8 v-center"},r.a.createElement("h4",null,o.a.t("profile.scheme-otp-scan-qrcode-message"))))),r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,o.a.t("profile.scheme-otp-title")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"input-group input-group-sm mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},o.a.t("profile.scheme-otp-type"))),r.a.createElement("div",{className:"dropdown"},r.a.createElement("button",{className:"btn btn-secondary dropdown-toggle",type:"button",id:"scheme-otp-type","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},o.a.t("profile.scheme-otp-type-"+this.state.myOtp.type)),r.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"scheme-otp-type"},s,n,r.a.createElement("a",{className:"dropdown-item"+("NONE"===this.state.myOtp.type?" active":""),href:"#",onClick:function(e){return l.changeType(e,"NONE")}},o.a.t("profile.scheme-otp-type-NONE"))))))),e,t,i,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("hr",null))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return l.register(e)}},o.a.t("profile.scheme-otp-save"))))))}}]),t}();function he(e){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ye(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function be(e,t){return(be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ve(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ee(e){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var we=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&be(e,t)}(t,n.Component);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Ee(e);if(t){var r=Ee(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return function(e,t){return!t||"object"!==he(t)&&"function"!=typeof t?ve(e):t}(this,a)}}(t);function t(a){var n;return function(e,a){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),(n=e.call(this,a)).state={config:a.config,module:a.module,name:a.name,profile:a.profile,registered:!1,registration:!1,certificateList:[],addModal:!1,certFile:!1,curCert:!1,fileName:!1,activeCert:!1,downloadCert:!1,showPassword:!1,canAddCert:!1,canRequestCert:!1,registerUrl:a.config.params.register?"/"+a.config.params.register+"/profile":"/profile"},n.getRegister=n.getRegister.bind(ve(n)),n.selectCertFile=n.selectCertFile.bind(ve(n)),n.addCertificateFile=n.addCertificateFile.bind(ve(n)),n.addCertificateFromRequest=n.addCertificateFromRequest.bind(ve(n)),n.requestNewCertificate=n.requestNewCertificate.bind(ve(n)),n.switchCertStatus=n.switchCertStatus.bind(ve(n)),n.deleteCert=n.deleteCert.bind(ve(n)),n.confirmDeleteCert=n.confirmDeleteCert.bind(ve(n)),n.testCertificate=n.testCertificate.bind(ve(n)),n.showPassword=n.showPassword.bind(ve(n)),n.copyPassword=n.copyPassword.bind(ve(n)),n.getRegister(),n}return function(e,t,a){t&&ye(e.prototype,t)}(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,module:e.module,name:e.name,profile:e.profile,registered:!1,registration:!1,addModal:!1,certFile:!1,fileName:!1,activeCert:!1,downloadCert:!1,showPassword:!1,canAddCert:!1,canRequestCert:!1,registerUrl:e.config.params.register?"/"+e.config.params.register+"/profile":"/profile"})}},{key:"getRegister",value:function(){var e=this;return this.state.profile?u.a.glewlwydRequest(this.state.registerUrl+"/scheme/register/","PUT",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name}).then(function(t){e.setState({certificateList:t.certificate,canAddCert:t["add-certificate"],certFile:!1,canRequestCert:t["request-certificate"],fileName:!1,activeCert:!1,downloadCert:!1})}).fail(function(t){e.setState({certificateList:[],canAddCert:!1,canRequestCert:!1,certFile:!1,fileName:!1,downloadCert:!1},function(){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})}):Promise.reject(new Error("fail"))}},{key:"selectCertFile",value:function(e){var t=this,a=(this.state.profile,e.target.files[0]),n=new FileReader;n.onload=function(e){t.setState({certFile:e.target.result,fileName:a.name})},n.readAsText(a)}},{key:"addCertificateFile",value:function(){var e=this;this.state.certFile&&u.a.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{register:"upload-certificate",x509:this.state.certFile}}).then(function(t){e.getRegister(),e.state.config.params.register&&(m.a.sendMessage("App",{type:"registration"}),m.a.sendMessage("App",{type:"nav",page:"profile"}))}).fail(function(e){400===e.status?m.a.sendMessage("Notification",{type:"danger",message:o.a.t("profile.scheme-certificate-invalid")}):m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})}},{key:"addCertificateFromRequest",value:function(){var e=this;u.a.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{register:"use-certificate"}}).then(function(t){e.getRegister(),e.state.config.params.register&&m.a.sendMessage("App",{type:"registration"})}).fail(function(e){400===e.status?m.a.sendMessage("Notification",{type:"danger",message:o.a.t("profile.scheme-certificate-invalid")}):m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})}},{key:"requestNewCertificate",value:function(){var e=this;u.a.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{register:"request-certificate"}}).then(function(t){e.getRegister().then(function(){e.state.config.params.register&&m.a.sendMessage("App",{type:"registration"}),e.setState({downloadCert:t,showPassword:!1})})}).fail(function(e){400===e.status?m.a.sendMessage("Notification",{type:"danger",message:o.a.t("profile.scheme-certificate-invalid")}):m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})}},{key:"switchCertStatus",value:function(e){var t=this;u.a.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{register:"toggle-certificate",certificate_id:e.certificate_id,enabled:!e.enabled}}).then(function(a){m.a.sendMessage("Notification",{type:"info",message:o.a.t("profile.scheme-certificate-"+(e.enabled?"disabled":"enabled"))}),t.getRegister(),t.state.config.params.register&&m.a.sendMessage("App",{type:"registration"})}).fail(function(e){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})}},{key:"deleteCert",value:function(e,t){var a=this;e.preventDefault(),this.setState({curCert:t,certFile:!1,fileName:!1},function(){m.a.sendMessage("App",{type:"confirm",title:o.a.t("profile.scheme-certificate-confirm-title"),message:o.a.t("profile.scheme-certificate-confirm-message"),callback:a.confirmDeleteCert})})}},{key:"confirmDeleteCert",value:function(e){var t=this;e?u.a.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{register:"delete-certificate",certificate_id:this.state.curCert.certificate_id}}).then(function(e){t.getRegister(),t.state.config.params.register&&m.a.sendMessage("App",{type:"registration"})}).fail(function(e){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})}).always(function(){m.a.sendMessage("App",{type:"closeConfirm"})}):m.a.sendMessage("App",{type:"closeConfirm"})}},{key:"testCertificate",value:function(){var e=this;u.a.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{register:"test-certificate"}}).then(function(t){e.setState({activeCert:t}),m.a.sendMessage("Notification",{type:"info",message:o.a.t("profile.scheme-certificate-test-valid")})}).fail(function(e){400===e.status||401===e.status?m.a.sendMessage("Notification",{type:"danger",message:o.a.t("profile.scheme-certificate-invalid")}):m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})}},{key:"showPassword",value:function(){this.setState({showPassword:!this.state.showPassword})}},{key:"copyPassword",value:function(){navigator.clipboard.writeText(this.state.downloadCert.password).then(function(){m.a.sendMessage("Notification",{type:"info",message:o.a.t("profile.scheme-certificate-p12-file-copy-password-success")})},function(e){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("profile.scheme-certificate-p12-file-copy-password-error")})})}},{key:"render",value:function(){var e,t=this,a=[];if(this.state.certificateList.forEach(function(e,n){var s,i,l=new Date(1e3*e.expiration),c=new Date(1e3*e.last_used);t.state.activeCert&&e.certificate_id===t.state.activeCert.certificate_id&&(i=r.a.createElement("i",{className:"far fa-check-circle btn-icon-right text-success"})),s=!0===e.enabled?r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(a){return t.switchCertStatus(e)},title:o.a.t("admin.switch-off")},r.a.createElement("i",{className:"fas fa-toggle-on"})),r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(a){return t.deleteCert(a,e)},title:o.a.t("admin.delete")},r.a.createElement("i",{className:"fas fa-trash"}))):!1===e.enabled?r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(a){return t.switchCertStatus(e)},title:o.a.t("admin.switch-on")},r.a.createElement("i",{className:"fas fa-toggle-off"})),r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(a){return t.deleteCert(a,e)},title:o.a.t("admin.delete")},r.a.createElement("i",{className:"fas fa-trash"}))):r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{type:"button",disabled:!0,className:"btn btn-secondary",title:o.a.t("admin.switch-off")},r.a.createElement("i",{className:"fas fa-toggle-on"})),r.a.createElement("button",{type:"button",disabled:!0,className:"btn btn-secondary",title:o.a.t("admin.delete")},r.a.createElement("i",{className:"fas fa-trash"}))),a.push(r.a.createElement("tr",{key:n},r.a.createElement("td",null,r.a.createElement("span",{className:"d-inline-block",tabIndex:"0","data-toggle":"tooltip",title:e.certificate_dn},e.certificate_dn.substring(0,8),"[...]"),i),r.a.createElement("td",{className:"d-none d-lg-table-cell"},r.a.createElement("span",{className:"d-inline-block",tabIndex:"1","data-toggle":"tooltip",title:e.certificate_issuer_dn},e.certificate_issuer_dn.substring(0,8),"[...]")),r.a.createElement("td",{className:"d-none d-lg-table-cell"},l.toLocaleString()),r.a.createElement("td",{className:"d-none d-lg-table-cell"},c.toLocaleString()),r.a.createElement("td",null,s)))}),this.state.downloadCert){var n="********";this.state.showPassword&&(n=this.state.downloadCert.password),e=r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-3"},r.a.createElement("a",{className:"btn btn-primary",download:"cert.p12",href:"data:application/x-pkcs12;base64,"+this.state.downloadCert.p12,target:"_blank"},o.a.t("profile.scheme-certificate-p12-file-save"))),r.a.createElement("div",{className:"col-md-4"},r.a.createElement("h5",null,o.a.t("profile.scheme-certificate-p12-file-password"),r.a.createElement("code",{className:"btn-icon-right"},n))),r.a.createElement("div",{className:"col-md-2"},r.a.createElement("div",{className:"btn-group",role:"group","aria-label":"current-certificate"},r.a.createElement("button",{type:"button",className:"btn btn-outline-secondary",onClick:this.showPassword,title:o.a.t("profile.scheme-certificate-p12-file-"+(this.state.showPassword?"hide-password":"show-password"))},r.a.createElement("i",{className:"fas "+(this.state.showPassword?"fa-eye-slash":"fa-eye")})),r.a.createElement("button",{type:"button",className:"btn btn-outline-secondary",onClick:this.copyPassword,title:o.a.t("profile.scheme-certificate-p12-file-copy-password")},r.a.createElement("i",{className:"fas fa-copy"}))))))}return r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,o.a.t("profile.scheme-certificate-title",{module:this.state.module,name:this.state.name})))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("button",{className:"btn btn-outline-secondary",type:"button",disabled:!this.state.canAddCert,id:"addCertificateFromFile",title:o.a.t("profile.scheme-certificate-add-from-file"),onClick:this.addCertificateFile},o.a.t("upload"))),r.a.createElement("div",{className:"custom-file"},r.a.createElement("input",{type:"file",disabled:!this.state.canAddCert,className:"custom-file-input",id:"addCertificateFromFileInput","aria-describedby":"addCertificateFromFile",onChange:function(e){return t.selectCertFile(e)}}),r.a.createElement("label",{className:"custom-file-label",htmlFor:"addCertificateFromFile"},this.state.fileName||o.a.t("browse"))))),r.a.createElement("div",{className:"col-md-6"},r.a.createElement("div",{className:"btn-group",role:"group","aria-label":"current-certificate"},r.a.createElement("button",{type:"button",className:"btn btn-outline-secondary",disabled:!this.state.canAddCert,onClick:this.addCertificateFromRequest,title:o.a.t("profile.scheme-certificate-add-from-request")},r.a.createElement("i",{className:"fas fa-file-contract"})),r.a.createElement("button",{type:"button",className:"btn btn-outline-secondary",onClick:this.testCertificate,title:o.a.t("profile.scheme-certificate-test")},r.a.createElement("i",{className:"fas fa-question-circle"})),r.a.createElement("button",{type:"button",className:"btn btn-outline-secondary",disabled:!this.state.canRequestCert,onClick:this.requestNewCertificate,title:o.a.t("profile.scheme-certificate-request-new")},r.a.createElement("i",{className:"fas fa-external-link-alt"})),r.a.createElement("button",{type:"button",className:"btn btn-outline-secondary",onClick:this.getRegister,title:o.a.t("profile.scheme-certificate-refresh")},r.a.createElement("i",{className:"fas fa-sync"}))))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("table",{className:"table table-responsive table-striped"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,o.a.t("profile.scheme-certificate-table-certificate_dn")),r.a.createElement("th",{className:"d-none d-lg-table-cell"},o.a.t("profile.scheme-certificate-table-certificate_issuer_dn")),r.a.createElement("th",{className:"d-none d-lg-table-cell"},o.a.t("profile.scheme-certificate-table-expiration")),r.a.createElement("th",{className:"d-none d-lg-table-cell"},o.a.t("profile.scheme-certificate-table-last_used")),r.a.createElement("th",null))),r.a.createElement("tbody",null,a)))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("hr",null))),e)}}]),t}();function Ne(e){return(Ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ke(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ce(e,t){return(Ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Se(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _e(e){return(_e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pe=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ce(e,t)}(t,n.Component);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=_e(e);if(t){var r=_e(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return function(e,t){return!t||"object"!==Ne(t)&&"function"!=typeof t?Se(e):t}(this,a)}}(t);function t(a){var n;return function(e,a){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),(n=e.call(this,a)).state={config:a.config,module:a.module,name:a.name,profile:a.profile,registerList:[],registerUrl:a.config.params.register?"/"+a.config.params.register+"/profile":"/profile",removeProvdier:!1},n.getRegister=n.getRegister.bind(Se(n)),n.confirmRemoveRegistration=n.confirmRemoveRegistration.bind(Se(n)),n.getRegister(),n}return function(e,t,a){t&&ke(e.prototype,t)}(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({config:e.config,module:e.module,name:e.name,profile:e.profile,registerUrl:e.config.params.register?"/"+e.config.params.register+"/profile":"/profile"},function(){t.getRegister()})}},{key:"getRegister",value:function(){var e=this;this.state.profile&&u.a.glewlwydRequest(this.state.registerUrl+"/scheme/register/","PUT",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name},!0).then(function(t){e.setState({registerList:t})}).fail(function(e){400===e.status||m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})}},{key:"addRegistration",value:function(e){this.state.profile&&u.a.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{provider:e,action:"new",register_url:this.state.config.params.register?u.a.getConfig()+"/"+this.state.config.params.register:u.a.getConfig(),complete_url:window.location.href}},!0).then(function(e){document.location=e.redirect_to}).fail(function(e){400===e.status||m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})}},{key:"removeRegistration",value:function(e){var t=this;this.setState({removeProvdier:e},function(){m.a.sendMessage("App",{type:"confirm",title:o.a.t("profile.scheme-oauth2-confirm-title"),message:o.a.t("profile.scheme-oauth2-confirm-message",{provider:e}),callback:t.confirmRemoveRegistration})})}},{key:"confirmRemoveRegistration",value:function(e){var t=this;this.state.profile?u.a.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{provider:this.state.removeProvdier,action:"delete"}},!0).then(function(e){t.getRegister()}).fail(function(e){400===e.status||m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})}).always(function(){m.a.sendMessage("App",{type:"closeConfirm"})}):m.a.sendMessage("App",{type:"closeConfirm"})}},{key:"render",value:function(){var e=this,t=[];return this.state.registerList.forEach(function(a,n){var s,i,l,c;a.logo_uri?s=r.a.createElement("img",{src:a.logo_uri,alt:a.provider,className:"img-fluid logo-img"}):a.logo_fa&&(s=r.a.createElement("i",{className:a.logo_fa})),c=null!==a.created_at?(i=new Date(1e3*a.created_at).toLocaleString(),l=a.last_session?new Date(1e3*a.last_session).toLocaleString():o.a.t("profile.scheme-oauth2-registration-invalid"),r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(t){return e.removeRegistration(a.provider)},title:o.a.t("profile.scheme-oauth2-btn-remove")},r.a.createElement("i",{className:"fas fa-trash"}))):r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(t){return e.addRegistration(a.provider)},title:o.a.t("profile.scheme-oauth2-btn-add")},r.a.createElement("i",{className:"fas fa-plus"})),t.push(r.a.createElement("tr",{key:n},r.a.createElement("td",null,s),r.a.createElement("td",null,r.a.createElement("span",{className:"badge badge-success"},a.provider)),r.a.createElement("td",null,i),r.a.createElement("td",null,l),r.a.createElement("td",null,c)))}),r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,o.a.t("profile.scheme-oauth2-title")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("table",{className:"table table-responsive table-striped"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null),r.a.createElement("th",null,o.a.t("profile.scheme-oauth2-table-name")),r.a.createElement("th",null,o.a.t("profile.scheme-oauth2-table-created_at")),r.a.createElement("th",null,o.a.t("profile.scheme-oauth2-table-last_session")),r.a.createElement("th",null))),r.a.createElement("tbody",null,t)))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("hr",null))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"btn-group",role:"group"}))))}}]),t}();function Oe(e){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Me(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Re(e,t){return(Re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Le(e){return(Le=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Te=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Re(e,t)}(t,n.Component);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Le(e);if(t){var r=Le(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return function(e,t){return!t||"object"!==Oe(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}(this,a)}}(t);function t(a){var n;return function(e,a){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),(n=e.call(this,a)).state={config:a.config,module:a.module,name:a.name,profile:a.profile},n}return function(e,t,a){t&&Me(e.prototype,t)}(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,module:e.module,name:e.name,profile:e.profile})}},{key:"render",value:function(){return"mock"===this.state.module?r.a.createElement(te,{config:this.state.config,module:this.state.module,name:this.state.name,profile:this.state.profile}):"webauthn"===this.state.module?r.a.createElement(oe,{config:this.state.config,module:this.state.module,name:this.state.name,profile:this.state.profile}):"otp"===this.state.module?r.a.createElement(ge,{config:this.state.config,module:this.state.module,name:this.state.name,profile:this.state.profile}):"certificate"===this.state.module?r.a.createElement(we,{config:this.state.config,module:this.state.module,name:this.state.name,profile:this.state.profile}):"oauth2"===this.state.module?r.a.createElement(Pe,{config:this.state.config,module:this.state.module,name:this.state.name,profile:this.state.profile}):r.a.createElement("div",null,r.a.createElement("h4",null,o.a.t("profile.scheme-not-found",{module:this.state.module})))}}]),t}(),je=a(12);function Ae(e){return(Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xe(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ie(e,t){return(Ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ue(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function De(e){return(De=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qe=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ie(e,t)}(t,n.Component);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=De(e);if(t){var r=De(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return function(e,t){return!t||"object"!==Ae(t)&&"function"!=typeof t?Ue(e):t}(this,a)}}(t);function t(a){var n;return function(e,a){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),(n=e.call(this,a)).state={title:a.title,message:a.message},n.closeModal=n.closeModal.bind(Ue(n)),n}return function(e,t,a){t&&xe(e.prototype,t)}(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({title:e.title,message:e.message})}},{key:"closeModal",value:function(e,t){$("#messageModal").modal("hide")}},{key:"render",value:function(){var e=this,t=[];return this.state.message&&this.state.message.forEach(function(e,a){t.push(r.a.createElement("li",{key:a},e))}),r.a.createElement("div",{className:"modal fade on-top",id:"messageModal",tabIndex:"-1",role:"dialog","aria-labelledby":"messageModalLabel","aria-hidden":"true"},r.a.createElement("div",{className:"modal-dialog",role:"document"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title",id:"messageModalLabel"},this.state.title),r.a.createElement("button",{type:"button",className:"close","aria-label":o.a.t("modal.close"),onClick:function(t){return e.closeModal(t,!1)}},r.a.createElement("span",{"aria-hidden":"true"},"×"))),r.a.createElement("div",{className:"modal-body"},r.a.createElement("ul",null,t)),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(t){return e.closeModal(t,!1)}},o.a.t("modal.close"))))))}}]),t}();function Ve(e){return(Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fe(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function He(e,t){return(He=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ge(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Be(e){return(Be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var We=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&He(e,t)}(t,n.Component);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Be(e);if(t){var r=Be(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return function(e,t){return!t||"object"!==Ve(t)&&"function"!=typeof t?Ge(e):t}(this,a)}}(t);function t(a){var n;return function(e,a){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),(n=e.call(this,a)).state={title:a.title,message:a.message,value:a.value,placeHolder:a.placeHolder,cb:a.callback},n.closeModal=n.closeModal.bind(Ge(n)),n.changeValue=n.changeValue.bind(Ge(n)),n}return function(e,t,a){t&&Fe(e.prototype,t)}(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({title:e.title,message:e.message,value:e.value,placeHolder:e.placeHolder,cb:e.callback})}},{key:"closeModal",value:function(e,t){this.state.cb&&this.state.cb(t,this.state.value)}},{key:"changeValue",value:function(e){this.setState({value:e.target.value})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"modal fade on-top",id:"editModal",tabIndex:"-1",role:"dialog","aria-labelledby":"editModalLabel","aria-hidden":"true"},r.a.createElement("div",{className:"modal-dialog modal-lg",role:"document"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title",id:"editModalLabel"},this.state.title),r.a.createElement("button",{type:"button",className:"close","aria-label":o.a.t("modal.close"),onClick:function(t){return e.closeModal(t,!1)}},r.a.createElement("span",{"aria-hidden":"true"},"×"))),r.a.createElement("div",{className:"modal-body"},this.state.message,r.a.createElement("form",{className:"needs-validation",noValidate:!0},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"text",className:"form-control",id:"editModalInput",placeholder:this.state.placeHolder||"",value:this.state.value,onChange:function(t){return e.changeValue(t)}})))),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(t){return e.closeModal(t,!1)}},o.a.t("modal.close")),r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(t){return e.closeModal(t,!0)}},o.a.t("modal.ok"))))))}}]),t}();function ze(e){return(ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Je(e,t){return(Je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ke(e){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ye(e,t){t=t||window.location.href,e=e.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null}var Xe=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Je(e,t)}(t,n.Component);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Ke(e);if(t){var r=Ke(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return function(e,t){return!t||"object"!==ze(t)&&"function"!=typeof t?Qe(e):t}(this,a)}}(t);function t(a){var n;return function(e,a){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),(n=e.call(this,a)).state={lang:o.a.language,config:a.config,registerConfig:!1,registerProfile:!1,registerSchemes:{},schemeHighlight:{},registering:!1,registerValid:!0,curNav:"profile",profileList:!1,profileUpdate:!1,schemeList:[],loggedIn:!1,confirmModal:{title:"",message:"",callback:!1},messageModal:{title:"",message:""},editModal:{title:"",message:"",value:"",placeHolder:"",callback:!1},plugins:{oauth2:{},oidc:{}},invalidCredentialMessage:!1,invalidDelegateMessage:!1,tokenParsed:!1,registerDefaultLang:!1,updateEmail:[],updateEmailModule:!1,register:!1},n.fetchProfile=n.fetchProfile.bind(Qe(n)),n.updateEmailCallback=n.updateEmailCallback.bind(Qe(n)),m.a.subscribe("App",function(e){if("nav"===e.type)"password"===e.page?n.setState({curNav:"password"}):"session"===e.page?n.setState({curNav:"session"}):"profile"===e.page?n.setState({curNav:"profile"}):n.setState({curNav:e.module,module:e.page});else if("loggedIn"===e.type)n.setState({loggedIn:e.loggedIn},function(){n.fetchProfile()});else if("lang"===e.type)n.setState({lang:o.a.language},function(){n.state.config.params.register&&n.state.registerConfig.languages.length&&n.state.registerConfig.languages.forEach(function(e){e===n.state.lang&&n.setState({registerDefaultLang:e})})});else if("profile"===e.type)n.fetchProfile();else if("confirm"===e.type){var t=n.state.confirmModal;t.title=e.title,t.message=e.message,t.callback=e.callback,n.setState({confirmModal:t},function(){$("#confirmModal").modal({keyboard:!1,show:!0})})}else if("message"===e.type){var a=n.state.messageModal;a.title=e.title,a.message=e.message,n.setState({messageModal:a},function(){$("#messageModal").modal({keyboard:!1,show:!0})})}else if("closeConfirm"===e.type)$("#confirmModal").modal("hide");else if("registration"===e.type)n.state.config.params.register&&n.setState({registerProfile:!1,schemeList:[],profileList:!1},function(){n.fetchRegistration()});else if("registrationComplete"===e.type)n.state.config.params.register?n.setState({registerProfile:!1,schemeList:[],profileList:!1,registering:!1}):n.setState({registerProfile:!1,schemeList:[],profileList:!1,registering:!1},function(){n.fetchRegistration()});else if("updateEmailAvailable"===e.type){var r=n.state.updateEmail;e.module&&r.push(e.module),n.setState({updateEmail:r,register:!0})}else if("updateEmail"===e.type&&e.module){var s={title:o.a.t("profile.update-email-modal-title"),message:o.a.t("profile.update-email-modal-message"),value:"",placeHolder:o.a.t("profile.update-email-modal-ph"),callback:n.updateEmailCallback};n.setState({editModal:s,updateEmailModule:e.module},function(){$("#editModal").modal({keyboard:!1,show:!0})})}}),n.state.config&&(n.state.config.params.register?n.fetchRegistration():n.state.config.params.updateEmail?n.updateEmailVerifyToken(n.state.config.params.updateEmail,n.state.config.params.updateEmailToken).then(function(){m.a.sendMessage("Notification",{type:"success",message:o.a.t("profile.update-email-success")}),n.fetchProfile()}):n.fetchProfile()),n}return function(e,t,a){t&&$e(e.prototype,t)}(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:props.config})}},{key:"fetchProfile",value:function(){var e=this;this.state.config.params.delegate?u.a.glewlwydRequest("/profile/scheme").then(function(t){e.setState({loggedIn:!0,profileList:[{username:e.state.config.params.delegate}],schemeList:t,invalidCredentialMessage:!1,invalidDelegateMessage:!1},function(){e.state.config.params.scheme_name&&t.forEach(function(t){t.name===e.state.config.params.scheme_name&&m.a.sendMessage("Nav",{type:t.module,page:t.name})})})}).fail(function(t){e.setState({invalidCredentialMessage:!1,invalidDelegateMessage:!0},function(){401===t.status?m.a.sendMessage("Notification",{type:"danger",message:o.a.t("profile.requires-profile-scope")}):m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})}):u.a.glewlwydRequest("/profile_list").then(function(t){e.setState({profileList:t},function(){!t[0]||t[0].scope.indexOf(e.state.config.profile_scope)<0?e.setState({loggedIn:!1,schemeList:[],invalidDelegateMessage:!1,invalidCredentialMessage:!0,profileUpdate:!1},function(){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("profile.requires-profile-scope")})}):u.a.glewlwydRequest("/profile/scheme").then(function(t){e.setState({loggedIn:!0,schemeList:t,invalidDelegateMessage:!1,invalidCredentialMessage:!1,profileUpdate:!0},function(){e.state.config.params.scheme_name&&t.forEach(function(t){t.name===e.state.config.params.scheme_name&&m.a.sendMessage("Nav",{type:t.module,page:t.name})}),u.a.glewlwydRequest("/profile/session").then(function(t){e.setState({sessionList:t})}).fail(function(){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})}),u.a.glewlwydRequest("/profile/plugin").then(function(t){t.forEach(function(t){"oauth2-glewlwyd"===t.module?u.a.glewlwydRequestSub("/"+t.name+"/profile/token"+(e.state.config.params.delegate?"?impersonate="+e.state.config.params.delegate:"")).then(function(a){var n=e.state.plugins;n.oauth2[t.name]=a,e.setState({plugins:n})}).fail(function(e){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})}):"oidc"===t.module?u.a.glewlwydRequestSub("/"+t.name+"/token"+(e.state.config.params.delegate?"?impersonate="+e.state.config.params.delegate:"")).then(function(a){var n=e.state.plugins;n.oidc[t.name]=a,e.setState({plugins:n})}).fail(function(e){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})}):"register"===t.module&&u.a.glewlwydRequestSub("/"+t.name+"/update-email/").then(function(){var a=e.state.updateEmail;a.push(t.name),e.setState({updateEmail:a})})}),m.a.sendMessage("App",{type:"sessionComplete"})}).fail(function(){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})})}).fail(function(t){e.setState({loggedIn:!1,schemeList:[],invalidDelegateMessage:!1,invalidCredentialMessage:!0,profileUpdate:!1},function(){401===t.status?m.a.sendMessage("Notification",{type:"danger",message:o.a.t("profile.requires-profile-scope")}):m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})})})}).fail(function(t){e.setState({loggedIn:!1,profileList:!1,schemeList:[],invalidDelegateMessage:!1,invalidCredentialMessage:!0},function(){401===t.status?m.a.sendMessage("Notification",{type:"danger",message:o.a.t("profile.requires-profile-scope")}):m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})})}},{key:"fetchRegistration",value:function(){var e=this;u.a.glewlwydRequest("/"+this.state.config.params.register+"/config").then(function(t){var a=!1;e.state.lang&&t.languages.length&&t.languages.forEach(function(t){t===e.state.lang&&(a=e.state.lang)}),!a&&t.languages.length&&(a=t.languages[0]),e.setState({registerValid:!0,registerConfig:t,registerDefaultLang:a},function(){!e.state.config.params.token||e.state.tokenParsed?u.a.glewlwydRequest("/"+e.state.config.params.register+"/profile").then(function(a){e.setState({registerProfile:a,schemeList:t.schemes,profile:a,profileList:[a],registering:!0},function(){t.schemes.forEach(function(t){u.a.glewlwydRequest("/"+e.state.config.params.register+"/profile/scheme/register/canuse","PUT",{username:a.username,scheme_type:t.module,scheme_name:t.name}).then(function(){var a=e.state.registerSchemes,n=e.state.schemeHighlight;n[t.name]=!1,a[t.name]=!0,e.setState({registerSchemes:a,schemeHighlight:n})}).fail(function(){var a=e.state.registerSchemes,n=e.state.schemeHighlight;a[t.name]=!1,"always"==t.register&&(n[t.name]=!0),e.setState({registerSchemes:a,schemeHighlight:n})})})})}).fail(function(t){401!=t.status&&m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")}),e.setState({registerProfile:!1,registering:!1})}):u.a.glewlwydRequest("/"+e.state.config.params.register+"/verify","POST",{token:e.state.config.params.token}).then(function(){u.a.glewlwydRequest("/"+e.state.config.params.register+"/profile").then(function(a){e.setState({tokenParsed:!0,registerProfile:a,schemeList:t.schemes,profile:a,profileList:[a],registering:!0},function(){t.schemes.forEach(function(t){u.a.glewlwydRequest("/"+e.state.config.params.register+"/profile/scheme/register/canuse","PUT",{username:a.username,scheme_type:t.module,scheme_name:t.name}).then(function(){var a=e.state.registerSchemes;a[t.name]=!0,e.setState({registerSchemes:a})}).fail(function(){var a=e.state.registerSchemes;a[t.name]=!1,e.setState({registerSchemes:a})})})})}).fail(function(t){401!=t.status&&m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")}),e.setState({registerProfile:!1,registering:!1})})}).fail(function(t){401!=t.status?m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")}):m.a.sendMessage("Notification",{type:"danger",message:o.a.t("profile.register-token-invalid")}),e.setState({registerProfile:!1,registering:!1})})})}).fail(function(t){e.setState({registerValid:!1,registering:!1},function(){404===t.status?m.a.sendMessage("Notification",{type:"danger",message:o.a.t("profile.register-invalid-url")}):m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})})}},{key:"updateEmailVerifyToken",value:function(e,t){return u.a.glewlwydRequest("/"+e+"/update-email/"+encodeURIComponent(t),"PUT").fail(function(){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})}},{key:"showPasswordChangeNotification",value:function(e,t){e&&m.a.sendMessage("Notification",{type:"success",message:o.a.t("profile.password-change-success")})}},{key:"updateEmailCallback",value:function(e,t){var a=this;$("#editModal").modal("hide"),e&&u.a.glewlwydRequest("/"+this.state.updateEmailModule+"/update-email","POST",{email:t}).then(function(e){var n={title:o.a.t("profile.update-email-modal-title"),message:[o.a.t("profile.update-email-modal-complete-message",{email:t})]};a.setState({messageModal:n},function(){$("#messageModal").modal({keyboard:!1,show:!0})})}).fail(function(){m.a.sendMessage("Notification",{type:"danger",message:o.a.t("error-api-connect")})})}},{key:"render",value:function(){if(this.state.config){var e,t;return this.state.invalidCredentialMessage?e=r.a.createElement("div",{className:"alert alert-danger",role:"alert"},o.a.t("profile.error-credential-message")):this.state.invalidDelegateMessage&&(e=r.a.createElement("div",{className:"alert alert-danger",role:"alert"},o.a.t("admin.error-credential-message"))),t=this.state.config.params.delegate?r.a.createElement(R,{config:this.state.config,profile:!!this.state.profileList&&this.state.profileList[0]}):this.state.config.params.register?r.a.createElement(I,{config:this.state.config,registerConfig:this.state.registerConfig,registerProfile:this.state.registerProfile,registerSchemes:this.state.registerSchemes,registerValid:this.state.registerValid,registerDefaultLang:this.state.registerDefaultLang}):r.a.createElement(S,{config:this.state.config,profile:!!this.state.profileList&&this.state.profileList[0],pattern:!!this.state.config&&this.state.config.pattern.user,profileUpdate:this.state.profileUpdate,loggedIn:this.state.loggedIn,updateEmail:this.state.updateEmail}),r.a.createElement("div",{"aria-live":"polite","aria-atomic":"true",className:"glwd-container"},r.a.createElement("div",{className:"card center glwd-card",id:"userCard",tabIndex:"-1",role:"dialog"},r.a.createElement("div",{className:"card-header"},r.a.createElement(v,{active:this.state.curNav,config:this.state.config,loggedIn:this.state.loggedIn,schemeList:this.state.schemeList,profileList:this.state.profileList,dataHighlight:!this.state.registerProfile.password_set,schemeHighlight:this.state.schemeHighlight,registering:this.state.registering})),e,r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{id:"carouselBody",className:"carousel slide","data-ride":"carousel"},r.a.createElement("div",{className:"carousel-inner"},r.a.createElement("div",{className:"carousel-item"+("profile"===this.state.curNav?" active":"")},t),r.a.createElement("div",{className:"carousel-item"+("session"===this.state.curNav?" active":"")},r.a.createElement(H,{config:this.state.config,plugins:this.state.plugins})),r.a.createElement("div",{className:"carousel-item"+("password"===this.state.curNav?" active":"")},r.a.createElement(Q,{config:this.state.config,profile:!!this.state.profileList&&this.state.profileList[0],loggedIn:this.state.loggedIn,callback:this.showPasswordChangeNotification})),r.a.createElement("div",{className:"carousel-item"+("profile"!==this.state.curNav&&"session"!==this.state.curNav&&"password"!==this.state.curNav?" active":"")},r.a.createElement(Te,{config:this.state.config,module:this.state.curNav,name:this.state.module,profile:!!this.state.profileList&&this.state.profileList[0]})))))),r.a.createElement(f.a,{loggedIn:this.state.loggedIn||this.state.config.params.register}),r.a.createElement(je.a,{title:this.state.confirmModal.title,message:this.state.confirmModal.message,callback:this.state.confirmModal.callback}),r.a.createElement(qe,{title:this.state.messageModal.title,message:this.state.messageModal.message}),r.a.createElement(We,{title:this.state.editModal.title,message:this.state.editModal.message,value:this.state.editModal.value,placeHolder:this.state.editModal.placeHolder,callback:this.state.editModal.callback}))}return r.a.createElement("div",{"aria-live":"polite","aria-atomic":"true",className:"glwd-container"},r.a.createElement("div",{className:"card center glwd-card",id:"userCard",tabIndex:"-1",role:"dialog"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h4",null,r.a.createElement("span",{className:"badge badge-danger"},o.a.t("error-api-connect"))))))}}]),t}(),Ze=a(8);try{o.a.use(l.a).use(c.a).init({fallbackLng:"en",ns:["translations"],defaultNS:"translations",backend:{loadPath:"locales/{{lng}}/{{ns}}.json"}}).then(function(){u.a.request("config.json").then(function(e){e.lang||(e.lang=["en","fr","nl"]),u.a.request(e.GlewlwydUrl+"config/").then(function(t){Ye("delegate")?u.a.setConfig(e.GlewlwydUrl+t.api_prefix+"/delegate/"+Ye("delegate")):u.a.setConfig(e.GlewlwydUrl+t.api_prefix),u.a.setConfigSub(e.GlewlwydUrl+t.api_prefix);var a=Object.assign({params:{scope:Ye("scope"),client_id:Ye("client_id"),callback_url:Ye("callback_url"),delegate:Ye("delegate")||!1,register:Ye("register")||!1,updateEmail:Ye("updateEmail")||!1,updateEmailToken:Ye("token")||!1,token:Ye("token")||!1,scheme_name:Ye("scheme_name")||!1,provider:Ye("provider")||!1}},e,t);i.a.render(r.a.createElement(Xe,{config:a}),document.getElementById("root"))}).fail(function(e){i.a.render(r.a.createElement(Xe,{config:!1}),document.getElementById("root"))})}).fail(function(e){i.a.render(r.a.createElement(Ze.a,null),document.getElementById("root"))})})}catch(e){$("#root").html('<div class="alert alert-danger" role="alert"><i class="fas fa-exclamation-triangle"></i><span class="btn-icon-right">You must use a browser compatible with Glewlwyd SSO</span></div>')}},3:function(e,t,a){"use strict";var n=a(2);function r(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=new(function(){function e(){!function(t,a){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.GlewlwydApiPrefix="",this.GlewlwydApiPrefixSub=""}return function(e,t,a){t&&r(e.prototype,t)}(e,[{key:"setConfig",value:function(e){this.GlewlwydApiPrefix=e}},{key:"getConfig",value:function(e){return this.GlewlwydApiPrefix}},{key:"setConfigSub",value:function(e){this.GlewlwydApiPrefixSub=e}},{key:"getConfigSub",value:function(e){return this.GlewlwydApiPrefixSub}},{key:"request",value:function(e,t,a){var n=1<arguments.length&&void 0!==t?t:"GET",r=2<arguments.length&&void 0!==a&&a;return r&&"GET"!==n?$.ajax({method:n,url:e,data:JSON.stringify(r),contentType:"application/json; charset=utf-8"}):$.ajax({method:n,url:e})}},{key:"glewlwydRequest",value:function(e,t,a,r){var s=1<arguments.length&&void 0!==t?t:"GET",i=2<arguments.length&&void 0!==a&&a,o=3<arguments.length&&void 0!==r&&r;return this.request(this.GlewlwydApiPrefix+e,s,i).fail(function(e){o&&401===e.status&&n.a.sendMessage("App",{type:"loggedIn",message:!1})})}},{key:"glewlwydRequestSub",value:function(e,t,a){var n=1<arguments.length&&void 0!==t?t:"GET",r=2<arguments.length&&void 0!==a&&a;return this.request(this.GlewlwydApiPrefixSub+e,n,r)}}]),e}());t.a=s},4:function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(2);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,n.Component);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=u(e);if(t){var r=u(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return function(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?c(e):t}(this,a)}}(t);function t(a){var n;return function(e,a){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),(n=e.call(this,a)).state={message:[],counter:0,loggedIn:a.loggedIn},s.a.subscribe("Notification",function(e){if(e.type){var t=n.state.message;t.push({type:e.type,message:e.message,id:n.state.counter}),n.setState({message:t,counter:n.state.counter+1},function(){n.timeoutClose(n.state.counter-1)})}}),n.close=n.close.bind(c(n)),n.timeoutClose=n.timeoutClose.bind(c(n)),n}return function(e,t,a){t&&o(e.prototype,t)}(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({loggedIn:e.loggedIn})}},{key:"timeoutClose",value:function(e){var t=this;setTimeout(function(){t.close(e)},5e3)}},{key:"close",value:function(e){var t=this,a=this.state.message;a.forEach(function(n,r){n.id===e&&(a.splice(r,1),t.setState({message:a}))})}},{key:"render",value:function(){var e=this,t=[];return this.state.loggedIn&&this.state.message.forEach(function(a,n){var s;s="success"===a.type?r.a.createElement("strong",{className:"mr-auto"},r.a.createElement("span",{className:"badge badge-success btn-icon"},r.a.createElement("i",{className:"fas fa-check-circle"})),"Glewlwyd"):"danger"===a.type?r.a.createElement("strong",{className:"mr-auto"},r.a.createElement("span",{className:"badge badge-danger btn-icon"},r.a.createElement("i",{className:"fas fa-exclamation-circle"})),"Glewlwyd"):"warning"===a.type?r.a.createElement("strong",{className:"mr-auto"},r.a.createElement("span",{className:"badge badge-warning btn-icon"},r.a.createElement("i",{className:"fas fa-exclamation-circle"})),"Glewlwyd"):r.a.createElement("strong",{className:"mr-auto"},r.a.createElement("span",{className:"badge badge-info btn-icon"},r.a.createElement("i",{className:"fas fa-info-circle"})),"Glewlwyd"),t.push(r.a.createElement("div",{className:"toast-container",style:{top:95+90*n,right:5},key:n},r.a.createElement("div",{className:"toast glwd-toast",role:"alert","aria-live":"assertive","aria-atomic":"true"},r.a.createElement("div",{className:"toast-header"},s,r.a.createElement("button",{type:"button",className:"ml-2 mb-1 close","data-dismiss":"toast","aria-label":"Close",onClick:function(){return e.close(a.id)}},r.a.createElement("span",{"aria-hidden":"true"},"×"))),r.a.createElement("div",{className:"toast-body"},a.message))))}),r.a.createElement("div",null,t)}}]),t}();t.a=m},8:function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(1);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,n.Component);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=c(e);if(t){var r=c(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return function(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}(this,a)}}(t);function t(a){return function(e,a){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),e.call(this,a)}return function(e,t,a){t&&o(e.prototype,t)}(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"alert alert-danger perfect-centering",role:"alert"},s.a.t("error-config"))}}]),t}();t.a=u}})});