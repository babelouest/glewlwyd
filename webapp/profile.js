!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var a=t();for(var s in a)("object"==typeof exports?exports:e)[s]=a[s]}}(window,(function(){return function(e){function t(t){for(var s,r,i=t[0],o=t[1],c=t[2],u=0,f=[];u<i.length;u++)r=i[u],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&f.push(n[r][0]),n[r]=0;for(s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s]);for(d&&d(t);f.length;)f.shift()();return l.push.apply(l,c||[]),a()}function a(){for(var e,t=0;t<l.length;t++){for(var a=l[t],s=!0,i=1;i<a.length;i++){var o=a[i];0!==n[o]&&(s=!1)}s&&(l.splice(t--,1),e=r(r.s=a[0]))}return e}var s={},n={3:0},l=[];function r(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=s,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(a,s,function(t){return e[t]}.bind(null,s));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var i=window.webpackJsonp=window.webpackJsonp||[],o=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var d=o;return l.push([71,0,4]),a()}({12:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var n=a(0),l=i(n),r=i(a(1));function i(e){return e&&e.__esModule?e:{default:e}}var o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,n.Component),function(e,t,a){t&&s(e.prototype,t),a&&s(e,a)}(c,[{key:"componentWillReceiveProps",value:function(e){this.setState({title:e.title,message:e.message,cb:e.callback})}},{key:"closeModal",value:function(e,t){this.state.cb&&this.state.cb(t)}},{key:"render",value:function(){var e=this;return l.default.createElement("div",{className:"modal fade",id:"confirmModal",tabIndex:"-1",role:"dialog","aria-labelledby":"confirmModalLabel","aria-hidden":"true"},l.default.createElement("div",{className:"modal-dialog",role:"document"},l.default.createElement("div",{className:"modal-content"},l.default.createElement("div",{className:"modal-header"},l.default.createElement("h5",{className:"modal-title",id:"confirmModalLabel"},this.state.title),l.default.createElement("button",{type:"button",className:"close","aria-label":r.default.t("modal.close"),onClick:function(t){return e.closeModal(t,!1)}},l.default.createElement("span",{"aria-hidden":"true"},"×"))),l.default.createElement("div",{className:"modal-body"},this.state.message),l.default.createElement("div",{className:"modal-footer"},l.default.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(t){return e.closeModal(t,!1)}},r.default.t("modal.close")),l.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(t){return e.closeModal(t,!0)}},r.default.t("modal.ok"))))))}}]),c);function c(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,e));return t.state={title:e.title,message:e.message,cb:e.callback},t.closeModal=t.closeModal.bind(t),t}t.default=o},2:function(e,t,a){"use strict";function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.subscriberList={}}Object.defineProperty(t,"__esModule",{value:!0});var l=new(function(e,t,a){t&&s(e.prototype,t)}(n,[{key:"subscribe",value:function(e,t){this.subscriberList[e]=t}},{key:"sendMessage",value:function(e,t){if(Array.isArray(e)||(e=[e]),"broadcast"===e[0])this.subscriberList.forEach((function(e,a){e({type:"broadcast",message:t})}));else for(var a in this.subscriberList)0<=e.indexOf(a)&&this.subscriberList[a](t)}}]),n);t.default=l},3:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var n,l=(n=a(2))&&n.__esModule?n:{default:n};function r(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.GlewlwydApiPrefix="",this.GlewlwydApiPrefixSub=""}var i=new(function(e,t,a){t&&s(e.prototype,t),a&&s(e,a)}(r,[{key:"setConfig",value:function(e){this.GlewlwydApiPrefix=e}},{key:"getConfig",value:function(e){return this.GlewlwydApiPrefix}},{key:"setConfigSub",value:function(e){this.GlewlwydApiPrefixSub=e}},{key:"getConfigSub",value:function(e){return this.GlewlwydApiPrefixSub}},{key:"request",value:function(e,t,a){var s=1<arguments.length&&void 0!==t?t:"GET",n=2<arguments.length&&void 0!==a&&a;return n&&"GET"!==s?$.ajax({method:s,url:e,data:JSON.stringify(n),contentType:"application/json; charset=utf-8"}):$.ajax({method:s,url:e})}},{key:"glewlwydRequest",value:function(e,t,a,s){var n=1<arguments.length&&void 0!==t?t:"GET",r=2<arguments.length&&void 0!==a&&a,i=3<arguments.length&&void 0!==s&&s;return this.request(this.GlewlwydApiPrefix+e,n,r).fail((function(e){i&&401===e.status&&l.default.sendMessage("App",{type:"loggedIn",message:!1})}))}},{key:"glewlwydRequestSub",value:function(e,t,a){var s=1<arguments.length&&void 0!==t?t:"GET",n=2<arguments.length&&void 0!==a&&a;return this.request(this.GlewlwydApiPrefixSub+e,s,n)}}]),r);t.default=i},6:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var n=a(0),l=i(n),r=i(a(2));function i(e){return e&&e.__esModule?e:{default:e}}var o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,n.Component),function(e,t,a){t&&s(e.prototype,t),a&&s(e,a)}(c,[{key:"timeoutClose",value:function(e){var t=this;setTimeout((function(){t.close(e)}),5e3)}},{key:"close",value:function(e){var t=this,a=this.state.message;a.forEach((function(s,n){s.id===e&&(a.splice(n,1),t.setState({message:a}))}))}},{key:"render",value:function(){var e=this,t=[];return this.state.message.forEach((function(a,s){var n;n="success"===a.type?l.default.createElement("strong",{className:"mr-auto"},l.default.createElement("span",{className:"badge badge-success btn-icon"},l.default.createElement("i",{className:"fas fa-check-circle"})),"Glewlwyd"):"danger"===a.type?l.default.createElement("strong",{className:"mr-auto"},l.default.createElement("span",{className:"badge badge-danger btn-icon"},l.default.createElement("i",{className:"fas fa-exclamation-circle"})),"Glewlwyd"):"warning"===a.type?l.default.createElement("strong",{className:"mr-auto"},l.default.createElement("span",{className:"badge badge-warning btn-icon"},l.default.createElement("i",{className:"fas fa-exclamation-circle"})),"Glewlwyd"):l.default.createElement("strong",{className:"mr-auto"},l.default.createElement("span",{className:"badge badge-info btn-icon"},l.default.createElement("i",{className:"fas fa-info-circle"})),"Glewlwyd"),t.push(l.default.createElement("div",{className:"toast-container",style:{top:85+90*s,right:5},key:s},l.default.createElement("div",{className:"toast",role:"alert","aria-live":"assertive","aria-atomic":"true"},l.default.createElement("div",{className:"toast-header"},n,l.default.createElement("button",{type:"button",className:"ml-2 mb-1 close","data-dismiss":"toast","aria-label":"Close",onClick:function(){return e.close(a.id)}},l.default.createElement("span",{"aria-hidden":"true"},"×"))),l.default.createElement("div",{className:"toast-body"},a.message))))})),l.default.createElement("div",null,t)}}]),c);function c(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,e));return t.state={message:[],counter:0},r.default.subscribe("Notification",(function(e){if(e.type){var a=t.state.message;a.push({type:e.type,message:e.message,id:t.state.counter}),t.setState({message:a,counter:t.state.counter+1},(function(){t.timeoutClose(t.state.counter-1)}))}})),t.close=t.close.bind(t),t.timeoutClose=t.timeoutClose.bind(t),t}t.default=o},71:function(e,t,a){"use strict";var s=d(a(0)),n=d(a(9)),l=d(a(1)),r=d(a(10)),i=d(a(11)),o=d(a(3)),c=d(a(72));function d(e){return e&&e.__esModule?e:{default:e}}function u(e,t){t=t||window.location.href,e=e.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null}try{l.default.use(r.default).use(i.default).init({fallbackLng:"en",ns:["translations"],defaultNS:"translations",backend:{loadPath:"locales/{{lng}}/{{ns}}.json"}}).then((function(){o.default.request("config.json").then((function(e){e.lang||(e.lang=["en","fr","nl"]),o.default.request(e.GlewlwydUrl+"config/").then((function(t){u("delegate")?o.default.setConfig(e.GlewlwydUrl+t.api_prefix+"/delegate/"+u("delegate")):o.default.setConfig(e.GlewlwydUrl+t.api_prefix),o.default.setConfigSub(e.GlewlwydUrl+t.api_prefix);var a=Object.assign({params:{scope:u("scope"),client_id:u("client_id"),callback_url:u("callback_url"),delegate:u("delegate")||!1,register:u("register")||!1}},e,t);n.default.render(s.default.createElement(c.default,{config:a}),document.getElementById("root"))})).fail((function(e){n.default.render(s.default.createElement(c.default,{config:!1}),document.getElementById("root"))}))}))}))}catch(e){$("#root").html('<div class="alert alert-danger" role="alert"><i class="fas fa-exclamation-triangle"></i><span class="btn-icon-right">You must use a browser compatible with Glewlwyd SSO</span></div>')}},72:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var n=a(0),l=v(n),r=v(a(1)),i=v(a(3)),o=v(a(2)),c=v(a(6)),d=v(a(73)),u=v(a(74)),f=v(a(75)),m=v(a(76)),p=v(a(77)),g=v(a(78)),h=v(a(79)),b=v(a(12)),y=v(a(85));function v(e){return e&&e.__esModule?e:{default:e}}var E=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(w,n.Component),function(e,t,a){t&&s(e.prototype,t),a&&s(e,a)}(w,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:props.config})}},{key:"fetchProfile",value:function(){var e=this;this.state.config.params.delegate?i.default.glewlwydRequest("/profile/scheme").then((function(t){e.setState({loggedIn:!0,profileList:[{username:e.state.config.params.delegate}],schemeList:t,invalidCredentialMessage:!1,invalidDelegateMessage:!1})})).fail((function(t){e.setState({invalidCredentialMessage:!1,invalidDelegateMessage:!0},(function(){401===t.status?o.default.sendMessage("Notification",{type:"danger",message:r.default.t("profile.requires-admin-scope")}):o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})}))})):i.default.glewlwydRequest("/profile_list").then((function(t){!t[0]||t[0].scope.indexOf(e.state.config.profile_scope)<0?e.setState({invalidDelegateMessage:!0},(function(){o.default.sendMessage("Notification",{type:"danger",message:r.default.t("profile.requires-profile-scope")})})):e.setState({profileList:t},(function(){i.default.glewlwydRequest("/profile/scheme").then((function(t){e.setState({loggedIn:!0,schemeList:t,invalidDelegateMessage:!1,invalidCredentialMessage:!1})})).fail((function(t){e.setState({invalidDelegateMessage:!1,invalidCredentialMessage:!0},(function(){401===t.status?o.default.sendMessage("Notification",{type:"danger",message:r.default.t("profile.requires-profile-scope")}):o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})}))}))}))})).fail((function(t){e.setState({invalidDelegateMessage:!1,invalidCredentialMessage:!0},(function(){401===t.status?o.default.sendMessage("Notification",{type:"danger",message:r.default.t("profile.requires-profile-scope")}):o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})}))}))}},{key:"fetchRegistration",value:function(){var e=this;i.default.glewlwydRequest("/"+this.state.config.params.register+"/config").then((function(t){i.default.glewlwydRequest("/"+e.state.config.params.register+"/profile").then((function(a){e.setState({registerProfile:a,schemeList:t.schemes,profile:a,profileList:[a]},(function(){t.schemes.forEach((function(t){i.default.glewlwydRequest("/"+e.state.config.params.register+"/profile/scheme/register/canuse","PUT",{username:a.username,scheme_type:t.module,scheme_name:t.name}).then((function(){var a=e.state.registerSchemes;a[t.name]=!0,e.setState({registerSchemes:a})})).fail((function(){var a=e.state.registerSchemes;a[t.name]=!1,e.setState({registerSchemes:a})}))}))}))})).fail((function(t){401!=t.status&&o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")}),e.setState({registerProfile:!1})})).always((function(){e.setState({registerConfig:t})}))})).fail((function(){o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})}))}},{key:"closePasswordModal",value:function(e,t){$("#passwordModal").modal("hide"),e&&o.default.sendMessage("Notification",{type:"success",message:r.default.t("profile.password-change-success")})}},{key:"render",value:function(){if(this.state.config){var e,t;return this.state.invalidCredentialMessage?e=l.default.createElement("div",{className:"alert alert-danger",role:"alert"},r.default.t("profile.error-credential-message")):this.state.invalidDelegateMessage&&(e=l.default.createElement("div",{className:"alert alert-danger",role:"alert"},r.default.t("admin.error-credential-message"))),t=this.state.config.params.delegate?l.default.createElement(f.default,{config:this.state.config,profile:!!this.state.profileList&&this.state.profileList[0]}):this.state.config.params.register?l.default.createElement(m.default,{config:this.state.config,registerConfig:this.state.registerConfig,registerProfile:this.state.registerProfile,registerSchemes:this.state.registerSchemes}):l.default.createElement(u.default,{config:this.state.config,profile:!!this.state.profileList&&this.state.profileList[0],pattern:!!this.state.config&&this.state.config.pattern.user}),l.default.createElement("div",{"aria-live":"polite","aria-atomic":"true",style:{position:"relative",minHeight:"200px"}},l.default.createElement("div",{className:"card center",id:"userCard",tabIndex:"-1",role:"dialog",style:{marginTop:"20px",marginBottom:"20px"}},l.default.createElement("div",{className:"card-header"},l.default.createElement(d.default,{active:this.state.curNav,config:this.state.config,loggedIn:this.state.loggedIn,schemeList:this.state.schemeList,profileList:this.state.profileList})),e,l.default.createElement("div",{className:"card-body"},l.default.createElement("div",{id:"carouselBody",className:"carousel slide","data-ride":"carousel"},l.default.createElement("div",{className:"carousel-inner"},l.default.createElement("div",{className:"carousel-item"+("profile"===this.state.curNav?" active":"")},t),l.default.createElement("div",{className:"carousel-item"+("session"===this.state.curNav?" active":"")},l.default.createElement(p.default,{config:this.state.config,profile:!!this.state.profileList&&this.state.profileList[0],loggedIn:this.state.loggedIn})),l.default.createElement("div",{className:"carousel-item"+("profile"!==this.state.curNav&&"session"!==this.state.curNav?" active":"")},l.default.createElement(h.default,{config:this.state.config,module:this.state.curNav,name:this.state.module,profile:!!this.state.profileList&&this.state.profileList[0]})))))),l.default.createElement(c.default,null),l.default.createElement(g.default,{config:this.state.config,callback:this.closePasswordModal}),l.default.createElement(b.default,{title:this.state.confirmModal.title,message:this.state.confirmModal.message,callback:this.state.confirmModal.callback}),l.default.createElement(y.default,{title:this.state.messageModal.title,message:this.state.messageModal.message}))}return l.default.createElement("div",{"aria-live":"polite","aria-atomic":"true",style:{position:"relative",minHeight:"200px"}},l.default.createElement("div",{className:"card center",id:"userCard",tabIndex:"-1",role:"dialog",style:{marginTop:"20px",marginBottom:"20px"}},l.default.createElement("div",{className:"card-header"},l.default.createElement("h4",null,l.default.createElement("span",{className:"badge badge-danger"},r.default.t("error-api-connect"))))))}}]),w);function w(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,w);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,e));return t.state={lang:r.default.language,config:e.config,registerConfig:!1,registerProfile:!1,registerSchemes:{},curNav:"profile",profileList:!1,schemeList:[],loggedIn:!1,confirmModal:{title:"",message:"",callback:!1},messageModal:{title:"",message:""},invalidCredentialMessage:!1,invalidDelegateMessage:!1},t.fetchProfile=t.fetchProfile.bind(t),t.closePasswordModal=t.closePasswordModal.bind(t),o.default.subscribe("App",(function(e){if("nav"===e.type)"password"===e.page?$("#passwordModal").modal({keyboard:!1,show:!0}):"session"===e.page?t.setState({curNav:"session"}):"profile"===e.page?t.setState({curNav:"profile"}):t.setState({curNav:e.module,module:e.page});else if("loggedIn"===e.type)t.setState({loggedIn:e.message},(function(){t.state.loggedIn?t.fetchProfile():t.setState({profileList:!1,schemeList:[]})}));else if("lang"===e.type)t.setState({lang:r.default.language});else if("profile"===e.type)t.fetchProfile();else if("confirm"===e.type){var a=t.state.confirmModal;a.title=e.title,a.message=e.message,a.callback=e.callback,t.setState({confirmModal:a},(function(){$("#confirmModal").modal({keyboard:!1,show:!0})}))}else if("message"===e.type){var s=t.state.messageModal;s.title=e.title,s.message=e.message,t.setState({messageModal:s},(function(){$("#messageModal").modal({keyboard:!1,show:!0})}))}else"closeConfirm"===e.type?$("#confirmModal").modal("hide"):"registration"===e.type&&t.fetchRegistration()})),t.state.config&&(t.state.config.params.register?t.fetchRegistration():t.fetchProfile()),t}t.default=E},73:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var n=a(0),l=c(n),r=c(a(1)),i=c(a(2)),o=c(a(3));function c(e){return e&&e.__esModule?e:{default:e}}var d=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(u,n.Component),function(e,t,a){t&&s(e.prototype,t),a&&s(e,a)}(u,[{key:"componentWillReceiveProps",value:function(e){this.setState({loggedIn:e.loggedIn,schemeList:e.schemeList,profileList:e.profileList})}},{key:"navigate",value:function(e,t,a){e.preventDefault(),i.default.sendMessage("App",{type:"nav",page:t,module:a}),this.setState({curNav:t})}},{key:"toggleLogin",value:function(){if(this.state.loggedIn)o.default.glewlwydRequest("/auth/?username="+encodeURIComponent(this.state.profileList[0].username),"DELETE").then((function(){i.default.sendMessage("Notification",{type:"info",message:r.default.t("login.success-delete-session")}),i.default.sendMessage("App",{type:"loggedIn",loggedIn:!1})})).fail((function(e){401!==e.status&&i.default.sendMessage("Notification",{type:"danger",message:r.default.t("login.error-delete-session")}),i.default.sendMessage("App",{type:"loggedIn",loggedIn:!1})}));else{var e=!1;this.state.config.sessionSchemes.forEach((function(t){t.scheme_default&&t.scheme_default.forEach((function(a){"profile"===a&&(e=t.scheme_name)}))})),document.location.href=this.state.config.LoginUrl+"?callback_url="+encodeURIComponent([location.protocol,"//",location.host,location.pathname].join(""))+"&scope="+encodeURIComponent(this.state.config.profile_scope)+(e?"&scheme="+encodeURIComponent(e):"")}}},{key:"changeLang",value:function(e,t){var a=this;r.default.changeLanguage(t).then((function(){a.setState({lang:t}),i.default.sendMessage("App",{type:"lang"})}))}},{key:"changeProfile",value:function(e,t){if(t)o.default.glewlwydRequest("/auth/","POST",{username:t.username}).then((function(){i.default.sendMessage("App",{type:"profile"})})).fail((function(){i.default.sendMessage("Notification",{type:"danger",message:r.default.t("login.error-login")})}));else{var a=!1;this.state.config.sessionSchemes.forEach((function(e){e.scheme_default&&e.scheme_default.forEach((function(t){"admin"===t&&(a=e.scheme_name)}))})),document.location.href=this.state.config.LoginUrl+"?callback_url="+encodeURIComponent([location.protocol,"//",location.host,location.pathname].join(""))+"&scope="+encodeURIComponent(this.state.config.profile_scope)+(a?"&scheme="+encodeURIComponent(a):"")}}},{key:"render",value:function(){var e,t,a,s,n=this,i=[],o=[],c=[];return this.state.config.lang.forEach((function(e,t){e===r.default.language?i.push(l.default.createElement("a",{className:"dropdown-item active",href:"#",key:t},e)):i.push(l.default.createElement("a",{className:"dropdown-item",href:"#",onClick:function(t){return n.changeLang(t,e)},key:t},e))})),this.state.schemeList.forEach((function(e,t){"retype-password"!==e.module&&"email"!==e.module&&o.push(l.default.createElement("li",{className:"nav-item"+(n.state.curNav===e.name?" active":""),key:t},l.default.createElement("a",{className:"nav-link",href:"#",onClick:function(t){return n.navigate(t,e.name,e.module)}},e.display_name||e.name)))})),this.state.config.params.delegate||this.state.config.params.register||(a=l.default.createElement("li",{className:"nav-item"+("password"===this.state.curNav?" active":"")},l.default.createElement("a",{className:"nav-link",href:"#",onClick:function(e){return n.navigate(e,"password",null)}},r.default.t("profile.menu-password")))),this.state.profileList&&!this.state.config.params.register&&(s=l.default.createElement("li",{className:"nav-item"+("session"===this.state.curNav?" active":"")},l.default.createElement("a",{className:"nav-link",href:"#",onClick:function(e){return n.navigate(e,"session",null)}},r.default.t("profile.menu-session")))),this.state.profileList&&this.state.profileList.forEach((function(e,t){c.push(l.default.createElement("a",{className:"dropdown-item"+(t?"":" active"),href:"#",onClick:function(t){return n.changeProfile(t,e)},key:t},e.name||e.username))})),c.push(l.default.createElement("div",{className:"dropdown-divider",key:c.length})),c.push(l.default.createElement("a",{className:"dropdown-item",href:"#",onClick:function(e){return n.changeProfile(e,null)},key:c.length},r.default.t("profile.menu-session-new"))),this.state.config.params.register||(e=l.default.createElement("div",{className:"btn-group",role:"group"},l.default.createElement("button",{className:"btn btn-secondary dropdown-toggle",type:"button",id:"dropdownProfile","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},l.default.createElement("i",{className:"fas fa-user"})),l.default.createElement("div",{className:"dropdown-menu","aria-labelledby":"dropdownProfile"},c)),t=l.default.createElement("button",{type:"button",className:"btn btn-secondary",onClick:this.toggleLogin},l.default.createElement("i",{className:"fas fa-sign-in-alt btn-icon"}))),l.default.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},l.default.createElement("a",{className:"navbar-brand",href:"#"},"Glewlwyd"),l.default.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},l.default.createElement("span",{className:"navbar-toggler-icon"})),l.default.createElement("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent"},l.default.createElement("ul",{className:"navbar-nav mr-auto"},l.default.createElement("li",{className:"nav-item"+("profile"===this.state.curNav?" active":"")},l.default.createElement("a",{className:"nav-link",href:"#",onClick:function(e){return n.navigate(e,"profile",null)}},r.default.t("profile.menu-user"))),s,a,o),l.default.createElement("div",{className:"btn-group",role:"group"},l.default.createElement("div",{className:"btn-group",role:"group"},l.default.createElement("button",{className:"btn btn-secondary dropdown-toggle",type:"button",id:"dropdownLang","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},l.default.createElement("i",{className:"fas fa-globe-africa"})),l.default.createElement("div",{className:"dropdown-menu","aria-labelledby":"dropdownLang"},i)),e,t)))}}]),u);function u(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,e));return t.state={config:e.config,curNav:"profile",loggedIn:e.loggedIn,schemeList:e.schemeList,profileList:e.profileList},i.default.subscribe("Navbar",(function(e){})),t.navigate=t.navigate.bind(t),t.toggleLogin=t.toggleLogin.bind(t),t.changeLang=t.changeLang.bind(t),t.changeProfile=t.changeProfile.bind(t),t}t.default=d},74:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var n=a(0),l=c(n),r=c(a(1)),i=c(a(3)),o=c(a(2));function c(e){return e&&e.__esModule?e:{default:e}}c(a(6));var d=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(u,n.Component),function(e,t,a){t&&s(e.prototype,t),a&&s(e,a)}(u,[{key:"componentWillReceiveProps",value:function(e){this.setState({pattern:e.pattern,profile:e.profile,listAddValue:this.initListAdd(e.pattern),listEltConfirm:this.initListConfirm(e.pattern),listError:{}})}},{key:"createData",value:function(){var e={};this.state.pattern.forEach((function(t,a){t.list?e[t.name]=[]:t.defaultValue?e[t.name]=t.defaultValue:e[t.name]=""})),this.setState({data:e})}},{key:"initListAdd",value:function(e){var t={};return e&&e.forEach((function(e){e.list&&(t[e.name]="")})),t}},{key:"initListConfirm",value:function(e){var t={};return e&&e.forEach((function(e){e.confirm&&(t[e.name]="")})),t}},{key:"deleteListElt",value:function(e,t,a){var s=this.state.profile;s[t]&&(s[t].splice(a,1),this.setState({profile:s}))}},{key:"changeElt",value:function(e,t){var a=this.state.profile;a[t]=e.target.value,this.setState({profile:a})}},{key:"toggleBooleanElt",value:function(e,t){var a=this.state.profile;a[t]=!a[t],this.setState({profile:a})}},{key:"changeListAddElt",value:function(e,t){var a=this.state.listAddValue;a[t]=e.target.value,this.setState({listAddValue:a})}},{key:"AddListElt",value:function(e,t,a){var s=2<arguments.length&&void 0!==a&&a;if(e.preventDefault(),s)(n=this.state.profile)[t]||(n[t]=[]),n[t].push(s),this.setState({profile:n});else if(this.state.listAddValue[t]){var n=this.state.profile,l=this.state.listAddValue;n[t].push(this.state.listAddValue[t]),this.state.listAddValue[t]="",this.setState({profile:n,listAddValue:l})}}},{key:"changeEltConfirm",value:function(e,t){var a=this.state.listEltConfirm;a[t]=e.target.value,this.setState({listEltConfirm:a})}},{key:"changeTextArea",value:function(e,t,a){var s=this.state.profile;s[t]=a?e.target.value.split("\n"):e.target.value,this.setState({profile:s})}},{key:"uploadFile",value:function(e,t,a){var s=this,n=this.state.profile,l=e.target.files[0],r=new FileReader;r.onload=function(e){a?(n[t]||(n[t]=[]),n[t].push(l.name+"/"+btoa(e.target.result))):n[t]=l.name+"/"+btoa(e.target.result),s.setState({profile:n})},r.readAsText(l)}},{key:"uploadImage",value:function(e,t,a){var s=this,n=this.state.profile,l=e.target.files[0],r=new FileReader;r.onload=function(e){a?(n[t]||(n[t]=[]),n[t].push(btoa(e.target.result))):n[t]=btoa(e.target.result),s.setState({profile:n})},r.readAsBinaryString(l)}},{key:"removeImage",value:function(e,t,a){var s=this.state.profile;-1<a?s[t].splice(a,1):delete s[t],this.setState({profile:s})}},{key:"saveProfile",value:function(e){i.default.glewlwydRequest("/profile","PUT",this.state.profile).then((function(e){o.default.sendMessage("Notification",{type:"success",message:r.default.t("profile.save-profile-success")})})).fail((function(e){o.default.sendMessage("Notification",{type:"danger",message:r.default.t("profile.save-profile-error")})}))}},{key:"editElt",value:function(e,t,a){var s,n,i=this,o=[];if((void 0!==t||"password"===e.type||e.forceShow)&&e["profile-read"]){var c="",d="";if(this.state.listError[e.name]&&(c=" is-invalid",d=l.default.createElement("span",{className:"error-input"},r.default.t(this.state.listError[e.name]))),s=l.default.createElement("label",{htmlFor:"modal-edit-"+e.name},r.default.t(e.label)),e.list){if(t=t||[],e.listElements){var u=[];e.listElements.forEach((function(t,a){u.push(l.default.createElement("a",{className:"dropdown-item",key:a,href:"#",onClick:function(a){return i.AddListElt(a,e.name,t)}},t))})),n=l.default.createElement("div",{className:"dropdown"},l.default.createElement("button",{className:"btn btn-secondary btn-sm dropdown-toggle",type:"button",id:"modal-edit-"+e.name,"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},l.default.createElement("i",{className:"fas fa-plus"})),l.default.createElement("div",{className:"dropdown-menu","aria-labelledby":"modal-edit-"+e.name},u))}else if("textarea"===e.type)n=l.default.createElement("textarea",{className:"form-control"+c,onChange:function(t){return i.changeTextArea(t,e.name,!0)},value:t.join("\n"),placeholder:e.placeholder?r.default.t(e.placeholder):""});else if("file"===e.type)n=e["profile-write"]||this.state.add?l.default.createElement("input",{type:"file",className:"form-control"+c,onChange:function(t){return i.uploadFile(t,e.name,!0)}}):l.default.createElement("input",{type:"file",disabled:!0,className:"form-control"});else if(e.type&&e.type.startsWith("image")){var f=[];t.forEach((function(t,a){f.push(l.default.createElement("a",{href:"#",onClick:function(t){return i.removeImage(t,e.name,a)},title:r.default.t("remove")},l.default.createElement("img",{key:a,className:"btn-icon-right img-thumb",src:"data:"+e.type+";base64,"+t,alt:e.name+"-"+a})))})),n=e.edit||this.state.add?l.default.createElement("div",null,l.default.createElement("div",{className:"custom-file"},l.default.createElement("input",{type:"file",className:"custom-file-input"+c,onChange:function(t){return i.uploadImage(t,e.name,!0)},id:"modal-image-"+e.name}),l.default.createElement("label",{className:"custom-file-label",htmlFor:"modal-image-"+e.name},r.default.t("browse"))),f):(f=[],t.forEach((function(t,a){f.push(l.default.createElement("img",{key:a,className:"btn-icon-right img-thumb",src:"data:"+e.type+";base64,"+t,alt:e.name+"-"+a}))})),f)}else e["profile-write"]&&(n=l.default.createElement("div",{className:"input-group"},l.default.createElement("input",{type:"text",className:"form-control"+c,id:"modal-edit-"+e.name,placeholder:e.placeholder?r.default.t(e.placeholder):"",onChange:function(t){return i.changeListAddElt(t,e.name)},value:this.state.listAddValue[e.name]}),l.default.createElement("div",{className:"input-group-append"},l.default.createElement("button",{className:"btn btn-outline-secondary",type:"button",onClick:function(t){return i.AddListElt(t,e.name)},title:r.default.t("modal.list-add-title")},l.default.createElement("i",{className:"fas fa-plus"})))));t.forEach((function(t,a){var s=t;"file"===e.type&&(s=t.substring(0,t.indexOf("/"))),(!e.type||"textarea"===e.type||e.type.startsWith("image"))&&e.type||(!0===e["profile-write"]||i.state.add?o.push(l.default.createElement("a",{href:"#",onClick:function(t){return i.deleteListElt(t,e.name,a)},key:a},l.default.createElement("span",{className:"badge badge-primary btn-icon-right"},s,l.default.createElement("span",{className:"badge badge-light btn-icon-right"},l.default.createElement("i",{className:"fas fa-times"}))))):o.push(l.default.createElement("span",{className:"badge badge-primary btn-icon-right",key:a},s)))}))}else n="boolean"===e.type?!0===e["profile-write"]||this.state.add?l.default.createElement("input",{type:"checkbox",className:"form-control"+c,id:"modal-edit-"+e.name,onChange:function(t){return i.toggleBooleanElt(t,e.name)},checked:t}):l.default.createElement("input",{disabled:!0,type:"checkbox",className:"form-control",id:"modal-edit-"+e.name,checked:t}):"textarea"===e.type?!0===e["profile-write"]||this.state.add?l.default.createElement("textarea",{className:"form-control"+c,onChange:function(t){return i.changeTextArea(t,e.name,!1)},value:t||"",placeholder:e.placeholder?r.default.t(e.placeholder):""}):l.default.createElement("textarea",{className:"form-control",disabled:!0,value:t||""}):"file"===e.type?(t&&o.push(l.default.createElement("a",{href:"#",key:0,onClick:function(t){return i.deleteFile(t,e.name)}},l.default.createElement("span",{className:"badge badge-primary"},t.substring(0,t.indexOf("/")),l.default.createElement("span",{className:"badge badge-light btn-icon-right"},l.default.createElement("i",{className:"fas fa-times"}))))),e["profile-write"]||this.state.add?l.default.createElement("input",{type:"file",className:"form-control"+c,onChange:function(t){return i.uploadFile(t,e.name)}}):l.default.createElement("input",{type:"file",disabled:!0,className:"form-control"})):e.type&&e.type.startsWith("image")?(t&&(f=l.default.createElement("a",{href:"#",onClick:function(t){return i.removeImage(t,e.name,-1)},title:r.default.t("remove")},l.default.createElement("img",{className:"btn-icon-right img-thumb",src:"data:"+e.type+";base64,"+t,alt:e.name}))),e.edit||this.state.add?l.default.createElement("div",null,l.default.createElement("div",{className:"custom-file"},l.default.createElement("input",{type:"file",className:"custom-file-input"+c,onChange:function(t){return i.uploadImage(t,e.name)},id:"modal-image-"+e.name}),l.default.createElement("label",{className:"custom-file-label",htmlFor:"modal-image-"+e.name},r.default.t("browse"))),f):l.default.createElement("img",{className:"btn-icon-right img-thumb",src:"data:"+e.type+";base64,"+t,alt:e.name})):!0===e["profile-write"]||this.state.add?"password"===e.type?l.default.createElement("div",null,l.default.createElement("input",{type:"password",className:"form-control"+c,id:"modal-edit-"+e.name,placeholder:e.placeholder?r.default.t(e.placeholder):"",onChange:function(t){return i.changeElt(t,e.name)},value:t||"",autoComplete:"new-password"}),l.default.createElement("input",{type:"password",className:"form-control"+c,id:"modal-edit-confirm"+e.name,placeholder:r.default.t(e.placeholderConfirm),value:this.state.listEltConfirm[e.name]||"",onChange:function(t){return i.changeEltConfirm(t,e.name)},autoComplete:"new-password"})):l.default.createElement("input",{type:e.type||"text",className:"form-control"+c,id:"modal-edit-"+e.name,placeholder:e.placeholder?r.default.t(e.placeholder):"",value:t,onChange:function(t){return i.changeElt(t,e.name)}}):l.default.createElement("input",{disabled:!0,type:e.type||"text",className:"form-control"+c,id:"modal-edit-"+e.name,placeholder:e.placeholder?r.default.t(e.placeholder):"",value:t})}return l.default.createElement("div",{className:"form-group",key:a},s,n,l.default.createElement("div",null,o),d)}},{key:"render",value:function(){var e=this,t=[];return this.state.pattern&&this.state.profile&&this.state.pattern.forEach((function(a,s){var n=e.editElt(a,e.state.profile[a.name],s);n&&t.push(n)})),l.default.createElement("div",null,l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("h4",null,r.default.t("profile.hello",{name:this.state.profile.name||this.state.profile.username})))),l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("form",{className:"needs-validation",noValidate:!0},t))),l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12 text-right"},l.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(t){return e.saveProfile(t)},disabled:!this.state.profile},r.default.t("profile.save")))))}}]),u);function u(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,e));return t.state={pattern:e.pattern,profile:e.profile,listAddValue:t.initListAdd(e.pattern),listEltConfirm:t.initListConfirm(e.pattern),listError:{}},t.editElt=t.editElt.bind(t),t.createData=t.createData.bind(t),t.initListAdd=t.initListAdd.bind(t),t.initListConfirm=t.initListConfirm.bind(t),t.deleteListElt=t.deleteListElt.bind(t),t.changeElt=t.changeElt.bind(t),t.toggleBooleanElt=t.toggleBooleanElt.bind(t),t.changeListAddElt=t.changeListAddElt.bind(t),t.AddListElt=t.AddListElt.bind(t),t.changeEltConfirm=t.changeEltConfirm.bind(t),t.changeTextArea=t.changeTextArea.bind(t),t.uploadFile=t.uploadFile.bind(t),t.uploadImage=t.uploadImage.bind(t),t.removeImage=t.removeImage.bind(t),t.editElt=t.editElt.bind(t),t.saveProfile=t.saveProfile.bind(t),t}t.default=d},75:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var n=a(0),l=i(n),r=i(a(1));function i(e){return e&&e.__esModule?e:{default:e}}i(a(3));var o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,n.Component),function(e,t,a){t&&s(e.prototype,t),a&&s(e,a)}(c,[{key:"componentWillReceiveProps",value:function(e){this.setState({profile:e.profile})}},{key:"render",value:function(){return l.default.createElement("div",null,l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("h4",null,r.default.t("profile.hello-delegate",{name:this.state.profile.name||this.state.profile.username})))))}}]),c);function c(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,e));return t.state={profile:e.profile},t}t.default=o},76:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var n=a(0),l=c(n),r=c(a(1)),i=c(a(3)),o=c(a(2));function c(e){return e&&e.__esModule?e:{default:e}}var d=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(u,n.Component),function(e,t,a){t&&s(e.prototype,t),a&&s(e,a)}(u,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,registerConfig:e.registerConfig,registerProfile:e.registerProfile})}},{key:"checkUsername",value:function(){var e=this;this.state.timeout&&clearTimeout(this.state.timeout),this.state.username&&i.default.glewlwydRequest("/"+this.state.config.params.register+"/username","POST",{username:this.state.username}).then((function(){e.setState({timeout:!1,usernameValid:!0,checkingUsername:!1,invalidMessage:!1})})).fail((function(t){e.setState({timeout:!1,usernameValid:!1,checkingUsername:!1,invalidMessage:!0},(function(){400!==t.status&&(o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")}),e.setState({invalidMessage:!0}))}))}))}},{key:"changeUsername",value:function(e){var t=this;e.preventDefault(),this.setState({username:e.target.value},(function(){t.state.timeout&&clearTimeout(t.state.timeout),t.setState({checkingUsername:!0,timeout:setTimeout((function(){t.checkUsername()}),1e3)})}))}},{key:"changeName",value:function(e){e.preventDefault();var t=this.state.registerProfile;t.name=e.target.value,this.setState({registerProfile:t})}},{key:"changeEmail",value:function(e){e.preventDefault();var t=this.state.registerProfile;t.email=e.target.value,this.setState({registerProfile:t})}},{key:"changePassword",value:function(e){var t=this;this.setState({password:e.target.value},(function(){t.checkPassword()}))}},{key:"changeConfirmPassword",value:function(e){var t=this;this.setState({passwordConfirm:e.target.value},(function(){t.checkPassword()}))}},{key:"checkPassword",value:function(){var e=!1;""===this.state.password&&""===this.state.passwordConfirm||(this.state.password!==this.state.passwordConfirm?e=r.default.t("profile.register-password-error-not-match"):this.state.password.length<(this.state.config.PasswordMinLength||8)&&(e=r.default.t("profile.register-password-ph",{car:this.state.config.PasswordMinLength||8}))),this.setState({invalidPassword:e})}},{key:"registerUsername",value:function(){i.default.glewlwydRequest("/"+this.state.config.params.register+"/register","POST",{username:this.state.username}).then((function(){o.default.sendMessage("App",{type:"registration"})})).fail((function(){400!==err.status&&o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})}))}},{key:"SaveProfile",value:function(e){var t=this;e.preventDefault(),i.default.glewlwydRequest("/"+this.state.config.params.register+"/profile","PUT",this.state.registerProfile).then((function(){!t.state.invalidPassword&&t.state.password.length>=(t.state.config.PasswordMinLength||8)?i.default.glewlwydRequest("/"+t.state.config.params.register+"/profile/password","POST",{password:t.state.password}).then((function(){o.default.sendMessage("App",{type:"registration"}),o.default.sendMessage("Notification",{type:"info",message:r.default.t("profile.register-profile-saved")})})).fail((function(){400!==err.status&&o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})})):o.default.sendMessage("App",{type:"registration"})})).fail((function(){400!==err.status&&o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})}))}},{key:"completeRegistration",value:function(){var e=this;i.default.glewlwydRequest("/"+this.state.config.params.register+"/profile/complete","POST").then((function(){e.setState({registerComplete:!0,username:""},(function(){o.default.sendMessage("Notification",{type:"info",message:r.default.t("profile.register-profile-completed")})}))})).fail((function(e){400!==e.status?o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")}):o.default.sendMessage("Notification",{type:"warning",message:r.default.t("profile.register-profile-incomplete")})}))}},{key:"cancelRegistration",value:function(){var e=this;i.default.glewlwydRequest("/"+this.state.config.params.register+"/profile","DELETE").then((function(){e.setState({username:"",usernameValid:!1},(function(){o.default.sendMessage("Notification",{type:"info",message:r.default.t("profile.register-profile-cancelled")}),o.default.sendMessage("App",{type:"registration"})}))})).fail((function(){o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})}))}},{key:"render",value:function(){var e,t,a,s,n=this;if(this.state.registerComplete)t=l.default.createElement("div",null,l.default.createElement("div",{className:"alert alert-info",role:"alert"},r.default.t("profile.register-profile-complete-message")),l.default.createElement("div",null,l.default.createElement("a",{className:"btn btn-primary",href:this.state.config.ProfileUrl},r.default.t("profile.register-profile-complete-link"))));else if(this.state.registerProfile){var i,o=[];"always"!==this.state.registerConfig["set-password"]||this.state.registerProfile.password_set||o.push(l.default.createElement("li",{key:0},r.default.t("profile.register-profile-complete-step-password"))),this.state.registerConfig.schemes&&this.state.registerConfig.schemes.forEach((function(e,t){"always"!=e.register||n.state.registerSchemes[e.name]||o.push(l.default.createElement("li",{key:t+1},r.default.t("profile.register-profile-complete-step-scheme",{scheme:e.display_name})))})),i=o.length?r.default.t("profile.register-profile-complete-steps"):r.default.t("profile.register-profile-complete-possible"),"no"!==this.state.registerConfig["set-password"]&&(s=l.default.createElement("div",null,l.default.createElement("hr",null),l.default.createElement("label",{htmlFor:"password-input"},r.default.t("profile.register-password-label")),l.default.createElement("div",{className:"input-group"},l.default.createElement("input",{type:"password",className:"form-control",id:"password-input",placeholder:r.default.t("profile.register-password-ph",{car:this.state.config.PasswordMinLength||8}),onChange:function(e){return n.changePassword(e)},value:this.state.password})),l.default.createElement("label",{htmlFor:"confirm-password-input"},r.default.t("profile.register-confirm-password-label")),l.default.createElement("div",{className:"input-group"},l.default.createElement("input",{type:"password",className:"form-control",id:"confirm-password-input",placeholder:r.default.t("profile.register-confirm-password-ph"),onChange:function(e){return n.changeConfirmPassword(e)},value:this.state.passwordConfirm})),this.state.invalidPassword?l.default.createElement("span",{className:"error-input"},this.state.invalidPassword):"")),e=l.default.createElement("form",{className:"needs-validation",noValidate:!0,onSubmit:function(e){return n.SaveProfile(e)}},l.default.createElement("label",{htmlFor:"username-input"},r.default.t("profile.register-profile-username-label")),l.default.createElement("div",{className:"input-group"},l.default.createElement("input",{type:"text",className:"form-control",value:this.state.registerProfile.username,disabled:!0})),l.default.createElement("hr",null),l.default.createElement("label",{htmlFor:"name-input"},r.default.t("profile.register-name-label")),l.default.createElement("div",{className:"input-group"},l.default.createElement("input",{type:"text",className:"form-control",id:"name-input",placeholder:r.default.t("profile.register-name-ph"),onChange:function(e){return n.changeName(e)},value:this.state.registerProfile.name||""})),l.default.createElement("hr",null),l.default.createElement("label",{htmlFor:"email-input"},r.default.t("profile.register-email-label")),l.default.createElement("div",{className:"input-group"},l.default.createElement("input",{type:"text",className:"form-control",id:"email-input",placeholder:r.default.t("profile.register-email-ph"),onChange:function(e){return n.changeEmail(e)},value:this.state.registerProfile.email||""})),s,l.default.createElement("hr",null),l.default.createElement("div",{className:"alert alert-info",role:"alert"},i,l.default.createElement("ul",null,o))),a=l.default.createElement("div",null,l.default.createElement("button",{className:"btn btn-secondary btn-icon",type:"submit",onClick:function(e){return n.SaveProfile(e)},disabled:this.state.invalidPassword,title:r.default.t("save")},r.default.t("save")),l.default.createElement("button",{className:"btn btn-primary btn-icon",type:"button",onClick:function(){return n.completeRegistration()},title:r.default.t("profile.register-profile-complete")},r.default.t("profile.register-profile-complete")),l.default.createElement("button",{className:"btn btn-primary",type:"button",onClick:function(){return n.cancelRegistration()},title:r.default.t("profile.register-profile-cancel")},r.default.t("profile.register-profile-cancel")))}else this.state.registerProfile||(e=l.default.createElement("form",{className:"needs-validation",noValidate:!0},l.default.createElement("label",{htmlFor:"username-input"},r.default.t("profile.register-username-label")),l.default.createElement("div",{className:"input-group"},l.default.createElement("input",{type:"text",className:"form-control",id:"username-input",placeholder:r.default.t("profile.register-username-ph"),onChange:function(e){return n.changeUsername(e)},value:this.state.username}),l.default.createElement("div",{className:"input-group-append"},l.default.createElement("button",{className:"btn"+(this.state.usernameValid&&!this.state.checkingUsername?" btn-outline-success":" btn-outline-danger"),type:"button",onClick:function(){return n.registerUsername()},disabled:!this.state.usernameValid,title:r.default.t("profile.register-username-create")},l.default.createElement("i",{className:this.state.checkingUsername?"fas fa-compass fa-spin":"fas fa-plus"}))),this.state.invalidMessage?l.default.createElement("span",{className:"error-input"},r.default.t("profile.register-username-error")):"")));return l.default.createElement("div",null,l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("h4",null,r.default.t("profile.register-title")))),t,l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-6"},e)),l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},a)))}}]),u);function u(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,e));return t.state={config:e.config,registerConfig:e.registerConfig,registerProfile:e.registerProfile,registerSchemes:e.registerSchemes,username:"",usernameValid:!1,timeout:!1,checkingUsername:!1,invalidMessage:!1,password:"",passwordConfirm:"",invalidPassword:!1,registerComplete:!1},t}t.default=d},77:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var n=a(0),l=c(n),r=c(a(1)),i=c(a(3)),o=c(a(2));function c(e){return e&&e.__esModule?e:{default:e}}c(a(6));var d=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(u,n.Component),function(e,t,a){t&&s(e.prototype,t),a&&s(e,a)}(u,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({config:e.config,profile:e.profile,loggedIn:e.loggedIn},(function(){t.state.profile&&t.fetchLists()}))}},{key:"fetchLists",value:function(){var e=this;this.state.loggedIn&&(i.default.glewlwydRequest("/profile/session").then((function(t){e.setState({sessionList:t})})).fail((function(){o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})})),i.default.glewlwydRequest("/profile/plugin").then((function(t){t.forEach((function(t){"oauth2-glewlwyd"===t.module?i.default.glewlwydRequestSub("/"+t.name+"/profile/token"+(e.state.config.params.delegate?"?impersonate="+e.state.config.params.delegate:"")).then((function(a){var s=e.state.plugins;s.oauth2[t.name]=a,e.setState({plugins:s})})).fail((function(e){})):"oidc"===t.module&&i.default.glewlwydRequestSub("/"+t.name+"/token"+(e.state.config.params.delegate?"?impersonate="+e.state.config.params.delegate:"")).then((function(a){var s=e.state.plugins;s.oidc[t.name]=a,e.setState({plugins:s})})).fail((function(e){}))}))})).fail((function(){o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})})))}},{key:"getTable",value:function(e,t){return l.default.createElement("table",{className:"table table-responsive table-striped"},l.default.createElement("thead",null,e),l.default.createElement("tbody",null,t))}},{key:"disableSession",value:function(e){var t=this;this.setState({disableObject:e},(function(){o.default.sendMessage("App",{type:"confirm",title:r.default.t("profile.session-disable-title"),message:r.default.t("profile.session-disable-message"),callback:t.disableSessionConfirm})}))}},{key:"disableSessionConfirm",value:function(){var e=this;this.state.disableObject&&i.default.glewlwydRequest("/profile/session/"+this.state.disableObject.session_hash,"DELETE").then((function(e){o.default.sendMessage("Notification",{type:"info",message:r.default.t("profile.session-disabled")})})).fail((function(){o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})})).always((function(){e.fetchLists(),e.setState({disableObject:!1}),o.default.sendMessage("App",{type:"closeConfirm"})}))}},{key:"disableToken",value:function(e,t,a){var s=this;this.setState({disableObject:{type:e,key:t,token:a}},(function(){o.default.sendMessage("App",{type:"confirm",title:r.default.t("profile.session-disable-token-title"),message:r.default.t("profile.session-disable-token-message"),callback:s.disableTokenConfirm})}))}},{key:"disableTokenConfirm",value:function(){var e=this;this.state.disableObject&&("oauth2"===this.state.disableObject.type?i.default.glewlwydRequestSub("/"+this.state.disableObject.key+"/profile/token/"+this.state.disableObject.token.token_hash+(this.state.config.params.delegate?"?impersonate="+this.state.config.params.delegate:""),"DELETE").then((function(e){o.default.sendMessage("Notification",{type:"info",message:r.default.t("profile.token-disabled")})})).fail((function(){o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})})).always((function(){e.fetchLists(),e.setState({disableObject:!1}),o.default.sendMessage("App",{type:"closeConfirm"})})):"oidc"===this.state.disableObject.type&&i.default.glewlwydRequestSub("/"+this.state.disableObject.key+"/token/"+this.state.disableObject.token.token_hash+(this.state.config.params.delegate?"?impersonate="+this.state.config.params.delegate:""),"DELETE").then((function(e){o.default.sendMessage("Notification",{type:"info",message:r.default.t("profile.token-disabled")})})).fail((function(){o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})})).always((function(){e.fetchLists(),e.setState({disableObject:!1}),o.default.sendMessage("App",{type:"closeConfirm"})})))}},{key:"render",value:function(){var e=this,t=l.default.createElement("tr",null,l.default.createElement("th",null,r.default.t("profile.session-table-last-login")),l.default.createElement("th",null,r.default.t("profile.session-table-exiration")),l.default.createElement("th",null,r.default.t("profile.session-table-issued-for")),l.default.createElement("th",null,r.default.t("profile.session-table-user-agent")),l.default.createElement("th",null,r.default.t("admin.enabled")),l.default.createElement("th",null)),a=[],s=[];this.state.sessionList.forEach((function(t,s){var n=new Date(1e3*t.last_login),i=new Date(1e3*t.expiration);a.push(l.default.createElement("tr",{key:s},l.default.createElement("td",null,n.toLocaleString()),l.default.createElement("td",null,i.toLocaleString()),l.default.createElement("td",null,t.issued_for),l.default.createElement("td",null,t.user_agent),l.default.createElement("td",null,t.enabled?r.default.t("profile.session-enabled-true"):r.default.t("profile.session-enabled-false")),l.default.createElement("td",null,l.default.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(a){return e.disableSession(t)},title:r.default.t("admin.delete"),disabled:!t.enabled},l.default.createElement("i",{className:"fas fa-trash"})))))}));var n=0;for(var i in s=[],this.state.plugins.oauth2){var o=this.state.plugins.oauth2[i],c=l.default.createElement("tr",null,l.default.createElement("th",null,r.default.t("profile.session-table-last-login")),l.default.createElement("th",null,r.default.t("profile.session-table-exiration")),l.default.createElement("th",null,r.default.t("profile.session-table-client")),l.default.createElement("th",null,r.default.t("profile.session-table-issued-for")),l.default.createElement("th",null,r.default.t("profile.session-table-user-agent")),l.default.createElement("th",null,r.default.t("admin.enabled")),l.default.createElement("th",null)),d=[];o.forEach((function(t,a){var s=new Date(1e3*t.last_seen),n=new Date(1e3*t.expires_at);d.push(l.default.createElement("tr",{key:a},l.default.createElement("td",null,s.toLocaleString()),l.default.createElement("td",null,n.toLocaleString()),l.default.createElement("td",null,t.client_id),l.default.createElement("td",null,t.issued_for),l.default.createElement("td",null,t.user_agent),l.default.createElement("td",null,t.enabled?r.default.t("profile.session-enabled-true"):r.default.t("profile.session-enabled-false")),l.default.createElement("td",null,l.default.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(a){return e.disableToken("oauth2",i,t)},title:r.default.t("admin.delete"),disabled:!t.enabled},l.default.createElement("i",{className:"fas fa-trash"})))))})),s.push(l.default.createElement("div",{className:"card",key:++n},l.default.createElement("div",{className:"card-header",id:"dataFormatCard"},l.default.createElement("h2",{className:"mb-0"},l.default.createElement("button",{className:"btn btn-link",type:"button","data-toggle":"collapse","data-target":"#collapseOauth2-"+i,"aria-expanded":"true","aria-controls":"collapseOauth2-"+i},r.default.t("profile.session-token-oauth2-table",{name:i})))),l.default.createElement("div",{id:"collapseOauth2-"+i,className:"collapse","aria-labelledby":"dataFormatCard","data-parent":"#accordionParams"},l.default.createElement("div",{className:"card-body"},this.getTable(c,d)))))}for(var i in n=s.length,this.state.plugins.oidc){var u=this.state.plugins.oidc[i],f=l.default.createElement("tr",null,l.default.createElement("th",null,r.default.t("profile.session-table-last-login")),l.default.createElement("th",null,r.default.t("profile.session-table-exiration")),l.default.createElement("th",null,r.default.t("profile.session-table-client")),l.default.createElement("th",null,r.default.t("profile.session-table-issued-for")),l.default.createElement("th",null,r.default.t("profile.session-table-user-agent")),l.default.createElement("th",null,r.default.t("admin.enabled")),l.default.createElement("th",null));d=[],u.forEach((function(t,a){var s=new Date(1e3*t.last_seen),n=new Date(1e3*t.expires_at);d.push(l.default.createElement("tr",{key:a},l.default.createElement("td",null,s.toLocaleString()),l.default.createElement("td",null,n.toLocaleString()),l.default.createElement("td",null,t.client_id),l.default.createElement("td",null,t.issued_for),l.default.createElement("td",null,t.user_agent),l.default.createElement("td",null,t.enabled?r.default.t("profile.session-enabled-true"):r.default.t("profile.session-enabled-false")),l.default.createElement("td",null,l.default.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(a){return e.disableToken("oidc",i,t)},title:r.default.t("admin.delete"),disabled:!t.enabled},l.default.createElement("i",{className:"fas fa-trash"})))))})),s.push(l.default.createElement("div",{className:"card",key:++n},l.default.createElement("div",{className:"card-header",id:"dataFormatCard"},l.default.createElement("h2",{className:"mb-0"},l.default.createElement("button",{className:"btn btn-link",type:"button","data-toggle":"collapse","data-target":"#collapseOauth2-"+i,"aria-expanded":"true","aria-controls":"collapseOauth2-"+i},r.default.t("profile.session-token-oidc-table",{name:i})))),l.default.createElement("div",{id:"collapseOauth2-"+i,className:"collapse","aria-labelledby":"dataFormatCard","data-parent":"#accordionParams"},l.default.createElement("div",{className:"card-body"},this.getTable(f,d)))))}return l.default.createElement("div",null,l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("h4",null,r.default.t("profile.session-title")))),l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("div",{className:"accordion",id:"accordionParams"},l.default.createElement("div",{className:"card"},l.default.createElement("div",{className:"card-header",id:"dataFormatCard"},l.default.createElement("h2",{className:"mb-0"},l.default.createElement("button",{className:"btn btn-link",type:"button","data-toggle":"collapse","data-target":"#collapseSession","aria-expanded":"true","aria-controls":"collapseSession"},r.default.t("profile.session-table")))),l.default.createElement("div",{id:"collapseSession",className:"collapse","aria-labelledby":"dataFormatCard","data-parent":"#accordionParams"},l.default.createElement("div",{className:"card-body"},this.getTable(t,a)))),s))))}}]),u);function u(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,e));return t.state={config:e.config,profile:e.profile,loggedIn:e.loggedIn,sessionList:[],plugins:{oauth2:{},oidc:{}},disableObject:!1},t.fetchLists=t.fetchLists.bind(t),t.getTable=t.getTable.bind(t),t.disableSession=t.disableSession.bind(t),t.disableSessionConfirm=t.disableSessionConfirm.bind(t),t.disableToken=t.disableToken.bind(t),t.disableTokenConfirm=t.disableTokenConfirm.bind(t),t.state.profile&&t.fetchLists(),t}t.default=d},78:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var n=a(0),l=c(n),r=c(a(1)),i=c(a(3)),o=c(a(2));function c(e){return e&&e.__esModule?e:{default:e}}c(a(6));var d=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(u,n.Component),function(e,t,a){t&&s(e.prototype,t),a&&s(e,a)}(u,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,passwordMinLength:e.config.PasswordMinLength||8,callback:e.callback,old_password:"",password:"",password_confirm:"",oldPasswordInvalid:!1,passwordInvalid:!1,passwordConfirmInvalid:!1})}},{key:"closeModal",value:function(e,t){var a=this;t?this.checkPassword()&&i.default.glewlwydRequest("/profile/password","PUT",{old_password:this.state.old_password,password:this.state.password}).then((function(){a.setState({oldPasswordInvalid:!1},(function(){a.state.callback(t)}))})).fail((function(e){400==e.status?a.setState({oldPasswordInvalid:!0,oldPasswordInvalidMessage:r.default.t("profile.password-invalid")}):o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})})):this.state.callback(t)}},{key:"changeOldPassword",value:function(e){this.setState({old_password:e.target.value})}},{key:"changeNewPassword",value:function(e){this.setState({password:e.target.value})}},{key:"changeNewPasswordConfirm",value:function(e){this.setState({password_confirm:e.target.value})}},{key:"checkPassword",value:function(){var e=!1,t=!1,a="",s="";return this.state.password.length<this.state.passwordMinLength&&(e=!0,a=r.default.t("profile.password-min-characters",{minLength:this.state.passwordMinLength})),this.state.password!==this.state.password_confirm&&(t=!0,s=r.default.t("profile.password-not-match")),this.setState({passwordInvalid:e,passwordConfirmInvalid:t,passwordInvalidMessage:a,passwordConfirmInvalidMessage:s}),!e&&!t}},{key:"render",value:function(){var e=this;return l.default.createElement("div",{className:"modal fade",id:"passwordModal",tabIndex:"-1",role:"dialog","aria-labelledby":"confirmModalLabel","aria-hidden":"true"},l.default.createElement("div",{className:"modal-dialog modal-lg",role:"document"},l.default.createElement("div",{className:"modal-content"},l.default.createElement("div",{className:"modal-header"},l.default.createElement("h5",{className:"modal-title",id:"confirmModalLabel"},r.default.t("profile.password-modal-title")),l.default.createElement("button",{type:"button",className:"close","aria-label":r.default.t("modal.close"),onClick:function(t){return e.closeModal(t,!1)}},l.default.createElement("span",{"aria-hidden":"true"},"×"))),l.default.createElement("div",{className:"modal-body"},l.default.createElement("form",{className:"needs-validation",noValidate:!0},l.default.createElement("div",{className:"form-group"},l.default.createElement("div",{className:"input-group mb-3"},l.default.createElement("div",{className:"input-group-prepend"},l.default.createElement("label",{className:"input-group-text",htmlFor:"mod-old-password"},r.default.t("profile.password-modal-old-password"))),l.default.createElement("input",{type:"password",autoComplete:"current-password",className:"form-control"+(this.state.oldPasswordInvalid?" is-invalid":""),id:"oldPassword",placeholder:r.default.t("profile.password-modal-old-password-ph"),value:this.state.old_password,onChange:function(t){return e.changeOldPassword(t)}})),l.default.createElement("span",{className:"error-input"+(this.state.oldPasswordInvalid?"":" hidden")},this.state.oldPasswordInvalidMessage)),l.default.createElement("div",{className:"form-group"},l.default.createElement("div",{className:"input-group mb-3"},l.default.createElement("div",{className:"input-group-prepend"},l.default.createElement("label",{className:"input-group-text",htmlFor:"mod-new-password"},r.default.t("profile.password-modal-new-password"))),l.default.createElement("input",{type:"password",autoComplete:"new-password",className:"form-control"+(this.state.passwordInvalid?" is-invalid":""),id:"newPassword",placeholder:r.default.t("profile.password-modal-new-password-ph",{minLength:this.state.passwordMinLength}),value:this.state.password,onChange:function(t){return e.changeNewPassword(t)}})),l.default.createElement("span",{className:"error-input"+(this.state.passwordInvalid?"":" hidden")},this.state.passwordInvalidMessage)),l.default.createElement("div",{className:"form-group"},l.default.createElement("div",{className:"input-group mb-3"},l.default.createElement("div",{className:"input-group-prepend"},l.default.createElement("label",{className:"input-group-text",htmlFor:"mod-new-password-confirm"},r.default.t("profile.password-modal-new-password-confirm"))),l.default.createElement("input",{type:"password",autoComplete:"new-password",className:"form-control"+(this.state.passwordConfirmInvalid?" is-invalid":""),id:"retypeNewPassword",placeholder:r.default.t("profile.password-modal-new-password-confirm-ph",{minLength:this.state.passwordMinLength}),value:this.state.password_confirm,onChange:function(t){return e.changeNewPasswordConfirm(t)}})),l.default.createElement("span",{className:"error-input"+(this.state.passwordConfirmInvalid?"":" hidden")},this.state.passwordConfirmInvalidMessage)))),l.default.createElement("div",{className:"modal-footer"},l.default.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(t){return e.closeModal(t,!1)}},r.default.t("modal.close")),l.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(t){return e.closeModal(t,!0)}},r.default.t("modal.ok"))))))}}]),u);function u(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,e));return t.state={config:e.config,passwordMinLength:e.config.PasswordMinLength||8,callback:e.callback,old_password:"",password:"",password_confirm:"",oldPasswordInvalid:!1,passwordInvalid:!1,passwordConfirmInvalid:!1},t.closeModal=t.closeModal.bind(t),t.changeOldPassword=t.changeOldPassword.bind(t),t.changeNewPassword=t.changeNewPassword.bind(t),t.changeNewPasswordConfirm=t.changeNewPasswordConfirm.bind(t),t.checkPassword=t.checkPassword.bind(t),t}t.default=d},79:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var n=a(0),l=u(n),r=u(a(1)),i=u(a(80)),o=u(a(81)),c=u(a(82)),d=u(a(84));function u(e){return e&&e.__esModule?e:{default:e}}var f=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(m,n.Component),function(e,t,a){t&&s(e.prototype,t),a&&s(e,a)}(m,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,module:e.module,name:e.name,profile:e.profile})}},{key:"render",value:function(){return"mock"===this.state.module?l.default.createElement(i.default,{config:this.state.config,module:this.state.module,name:this.state.name,profile:this.state.profile}):"webauthn"===this.state.module?l.default.createElement(o.default,{config:this.state.config,module:this.state.module,name:this.state.name,profile:this.state.profile}):"otp"===this.state.module?l.default.createElement(c.default,{config:this.state.config,module:this.state.module,name:this.state.name,profile:this.state.profile}):"certificate"===this.state.module?l.default.createElement(d.default,{config:this.state.config,module:this.state.module,name:this.state.name,profile:this.state.profile}):l.default.createElement("div",null,l.default.createElement("h4",null,r.default.t("profile.scheme-not-found",{module:this.state.module})))}}]),m);function m(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(m.__proto__||Object.getPrototypeOf(m)).call(this,e));return t.state={config:e.config,module:e.module,name:e.name,profile:e.profile},t}t.default=f},80:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var n=a(0),l=c(n),r=c(a(1)),i=c(a(3)),o=c(a(2));function c(e){return e&&e.__esModule?e:{default:e}}c(a(6));var d=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(u,n.Component),function(e,t,a){t&&s(e.prototype,t),a&&s(e,a)}(u,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({config:e.config,module:e.module,name:e.name,profile:e.profile,registered:!1,registration:!1,registerUrl:e.config.params.register?"/"+e.config.params.register+"/profile":"/profile"},(function(){t.getRegister()}))}},{key:"getRegister",value:function(){var e=this;this.state.profile&&i.default.glewlwydRequest(this.state.registerUrl+"/scheme/register/","PUT",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name},!0).then((function(t){e.setState({registration:r.default.t("profile.scheme-mock-register-status-registered"),registered:!0})})).fail((function(t){400===t.status?e.setState({registration:r.default.t("profile.scheme-mock-register-status-not-registered"),registered:!1}):o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})}))}},{key:"register",value:function(){var e=this;i.default.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{register:!this.state.registered}}).fail((function(e){o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})})).always((function(){e.getRegister()}))}},{key:"render",value:function(){var e,t=this;return this.state.registration&&(e=l.default.createElement("div",null,l.default.createElement("h4",null,r.default.t("profile.scheme-mock-register-status")),l.default.createElement("span",{className:"badge badge-primary"},this.state.registration))),l.default.createElement("div",null,l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("h4",null,r.default.t("profile.scheme-mock-title",{module:this.state.module,name:this.state.name})))),l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},e)),l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("hr",null))),l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("div",{className:"btn-group",role:"group"},l.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return t.register(e)}},this.state.registered?r.default.t("profile.scheme-mock-deregister"):r.default.t("profile.scheme-mock-register"))))))}}]),u);function u(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,e));return t.state={config:e.config,module:e.module,name:e.name,profile:e.profile,registered:!1,registration:!1,registerUrl:e.config.params.register?"/"+e.config.params.register+"/profile":"/profile"},t.getRegister=t.getRegister.bind(t),t.register=t.register.bind(t),t.getRegister(),t}t.default=d},81:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var n=a(0),l=c(n),r=c(a(1)),i=c(a(3)),o=c(a(2));function c(e){return e&&e.__esModule?e:{default:e}}c(a(6));var d=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(u,n.Component),function(e,t,a){t&&s(e.prototype,t),a&&s(e,a)}(u,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({config:e.config,module:e.module,name:e.name,profile:e.profile,registered:!1,registration:!1,registerUrl:e.config.params.register?"/"+e.config.params.register+"/profile":"/profile"},(function(){t.getCredentials()}))}},{key:"strToBin",value:function(e){return Uint8Array.from(atob(e),(function(e){return e.charCodeAt(0)}))}},{key:"binToStr",value:function(e){return btoa(new Uint8Array(e).reduce((function(e,t){return e+String.fromCharCode(t)}),""))}},{key:"getCredentials",value:function(){var e=this;this.state.profile&&i.default.glewlwydRequest(this.state.registerUrl+"/scheme/register/","PUT",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name},!0).then((function(t){var a=!1;t.forEach((function(e){"registered"==e.status&&(a=!0)})),e.setState({credentialList:t,credentialAvailable:a,credAssertion:!1})})).fail((function(t){401===t.status?e.setState({registration:r.default.t("profile.scheme-webauthn-register-status-not-registered"),registered:!1,credentialList:[],credAssertion:!1}):o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})}))}},{key:"createCredential",value:function(){var e=this;i.default.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{register:"new-credential"}}).then((function(t){var a=[];e.state.credentialList.forEach((function(t){a.push({id:e.strToBin(t.credential_id),type:"public-key"})}));var s={authenticatorSelection:{requireResidentKey:!1},rp:{name:t.rpId.split("://")[1]},user:{id:Uint8Array.from(atob(t.user.id),(function(e){return e.charCodeAt(0)})),name:t.user.name,displayName:e.state.profile.name||t.user.name},pubKeyCredParams:t["pubKey-cred-params"],challenge:e.strToBin(t.challenge),excludeCredentials:a};t["attestation-required"]&&(s.attestation=t["attestation-required"]),t.timeout&&(s.timeout=t.timeout),navigator.credentials.create({publicKey:s}).then((function(a){var s={};"id"in a&&(s.id=a.id),"type"in a&&(s.type=a.type),"rawId"in a&&(s.rawId=e.binToStr(a.rawId));var n={};n.clientDataJSON=e.binToStr(a.response.clientDataJSON),n.attestationObject=e.binToStr(a.response.attestationObject),a.response.getTransports&&(n.transports=a.response.getTransports()),s.response=n,i.default.glewlwydRequest(e.state.registerUrl+"/scheme/register/","POST",{username:e.state.profile.username,scheme_type:e.state.module,scheme_name:e.state.name,value:{register:"register-credential",session:t.session,credential:s}}).then((function(){o.default.sendMessage("Notification",{type:"info",message:r.default.t("profile.scheme-webauthn-register-credential-success")}),e.getCredentials(),e.state.config.params.register&&o.default.sendMessage("App",{type:"registration"})})).fail((function(e,t){400===e.status?(o.default.sendMessage("Notification",{type:"danger",message:r.default.t("profile.scheme-webauthn-register-credential-error")}),o.default.sendMessage("App",{type:"message",title:r.default.t("profile.scheme-webauthn-register-credential-error"),message:e.responseJSON})):o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})}))})).catch((function(e){o.default.sendMessage("Notification",{type:"danger",message:r.default.t("profile.scheme-webauthn-error-registration")}),o.default.sendMessage("App",{type:"message",title:r.default.t("profile.scheme-webauthn-register-credential-error"),message:[e.toString()]})}))})).fail((function(e){o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})}))}},{key:"testAssertion",value:function(e){var t=this;i.default.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{register:"trigger-assertion"}}).then((function(e){var a=[];e.allowCredentials.forEach((function(e){a.push({id:t.strToBin(e.credential_id),type:"public-key"})}));var s={allowCredentials:a,challenge:t.strToBin(e.challenge)};navigator.credentials.get({publicKey:s}).then((function(a){var s={};"id"in a&&(s.id=a.id),"type"in a&&(s.type=a.type),"rawId"in a&&(s.rawId=t.binToStr(a.rawId)),t.setState({credAssertion:s.rawId}),s.response={clientDataJSON:t.binToStr(a.response.clientDataJSON),authenticatorData:t.binToStr(a.response.authenticatorData),signature:t.binToStr(a.response.signature),userHandle:t.binToStr(a.response.userHandle)},a.response.getTransports&&(response.transports=a.response.getTransports()),i.default.glewlwydRequest(t.state.registerUrl+"/scheme/register/","POST",{username:t.state.profile.username,scheme_type:t.state.module,scheme_name:t.state.name,value:{register:"validate-assertion",session:e.session,credential:s}},!0).then((function(){t.state.config.params.register&&o.default.sendMessage("App",{type:"registration"}),o.default.sendMessage("Notification",{type:"info",message:r.default.t("profile.scheme-webauthn-assertion-success")})})).fail((function(e){401===e.status?o.default.sendMessage("Notification",{type:"danger",message:r.default.t("profile.scheme-webauthn-assertion-error")}):o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})}))})).catch((function(e){o.default.sendMessage("Notification",{type:"danger",message:r.default.t("profile.scheme-webauthn-error-assertion")}),o.default.sendMessage("App",{type:"message",title:r.default.t("profile.scheme-webauthn-register-credential-error"),message:[e.toString()]})}))})).fail((function(e){o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})}))}},{key:"editNameCred",value:function(e){this.setState({editIndex:e,editValue:this.state.credentialList[e].name,credAssertion:!1})}},{key:"changeName",value:function(e){this.setState({editValue:e.target.value,credAssertion:!1})}},{key:"saveName",value:function(e,t){var a=this;e.preventDefault(),i.default.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{register:"edit-credential",credential_id:this.state.credentialList[t].credential_id,name:this.state.editValue}}).then((function(e){a.setState({editIndex:-1,editValue:""},(function(){a.getCredentials()}))})).fail((function(e){o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})}))}},{key:"cancelSaveName",value:function(){this.setState({editIndex:-1,editValue:""})}},{key:"switchCred",value:function(e){var t=this;i.default.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{register:"registered"===this.state.credentialList[e].status?"disable-credential":"enable-credential",credential_id:this.state.credentialList[e].credential_id}}).then((function(e){t.state.config.params.register&&o.default.sendMessage("App",{type:"registration"}),t.getCredentials()})).fail((function(e){o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})}))}},{key:"removeCred",value:function(e){var t=this;this.setState({removeIndex:e},(function(){o.default.sendMessage("App",{type:"confirm",title:r.default.t("profile.scheme-webauthn-confirm-title"),message:r.default.t("profile.scheme-webauthn-confirm-message"),callback:t.confirmRemoveCred})}))}},{key:"confirmRemoveCred",value:function(e){var t=this;e?i.default.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{register:"remove-credential",credential_id:this.state.credentialList[this.state.removeIndex].credential_id}}).then((function(e){t.getCredentials(),o.default.sendMessage("Notification",{type:"info",message:r.default.t("profile.scheme-webauthn-removed")}),t.state.config.params.register&&o.default.sendMessage("App",{type:"registration"})})).fail((function(e){o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})})).always((function(){o.default.sendMessage("App",{type:"closeConfirm"})})):o.default.sendMessage("App",{type:"closeConfirm"})}},{key:"render",value:function(){var e,t=this,a=[];return this.state.credentialList.forEach((function(e,s){var n=new Date(1e3*e.created_at);if(t.state.editIndex===s)a.push(l.default.createElement("tr",{key:s},l.default.createElement("td",{className:"d-none d-md-block"},n.toLocaleString()),l.default.createElement("td",null,l.default.createElement("form",{className:"needs-validation",noValidate:!0,onSubmit:function(e){return t.saveName(e,s)}},l.default.createElement("input",{type:"text",className:"form-control",value:t.state.editValue,onChange:function(e){return t.changeName(e,s)},placeholder:r.default.t("profile.webauthn-edit-placeholder")}))),l.default.createElement("td",{className:"d-none d-md-block"},r.default.t("admin.yes")),l.default.createElement("td",null,l.default.createElement("div",{className:"btn-group",role:"group"},l.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return t.saveName(e,s)},title:r.default.t("modal.ok")},l.default.createElement("i",{className:"fas fa-save"})),l.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return t.cancelSaveName()},title:r.default.t("modal.close")},l.default.createElement("i",{className:"fas fa-times"}))))));else if("registered"===e.status){var i="";e.credential_id===t.state.credAssertion&&(i=l.default.createElement("i",{className:"far fa-check-circle btn-icon-right text-success"})),a.push(l.default.createElement("tr",{key:s},l.default.createElement("td",{className:"d-none d-md-block"},n.toLocaleString()),l.default.createElement("td",null,l.default.createElement("span",{className:"badge badge-success"},e.name),i),l.default.createElement("td",{className:"d-none d-md-block"},r.default.t("admin.yes")),l.default.createElement("td",null,l.default.createElement("div",{className:"btn-group",role:"group"},l.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return t.switchCred(s)},title:r.default.t("profile.scheme-webauthn-btn-switch-off")},l.default.createElement("i",{className:"fas fa-toggle-on"})),l.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return t.editNameCred(s)},title:r.default.t("profile.scheme-webauthn-btn-edit")},l.default.createElement("i",{className:"fas fa-edit"})),l.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return t.removeCred(s)},title:r.default.t("profile.scheme-webauthn-btn-remove")},l.default.createElement("i",{className:"fas fa-trash"}))))))}else a.push(l.default.createElement("tr",{key:s},l.default.createElement("td",{className:"d-none d-md-block"},n.toLocaleString()),l.default.createElement("td",null,l.default.createElement("span",{className:"badge badge-danger"},e.name)),l.default.createElement("td",{className:"d-none d-md-block"},r.default.t("admin.no")),l.default.createElement("td",null,l.default.createElement("div",{className:"btn-group",role:"group"},l.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return t.switchCred(s)},title:r.default.t("profile.scheme-webauthn-btn-switch-on")},l.default.createElement("i",{className:"fas fa-toggle-off"})),l.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return t.editNameCred(s)},title:r.default.t("profile.scheme-webauthn-btn-edit")},l.default.createElement("i",{className:"fas fa-edit"})),l.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return t.removeCred(s)},title:r.default.t("profile.scheme-webauthn-btn-remove")},l.default.createElement("i",{className:"fas fa-trash"}))))))})),this.state.webauthnEnabled||(e=l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("div",{className:"alert alert-danger",role:"alert"},r.default.t("profile.scheme-webauthn-disabled"))))),l.default.createElement("div",null,l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("h4",null,r.default.t("profile.scheme-webauthn-title",{module:this.state.module,name:this.state.name})))),e,l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return t.getCredentials(e)}},r.default.t("login.btn-reload")))),l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("table",{className:"table table-responsive table-striped"},l.default.createElement("thead",null,l.default.createElement("tr",null,l.default.createElement("th",{className:"d-none d-md-block"},r.default.t("profile.scheme-webauthn-table-created_at")),l.default.createElement("th",null,r.default.t("profile.scheme-webauthn-table-name")),l.default.createElement("th",{className:"d-none d-md-block"},r.default.t("profile.scheme-webauthn-table-enabled")),l.default.createElement("th",null))),l.default.createElement("tbody",null,a)))),l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("hr",null))),l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("div",{className:"btn-group",role:"group"},l.default.createElement("button",{type:"button",disabled:!this.state.webauthnEnabled,className:"btn btn-primary",onClick:function(e){return t.createCredential(e)},title:r.default.t("profile.scheme-webauthn-register-title")},r.default.t("profile.scheme-webauthn-register")),l.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return t.testAssertion(e)},disabled:!this.state.credentialAvailable||!this.state.webauthnEnabled,title:r.default.t("profile.scheme-webauthn-test-registration-title")},r.default.t("profile.scheme-webauthn-test-registration"))))))}}]),u);function u(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,e));return t.state={config:e.config,module:e.module,name:e.name,profile:e.profile,registered:!1,registration:!1,credentialList:[],credentialAvailable:!1,editIndex:-1,editValue:"",removeIndex:-1,credAssertion:!1,webauthnEnabled:!!window.PublicKeyCredential,registerUrl:e.config.params.register?"/"+e.config.params.register+"/profile":"/profile"},t.getCredentials=t.getCredentials.bind(t),t.createCredential=t.createCredential.bind(t),t.testAssertion=t.testAssertion.bind(t),t.editNameCred=t.editNameCred.bind(t),t.changeName=t.changeName.bind(t),t.saveName=t.saveName.bind(t),t.cancelSaveName=t.cancelSaveName.bind(t),t.switchCred=t.switchCred.bind(t),t.removeCred=t.removeCred.bind(t),t.confirmRemoveCred=t.confirmRemoveCred.bind(t),t.getCredentials(),t}t.default=d},82:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var n=a(0),l=d(n),r=d(a(1)),i=d(a(83)),o=d(a(3)),c=d(a(2));function d(e){return e&&e.__esModule?e:{default:e}}d(a(6));var u=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,n.Component),function(e,t,a){t&&s(e.prototype,t),a&&s(e,a)}(f,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({config:e.config,module:e.module,name:e.name,profile:e.profile,registerUrl:e.config.params.register?"/"+e.config.params.register+"/profile":"/profile"},(function(){t.getRegister()}))}},{key:"getRegister",value:function(){var e=this;this.state.profile&&o.default.glewlwydRequest(this.state.registerUrl+"/scheme/register/","PUT",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name}).then((function(t){var a;a="NONE"!==t.type&&t.type?t:{type:"NONE",secret:"",moving_factor:0,time_step_size:t["totp-window"]},e.setState({myOtp:a,allowHotp:t["hotp-allow"],allowTotp:t["totp-allow"]})})).fail((function(e){c.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})})).always((function(){e.showQRCode()}))}},{key:"showQRCode",value:function(){var e=!1;if(this.state.myOtp.issuer&&this.state.profile.username&&this.state.myOtp.secret&&this.state.myOtp.digits&&("HOTP"===this.state.myOtp.type&&void 0!==this.state.myOtp.moving_factor?e="otpauth://hotp/"+encodeURIComponent(this.state.myOtp.issuer)+":"+encodeURIComponent(this.state.profile.username)+"?issuer="+encodeURIComponent([location.protocol,"//",location.host].join(""))+"&secret="+encodeURIComponent(this.state.myOtp.secret)+"&digits="+this.state.myOtp.digits+"&algorithm=SHA1&counter="+this.state.myOtp.moving_factor:"TOTP"===this.state.myOtp.type&&this.state.myOtp.time_step_size&&(e="otpauth://totp/"+encodeURIComponent(this.state.myOtp.issuer)+":"+encodeURIComponent(this.state.profile.username)+"?issuer="+encodeURIComponent([location.protocol,"//",location.host].join(""))+"&secret="+encodeURIComponent(this.state.myOtp.secret)+"&digits="+this.state.myOtp.digits+"&algorithm=SHA1&period="+this.state.myOtp.time_step_size)),e){var t=(0,i.default)(0,"L");t.addData(e),t.make(),this.setState({otpUrl:e,qrcode:t.createSvgTag(4)})}else this.setState({otpUrl:!1,qrcode:""})}},{key:"changeParam",value:function(e,t,a){var s=this,n=this.state.myOtp;n[t]=a?parseInt(e.target.value):e.target.value,this.setState({myOtp:n},(function(){s.showQRCode()}))}},{key:"changeType",value:function(e,t){var a=this;e.preventDefault();var s=this.state.myOtp;s.type=t,this.setState({myOtp:s},(function(){a.showQRCode()}))}},{key:"generateSecret",value:function(){var e=this;o.default.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{"generate-secret":!0}}).then((function(t){var a=e.state.myOtp;a.secret=t.secret,e.setState({myOtp:a},(function(){e.showQRCode()}))})).fail((function(e){c.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})}))}},{key:"register",value:function(){var e=this,t={},a=!1;"NONE"!==this.state.myOtp.type&&(this.state.myOtp.secret||(t.secret=r.default.t("profile.scheme-otp-secret-error"),a=!0),"HOTP"===this.state.myOtp.type?""!==this.state.myOtp.moving_factor&&void 0!==this.state.myOtp.moving_factor||(t.moving_factor=r.default.t("profile.scheme-otp-moving_factor-error"),a=!0):"TOTP"===this.state.myOtp.type&&(""!==this.state.myOtp.time_step_size&&void 0!==this.state.myOtp.time_step_size||(t.time_step_size=r.default.t("profile.scheme-otp-time_step_size-error"),a=!0),""===this.state.myOtp.start_offset&&(t.start_offset=r.default.t("profile.scheme-otp-start_offset-error"),a=!0))),this.setState({errorList:t},(function(){a||o.default.glewlwydRequest(e.state.registerUrl+"/scheme/register/","POST",{username:e.state.profile.username,scheme_type:e.state.module,scheme_name:e.state.name,value:e.state.myOtp}).then((function(t){c.default.sendMessage("Notification",{type:"info",message:r.default.t("profile.scheme-otp-save-ok")}),e.getRegister(),e.state.config.params.register&&c.default.sendMessage("App",{type:"registration"})})).fail((function(e){c.default.sendMessage("Notification",{type:"danger",message:r.default.t("profile.scheme-otp-save-error")})}))}))}},{key:"render",value:function(){var e,t,a,s,n,i,o=this;return a=l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("div",{className:"input-group input-group-sm mb-3"},l.default.createElement("div",{className:"input-group-prepend"},l.default.createElement("span",{className:"input-group-text"},r.default.t("profile.scheme-otp-secret"))),l.default.createElement("input",{type:"text",maxLength:"128",className:this.state.errorList.secret?"form-control is-invalid":"form-control",id:"scheme-otp-secret",onChange:function(e){return o.changeParam(e,"secret")},value:this.state.myOtp.secret,placeholder:r.default.t("profile.scheme-otp-secret-ph")}),l.default.createElement("div",{className:"input-group-append"},l.default.createElement("button",{className:"btn btn-outline-secondary",type:"button",onClick:this.generateSecret},r.default.t("profile.scheme-otp-generate-secret"))),this.state.errorList.secret?l.default.createElement("span",{className:"error-input"},this.state.errorList.secret):""))),"HOTP"===this.state.myOtp.type?e=l.default.createElement("div",null,a,l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("div",{className:"input-group input-group-sm mb-3"},l.default.createElement("div",{className:"input-group-prepend"},l.default.createElement("span",{className:"input-group-text"},r.default.t("profile.scheme-otp-moving_factor"))),l.default.createElement("input",{type:"number",min:"0",step:"1",className:this.state.errorList.moving_factor?"form-control is-invalid":"form-control",id:"scheme-otp-moving_factor",onChange:function(e){return o.changeParam(e,"moving_factor",1)},value:this.state.myOtp.moving_factor,placeholder:r.default.t("profile.scheme-otp-moving_factor-ph")}),this.state.errorList.moving_factor?l.default.createElement("span",{className:"error-input"},this.state.errorList.moving_factor):"")))):"TOTP"===this.state.myOtp.type&&(t=l.default.createElement("div",null,a,l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("div",{className:"input-group input-group-sm mb-3"},l.default.createElement("div",{className:"input-group-prepend"},l.default.createElement("span",{className:"input-group-text"},r.default.t("profile.scheme-otp-time_step_size"))),l.default.createElement("input",{type:"number",min:"0",step:"1",className:this.state.errorList.time_step_size?"form-control is-invalid":"form-control",id:"scheme-otp-time_step_size",onChange:function(e){return o.changeParam(e,"time_step_size",1)},value:this.state.myOtp.time_step_size,placeholder:r.default.t("profile.scheme-otp-time_step_size-ph")}),this.state.errorList.time_step_size?l.default.createElement("span",{className:"error-input"},this.state.errorList.time_step_size):""))))),this.state.allowHotp&&(s=l.default.createElement("a",{className:"dropdown-item"+("HOTP"===this.state.myOtp.type?" active":""),href:"#",onClick:function(e){return o.changeType(e,"HOTP")}},r.default.t("profile.scheme-otp-type-HOTP"))),this.state.allowTotp&&(n=l.default.createElement("a",{className:"dropdown-item"+("TOTP"===this.state.myOtp.type?" active":""),href:"#",onClick:function(e){return o.changeType(e,"TOTP")}},r.default.t("profile.scheme-otp-type-TOTP"))),this.state.otpUrl&&(i=l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-4"},l.default.createElement("a",{href:this.state.otpUrl,title:this.state.otpUrl},l.default.createElement("div",{dangerouslySetInnerHTML:{__html:this.state.qrcode}}))))),l.default.createElement("div",null,l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("h4",null,r.default.t("profile.scheme-otp-title")))),l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("div",{className:"input-group input-group-sm mb-3"},l.default.createElement("div",{className:"input-group-prepend"},l.default.createElement("span",{className:"input-group-text"},r.default.t("profile.scheme-otp-type"))),l.default.createElement("div",{className:"dropdown"},l.default.createElement("button",{className:"btn btn-secondary dropdown-toggle",type:"button",id:"scheme-otp-type","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},r.default.t("profile.scheme-otp-type-"+this.state.myOtp.type)),l.default.createElement("div",{className:"dropdown-menu","aria-labelledby":"scheme-otp-type"},n,s,l.default.createElement("a",{className:"dropdown-item"+("NONE"===this.state.myOtp.type?" active":""),href:"#",onClick:function(e){return o.changeType(e,"NONE")}},r.default.t("profile.scheme-otp-type-NONE"))))))),e,t,i,l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("hr",null))),l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("div",{className:"btn-group",role:"group"},l.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){return o.register(e)}},r.default.t("profile.scheme-otp-save"))))))}}]),f);function f(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,e));return t.state={config:e.config,module:e.module,name:e.name,profile:e.profile,myOtp:!1,errorList:{},otpUrl:!1,qrcode:"",allowHotp:!1,allowTotp:!1,registerUrl:e.config.params.register?"/"+e.config.params.register+"/profile":"/profile"},t.getRegister=t.getRegister.bind(t),t.register=t.register.bind(t),t.changeParam=t.changeParam.bind(t),t.changeType=t.changeType.bind(t),t.generateSecret=t.generateSecret.bind(t),t.showQRCode=t.showQRCode.bind(t),t.getRegister(),t}t.default=u},84:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var n=a(0),l=c(n),r=c(a(1)),i=c(a(3)),o=c(a(2));function c(e){return e&&e.__esModule?e:{default:e}}c(a(6));var d=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(u,n.Component),function(e,t,a){t&&s(e.prototype,t),a&&s(e,a)}(u,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,module:e.module,name:e.name,profile:e.profile,registered:!1,registration:!1,addModal:!1,certFile:!1,fileName:!1,activeCert:!1,downloadCert:!1,showPassword:!1,canAddCert:!1,canRequestCert:!1,registerUrl:e.config.params.register?"/"+e.config.params.register+"/profile":"/profile"})}},{key:"getRegister",value:function(){var e=this;return this.state.profile?i.default.glewlwydRequest(this.state.registerUrl+"/scheme/register/","PUT",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name}).then((function(t){e.setState({certificateList:t.certificate,canAddCert:t["add-certificate"],certFile:!1,canRequestCert:t["request-certificate"],fileName:!1,activeCert:!1,downloadCert:!1})})).fail((function(t){e.setState({certificateList:[],canAddCert:!1,canRequestCert:!1,certFile:!1,fileName:!1,downloadCert:!1},(function(){o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})}))})):Promise.reject(new Error("fail"))}},{key:"selectCertFile",value:function(e){var t=this,a=(this.state.profile,e.target.files[0]),s=new FileReader;s.onload=function(e){t.setState({certFile:e.target.result,fileName:a.name})},s.readAsText(a)}},{key:"addCertificateFile",value:function(){var e=this;this.state.certFile&&i.default.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{register:"upload-certificate",x509:this.state.certFile}}).then((function(t){e.getRegister(),e.state.config.params.register&&o.default.sendMessage("App",{type:"registration"})})).fail((function(e){400===e.status?o.default.sendMessage("Notification",{type:"danger",message:r.default.t("profile.scheme-certificate-invalid")}):o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})}))}},{key:"addCertificateFromRequest",value:function(){var e=this;i.default.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{register:"use-certificate"}}).then((function(t){e.getRegister(),e.state.config.params.register&&o.default.sendMessage("App",{type:"registration"})})).fail((function(e){400===e.status?o.default.sendMessage("Notification",{type:"danger",message:r.default.t("profile.scheme-certificate-invalid")}):o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})}))}},{key:"requestNewCertificate",value:function(){var e=this;i.default.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{register:"request-certificate"}}).then((function(t){e.getRegister().then((function(){e.state.config.params.register&&o.default.sendMessage("App",{type:"registration"}),e.setState({downloadCert:t,showPassword:!1})}))})).fail((function(e){400===e.status?o.default.sendMessage("Notification",{type:"danger",message:r.default.t("profile.scheme-certificate-invalid")}):o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})}))}},{key:"switchCertStatus",value:function(e){var t=this;i.default.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{register:"toggle-certificate",certificate_id:e.certificate_id,enabled:!e.enabled}}).then((function(a){o.default.sendMessage("Notification",{type:"info",message:r.default.t("profile.scheme-certificate-"+(e.enabled?"disabled":"enabled"))}),t.getRegister(),t.state.config.params.register&&o.default.sendMessage("App",{type:"registration"})})).fail((function(e){o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})}))}},{key:"deleteCert",value:function(e,t){var a=this;e.preventDefault(),this.setState({curCert:t,certFile:!1,fileName:!1},(function(){o.default.sendMessage("App",{type:"confirm",title:r.default.t("profile.scheme-certificate-confirm-title"),message:r.default.t("profile.scheme-certificate-confirm-message"),callback:a.confirmDeleteCert})}))}},{key:"confirmDeleteCert",value:function(e){var t=this;e?i.default.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{register:"delete-certificate",certificate_id:this.state.curCert.certificate_id}}).then((function(e){t.getRegister(),t.state.config.params.register&&o.default.sendMessage("App",{type:"registration"})})).fail((function(e){o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})})).always((function(){o.default.sendMessage("App",{type:"closeConfirm"})})):o.default.sendMessage("App",{type:"closeConfirm"})}},{key:"testCertificate",value:function(){var e=this;i.default.glewlwydRequest(this.state.registerUrl+"/scheme/register/","POST",{username:this.state.profile.username,scheme_type:this.state.module,scheme_name:this.state.name,value:{register:"test-certificate"}}).then((function(t){e.setState({activeCert:t}),o.default.sendMessage("Notification",{type:"info",message:r.default.t("profile.scheme-certificate-test-valid")})})).fail((function(e){400===e.status||401===e.status?o.default.sendMessage("Notification",{type:"danger",message:r.default.t("profile.scheme-certificate-invalid")}):o.default.sendMessage("Notification",{type:"danger",message:r.default.t("error-api-connect")})}))}},{key:"showPassword",value:function(){this.setState({showPassword:!this.state.showPassword})}},{key:"copyPassword",value:function(){navigator.clipboard.writeText(this.state.downloadCert.password).then((function(){o.default.sendMessage("Notification",{type:"info",message:r.default.t("profile.scheme-certificate-p12-file-copy-password-success")})}),(function(e){o.default.sendMessage("Notification",{type:"danger",message:r.default.t("profile.scheme-certificate-p12-file-copy-password-error")})}))}},{key:"render",value:function(){var e,t=this,a=[];if(this.state.certificateList.forEach((function(e,s){var n,i,o=new Date(1e3*e.expiration),c=new Date(1e3*e.last_used);t.state.activeCert&&e.certificate_id===t.state.activeCert.certificate_id&&(i=l.default.createElement("i",{className:"far fa-check-circle btn-icon-right text-success"})),n=!0===e.enabled?l.default.createElement("div",{className:"btn-group",role:"group"},l.default.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(a){return t.switchCertStatus(e)},title:r.default.t("admin.switch-off")},l.default.createElement("i",{className:"fas fa-toggle-on"})),l.default.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(a){return t.deleteCert(a,e)},title:r.default.t("admin.delete")},l.default.createElement("i",{className:"fas fa-trash"}))):!1===e.enabled?l.default.createElement("div",{className:"btn-group",role:"group"},l.default.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(a){return t.switchCertStatus(e)},title:r.default.t("admin.switch-on")},l.default.createElement("i",{className:"fas fa-toggle-off"})),l.default.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(a){return t.deleteCert(a,e)},title:r.default.t("admin.delete")},l.default.createElement("i",{className:"fas fa-trash"}))):l.default.createElement("div",{className:"btn-group",role:"group"},l.default.createElement("button",{type:"button",disabled:!0,className:"btn btn-secondary",title:r.default.t("admin.switch-off")},l.default.createElement("i",{className:"fas fa-toggle-on"})),l.default.createElement("button",{type:"button",disabled:!0,className:"btn btn-secondary",title:r.default.t("admin.delete")},l.default.createElement("i",{className:"fas fa-trash"}))),a.push(l.default.createElement("tr",{key:s},l.default.createElement("td",null,l.default.createElement("span",{className:"d-inline-block",tabIndex:"0","data-toggle":"tooltip",title:e.certificate_dn},e.certificate_dn.substring(0,8),"[...]"),i),l.default.createElement("td",{className:"d-none d-lg-table-cell"},l.default.createElement("span",{className:"d-inline-block",tabIndex:"1","data-toggle":"tooltip",title:e.certificate_issuer_dn},e.certificate_issuer_dn.substring(0,8),"[...]")),l.default.createElement("td",{className:"d-none d-lg-table-cell"},o.toLocaleString()),l.default.createElement("td",{className:"d-none d-lg-table-cell"},c.toLocaleString()),l.default.createElement("td",null,n)))})),this.state.downloadCert){var s="********";this.state.showPassword&&(s=this.state.downloadCert.password),e=l.default.createElement("div",null,l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-3"},l.default.createElement("a",{className:"btn btn-primary",download:"cert.p12",href:"data:application/x-pkcs12;base64,"+this.state.downloadCert.p12,target:"_blank"},r.default.t("profile.scheme-certificate-p12-file-save"))),l.default.createElement("div",{className:"col-md-4"},l.default.createElement("h5",null,r.default.t("profile.scheme-certificate-p12-file-password"),l.default.createElement("code",{className:"btn-icon-right"},s))),l.default.createElement("div",{className:"col-md-2"},l.default.createElement("div",{className:"btn-group",role:"group","aria-label":"current-certificate"},l.default.createElement("button",{type:"button",className:"btn btn-outline-secondary",onClick:this.showPassword,title:r.default.t("profile.scheme-certificate-p12-file-"+(this.state.showPassword?"hide-password":"show-password"))},l.default.createElement("i",{className:"fas "+(this.state.showPassword?"fa-eye-slash":"fa-eye")})),l.default.createElement("button",{type:"button",className:"btn btn-outline-secondary",onClick:this.copyPassword,title:r.default.t("profile.scheme-certificate-p12-file-copy-password")},l.default.createElement("i",{className:"fas fa-copy"}))))))}return l.default.createElement("div",null,l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("h4",null,r.default.t("profile.scheme-certificate-title",{module:this.state.module,name:this.state.name})))),l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-6"},l.default.createElement("div",{className:"input-group mb-3"},l.default.createElement("div",{className:"input-group-prepend"},l.default.createElement("button",{className:"btn btn-outline-secondary",type:"button",disabled:!this.state.canAddCert,id:"addCertificateFromFile",title:r.default.t("profile.scheme-certificate-add-from-file"),onClick:this.addCertificateFile},r.default.t("upload"))),l.default.createElement("div",{className:"custom-file"},l.default.createElement("input",{type:"file",disabled:!this.state.canAddCert,className:"custom-file-input",id:"addCertificateFromFileInput","aria-describedby":"addCertificateFromFile",onChange:function(e){return t.selectCertFile(e)}}),l.default.createElement("label",{className:"custom-file-label",htmlFor:"addCertificateFromFile"},this.state.fileName||r.default.t("browse"))))),l.default.createElement("div",{className:"col-md-6"},l.default.createElement("div",{className:"btn-group",role:"group","aria-label":"current-certificate"},l.default.createElement("button",{type:"button",className:"btn btn-outline-secondary",disabled:!this.state.canAddCert,onClick:this.addCertificateFromRequest,title:r.default.t("profile.scheme-certificate-add-from-request")},l.default.createElement("i",{className:"fas fa-file-contract"})),l.default.createElement("button",{type:"button",className:"btn btn-outline-secondary",onClick:this.testCertificate,title:r.default.t("profile.scheme-certificate-test")},l.default.createElement("i",{className:"fas fa-question-circle"})),l.default.createElement("button",{type:"button",className:"btn btn-outline-secondary",disabled:!this.state.canRequestCert,onClick:this.requestNewCertificate,title:r.default.t("profile.scheme-certificate-request-new")},l.default.createElement("i",{className:"fas fa-external-link-alt"})),l.default.createElement("button",{type:"button",className:"btn btn-outline-secondary",onClick:this.getRegister,title:r.default.t("profile.scheme-certificate-refresh")},l.default.createElement("i",{className:"fas fa-sync"}))))),l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("table",{className:"table table-responsive table-striped"},l.default.createElement("thead",null,l.default.createElement("tr",null,l.default.createElement("th",null,r.default.t("profile.scheme-certificate-table-certificate_dn")),l.default.createElement("th",{className:"d-none d-lg-table-cell"},r.default.t("profile.scheme-certificate-table-certificate_issuer_dn")),l.default.createElement("th",{className:"d-none d-lg-table-cell"},r.default.t("profile.scheme-certificate-table-expiration")),l.default.createElement("th",{className:"d-none d-lg-table-cell"},r.default.t("profile.scheme-certificate-table-last_used")),l.default.createElement("th",null))),l.default.createElement("tbody",null,a)))),l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col-md-12"},l.default.createElement("hr",null))),e)}}]),u);function u(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,e));return t.state={config:e.config,module:e.module,name:e.name,profile:e.profile,registered:!1,registration:!1,certificateList:[],addModal:!1,certFile:!1,curCert:!1,fileName:!1,activeCert:!1,downloadCert:!1,showPassword:!1,canAddCert:!1,canRequestCert:!1,registerUrl:e.config.params.register?"/"+e.config.params.register+"/profile":"/profile"},t.getRegister=t.getRegister.bind(t),t.selectCertFile=t.selectCertFile.bind(t),t.addCertificateFile=t.addCertificateFile.bind(t),t.addCertificateFromRequest=t.addCertificateFromRequest.bind(t),t.requestNewCertificate=t.requestNewCertificate.bind(t),t.switchCertStatus=t.switchCertStatus.bind(t),t.deleteCert=t.deleteCert.bind(t),t.confirmDeleteCert=t.confirmDeleteCert.bind(t),t.testCertificate=t.testCertificate.bind(t),t.showPassword=t.showPassword.bind(t),t.copyPassword=t.copyPassword.bind(t),t.getRegister(),t}t.default=d},85:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var n=a(0),l=i(n),r=i(a(1));function i(e){return e&&e.__esModule?e:{default:e}}var o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,n.Component),function(e,t,a){t&&s(e.prototype,t),a&&s(e,a)}(c,[{key:"componentWillReceiveProps",value:function(e){this.setState({title:e.title,message:e.message})}},{key:"closeModal",value:function(e,t){$("#messageModal").modal("hide")}},{key:"render",value:function(){var e=this,t=[];return this.state.message&&this.state.message.forEach((function(e,a){t.push(l.default.createElement("li",{key:a},e))})),l.default.createElement("div",{className:"modal fade",id:"messageModal",tabIndex:"-1",role:"dialog","aria-labelledby":"messageModalLabel","aria-hidden":"true"},l.default.createElement("div",{className:"modal-dialog",role:"document"},l.default.createElement("div",{className:"modal-content"},l.default.createElement("div",{className:"modal-header"},l.default.createElement("h5",{className:"modal-title",id:"messageModalLabel"},this.state.title),l.default.createElement("button",{type:"button",className:"close","aria-label":r.default.t("modal.close"),onClick:function(t){return e.closeModal(t,!1)}},l.default.createElement("span",{"aria-hidden":"true"},"×"))),l.default.createElement("div",{className:"modal-body"},l.default.createElement("ul",null,t)),l.default.createElement("div",{className:"modal-footer"},l.default.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(t){return e.closeModal(t,!1)}},r.default.t("modal.close"))))))}}]),c);function c(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,e));return t.state={title:e.title,message:e.message},t.closeModal=t.closeModal.bind(t),t}t.default=o}})}));