!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var a in n)("object"==typeof exports?exports:e)[a]=n[a]}}(window,(function(){return function(e){function t(t){for(var a,s,i=t[0],c=t[1],l=t[2],f=0,m=[];f<i.length;f++)s=i[f],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&m.push(r[s][0]),r[s]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);for(u&&u(t);m.length;)m.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,i=1;i<n.length;i++){var c=n[i];0!==r[c]&&(a=!1)}a&&(o.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},r={3:0},o=[];function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var i=window.webpackJsonp=window.webpackJsonp||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;return o.push([25,0]),n()}({2:function(e,t,n){"use strict";function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var r=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.subscriberList={}}return function(e,t,n){t&&a(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"subscribe",value:function(e,t){this.subscriberList[e]=t}},{key:"sendMessage",value:function(e,t){if(Array.isArray(e)||(e=[e]),"broadcast"===e[0])this.subscriberList.forEach((function(e,n){e({type:"broadcast",message:t})}));else for(var n in this.subscriberList)e.indexOf(n)>=0&&this.subscriberList[n](t)}}]),e}());t.a=r},25:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(5),s=n.n(o),i=n(1),c=n(10),l=n(11),u=n(3),f=n(2),m=n(4);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=y(e);if(t){var r=y(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return g(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={config:e.config,userList:e.userList,currentUser:e.currentUser,client:e.client,newUser:e.newUser,newUserScheme:e.newUserScheme,canContinue:e.canContinue,showGrant:e.showGrant,schemeListRequired:e.schemeListRequired,bGrantTitle:e.showGrant?i.a.t("login.grant-auth-title"):i.a.t("login.grant-change-title"),bGrant:e.showGrant?i.a.t("login.grant-auth"):i.a.t("login.grant-change"),showGrantAsterisk:e.showGrantAsterisk,selectAccount:e.selectAccount,registration:e.registration,resetCredentials:e.resetCredentials,resetCredentialsShow:e.resetCredentialsShow,pluginList:e.pluginList,sessionClosed:e.sessionClosed},a.clickLogout=a.clickLogout.bind(g(a)),a.clickGrant=a.clickGrant.bind(g(a)),a.clickContinue=a.clickContinue.bind(g(a)),a.newUser=a.newUser.bind(g(a)),a.managerUsers=a.managerUsers.bind(g(a)),a.changeSessionScheme=a.changeSessionScheme.bind(g(a)),a.registerNewUser=a.registerNewUser.bind(g(a)),a}return function(e,t,n){t&&d(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({userList:e.userList,currentUser:e.currentUser,client:e.client,config:e.config,showGrant:e.showGrant,newUser:e.newUser,newUserScheme:e.newUserScheme,canContinue:e.canContinue,schemeListRequired:e.schemeListRequired,bGrantTitle:e.showGrant?i.a.t("login.grant-auth-title"):i.a.t("login.grant-change-title"),bGrant:e.showGrant?i.a.t("login.grant-auth"):i.a.t("login.grant-change"),showGrantAsterisk:e.showGrantAsterisk,selectAccount:e.selectAccount,registration:e.registration,resetCredentials:e.resetCredentials,resetCredentialsShow:e.resetCredentialsShow,pluginList:e.pluginList,sessionClosed:e.sessionClosed})}},{key:"clickLogout",value:function(){return u.a.glewlwydRequest("/auth/?username="+this.state.currentUser.username,"DELETE").then((function(){f.a.sendMessage("App",{type:"InitProfile"}),f.a.sendMessage("App",{type:"SessionClosed"})})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.error-delete-session")}),f.a.sendMessage("App",{type:"InitProfile"}),f.a.sendMessage("App",{type:"SessionClosed"})}))}},{key:"revokeAll",value:function(e,t,n){e.preventDefault();var a=[];n&&this.state.pluginList.forEach((function(e){"oauth2-glewlwyd"===e.module?a.push(u.a.glewlwydRequestSub("/"+e.name+"/profile/token/","DELETE").fail((function(){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.error-delete-session")})}))):"oidc"===e.module&&a.push(u.a.glewlwydRequestSub("/"+e.name+"/token/","DELETE").fail((function(){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.error-delete-session")})})))})),a.length?Promise.all(a).then((function(e){return t?u.a.glewlwydRequest("/profile/session/","DELETE"):e})).then((function(){f.a.sendMessage("Notification",{type:"info",message:i.a.t("login.logout-all-success")}),f.a.sendMessage("App",{type:"InitProfile"})})):t&&u.a.glewlwydRequest("/profile/session/","DELETE").then((function(){f.a.sendMessage("Notification",{type:"info",message:i.a.t("login.logout-all-success")}),f.a.sendMessage("App",{type:"SessionClosed"})})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.error-delete-session")})}))}},{key:"clickGrant",value:function(){f.a.sendMessage("App",{type:"ToggleGrant"})}},{key:"clickContinue",value:function(){this.state.config.params.callback_url&&(document.location.href=this.state.config.params.callback_url+(this.state.config.params.callback_url.indexOf("?")>0?"&g_continue":"?g_continue"))}},{key:"newUser",value:function(e,t){e.preventDefault(),t?u.a.glewlwydRequest("/auth/","POST",{username:t}).then((function(){f.a.sendMessage("App",{type:"InitProfile"})})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.error-login")})})):f.a.sendMessage("App",{type:"NewUser"})}},{key:"registerNewUser",value:function(e,t){e.preventDefault(),document.location.href=this.state.config.ProfileUrl+"?register="+encodeURIComponent(t)+"&callback_url="+encodeURIComponent(document.location.href)}},{key:"resetCredentials",value:function(e,t){e.preventDefault(),f.a.sendMessage("App",{type:"ResetCredentials"})}},{key:"managerUsers",value:function(e){e.preventDefault(),f.a.sendMessage("App",{type:"SelectAccount"})}},{key:"changeSessionScheme",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.preventDefault(),f.a.sendMessage("App",{type:"newUserScheme",scheme:t,identify:n})}},{key:"cancelResetCredentials",value:function(){f.a.sendMessage("App",{type:"NewUser"})}},{key:"render",value:function(){var e=this,t="",n="",a="",o="",s=[];if(this.state.canContinue&&(a=r.a.createElement("button",{type:"button",className:"btn btn-success",onClick:this.clickContinue,title:i.a.t("login.continue-title")},r.a.createElement("i",{className:"fas fa-play btn-icon"}),i.a.t("login.continue"))),this.state.showGrantAsterisk&&(n=r.a.createElement("small",null,r.a.createElement("i",{className:"fas fa-asterisk btn-icon-right"}))),this.state.client&&(o=r.a.createElement("div",null,r.a.createElement("a",{className:"dropdown-item",href:"#",onClick:this.clickGrant,alt:this.state.bGrantTitle},r.a.createElement("i",{className:"fas fa-user-cog btn-icon"}),this.state.bGrant,n),r.a.createElement("div",{className:"dropdown-divider"}))),this.state.currentUser&&!this.state.selectAccount){this.state.registration.forEach((function(t,n){s.push(r.a.createElement("a",{key:n,className:"dropdown-item",href:"#",onClick:function(n){return e.registerNewUser(n,t.name)}},i.a.t(t.message)))}));var c=[];return this.state.userList&&this.state.userList.forEach((function(t,n){e.state.currentUser.username===t.username?c.push(r.a.createElement("a",{className:"dropdown-item active",href:"#",onClick:function(n){return e.newUser(n,t.username)},key:n,alt:t.name||t.username},t.name||t.username)):c.push(r.a.createElement("a",{className:"dropdown-item",href:"#",onClick:function(n){return e.newUser(n,t.username)},key:n,alt:t.name||t.username},t.name||t.username))})),t=r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{className:"btn btn-secondary dropdown-toggle",type:"button",id:"selectNewUser","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},r.a.createElement("i",{className:"fas fa-users btn-icon"}),i.a.t("login.login-another")),r.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"selectNewUser"},r.a.createElement("a",{className:"dropdown-item",href:"#",onClick:function(t){return e.newUser(t,!1)}},i.a.t("profile.menu-session-new")),r.a.createElement("a",{className:"dropdown-item",href:"#",onClick:function(t){return e.managerUsers(t)}},i.a.t("login.manage-users")),s,r.a.createElement("div",{className:"dropdown-divider"}),c)),r.a.createElement("div",{className:"text-center"},r.a.createElement("div",{className:"btn-group",role:"group"},a,r.a.createElement("button",{type:"button",className:"btn btn-danger",onClick:this.clickLogout},r.a.createElement("i",{className:"fas fa-sign-out-alt btn-icon"}),i.a.t("login.logout")),r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{className:"btn btn-danger dropdown-toggle",type:"button",id:"logoutDropdown","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}),r.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"logoutDropdown"},r.a.createElement("a",{className:"dropdown-item",href:"#",onClick:function(t){return e.revokeAll(t,!0,!0)}},i.a.t("login.logout-all-sessions-tokens")),r.a.createElement("a",{className:"dropdown-item",href:"#",onClick:function(t){return e.revokeAll(t,!0,!1)}},i.a.t("login.logout-all-sessions")),r.a.createElement("a",{className:"dropdown-item",href:"#",onClick:function(t){return e.revokeAll(t,!1,!0)}},i.a.t("login.logout-all-tokens"))))),r.a.createElement("hr",null),r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{className:"btn btn-secondary dropdown-toggle",type:"button",id:"selectGrant","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},r.a.createElement("i",{className:"fas fa-user-cog btn-icon"}),i.a.t("login.login-handle"),n),r.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"selectGrant"},o,r.a.createElement("a",{className:"dropdown-item",href:this.state.config.ProfileUrl||"",target:"_blank",rel:"noopener noreferrer"},i.a.t("login.update-profile")))),t))}if(this.state.newUser){this.state.resetCredentials&&this.state.resetCredentials.forEach((function(t,n){s.push(r.a.createElement("button",{key:n+e.state.config.register.length,type:"button",className:"btn btn-danger",onClick:function(n){return e.resetCredentials(n,t.name)}},i.a.t(t.message)))})),this.state.registration&&this.state.config.register&&this.state.config.register.forEach((function(t,n){s.push(r.a.createElement("button",{key:n,type:"button",className:"btn btn-success",onClick:function(n){return e.registerNewUser(n,t.name)}},i.a.t(t.message)))}));var l=i.a.t("login.login-choose-scheme"),u=[];return this.state.config.sessionSchemes&&this.state.config.sessionSchemes.length&&!this.state.sessionClosed?(this.state.newUserScheme?u.push(r.a.createElement("a",{key:0,className:"dropdown-item",href:"#",onClick:function(t){return e.changeSessionScheme(t,!1)},alt:i.a.t("login.password-title")},i.a.t("login.password-title"))):u.push(r.a.createElement("a",{key:0,className:"dropdown-item active",href:"#",onClick:function(t){return e.changeSessionScheme(t,!1)},alt:i.a.t("login.password-title")},i.a.t("login.password-title"))),u.push(r.a.createElement("div",{key:1,className:"dropdown-divider"})),this.state.config.sessionSchemes.forEach((function(t,n){!1!==t.show_nopassword_form&&(t.scheme_name===e.state.newUserScheme?(e.state.newUserScheme&&(l=i.a.t(t.scheme_display_name)),u.push(r.a.createElement("a",{key:n+2,className:"dropdown-item active",href:"#",onClick:function(n){return e.changeSessionScheme(n,t.scheme_name,!!t.identify)},alt:i.a.t(t.scheme_display_name)},i.a.t(t.scheme_display_name)))):u.push(r.a.createElement("a",{key:n+2,className:"dropdown-item",href:"#",onClick:function(n){return e.changeSessionScheme(n,t.scheme_name,!!t.identify)},alt:i.a.t(t.scheme_display_name)},i.a.t(t.scheme_display_name))))})),r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{className:"btn btn-primary dropdown-toggle",type:"button",id:"selectScheme","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},r.a.createElement("i",{className:"fas fa-user-lock btn-icon"}),l),r.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"selectScheme"},u)),s)):r.a.createElement("div",null,s)}return this.state.resetCredentialsShow?r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:this.cancelResetCredentials},i.a.t("login.btn-cancel")):""}}]),n}();function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=N(e);if(t){var r=N(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===v(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return S(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={config:e.config,currentUser:e.currentUser,client:e.client,scope:e.scope,authDetails:e.authDetails,show:e.show,infoSomeScopeUnavailable:e.infoSomeScopeUnavailable},a.handleToggleGrantScope=a.handleToggleGrantScope.bind(S(a)),a.handleGrantScope=a.handleGrantScope.bind(S(a)),a.handleToggleAuthDetails=a.handleToggleAuthDetails.bind(S(a)),f.a.subscribe("GrantScope",(function(e){})),a}return function(e,t,n){t&&w(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,currentUser:e.currentUser,client:e.client,scope:e.scope,authDetails:e.authDetails,show:e.show,infoSomeScopeUnavailable:e.infoSomeScopeUnavailable})}},{key:"handleToggleGrantScope",value:function(e){var t=this.state.scope;t.forEach((function(t){t.name===e.name&&(t.granted=!t.granted)})),this.setState({scope:t})}},{key:"handleGrantScope",value:function(){var e=[];this.state.scope.forEach((function(t){t.granted&&e.push(t.name)})),u.a.glewlwydRequest("/auth/grant/"+encodeURIComponent(this.state.client.client_id),"PUT",{scope:e.join(" ")}).then((function(){f.a.sendMessage("App",{type:"GrantComplete"})})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.error-set-grant")})}))}},{key:"handleToggleAuthDetails",value:function(e){var t=this,n=this.state.authDetails;n.forEach((function(n){e.type===n.type&&(n.consent=!n.consent,u.a.glewlwydRequest("/"+t.state.config.params.plugin+"/rar/"+t.state.config.params.client_id+"/"+e.type+"/"+(n.consent?"1":"0"),"PUT").then((function(){f.a.sendMessage("Notification",{type:"info",message:i.a.t("login.grant-auth-details-granted")})})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.error-set-grant")})})))})),this.setState({authDetails:n})}},{key:"render",value:function(){var e,t,n=this,a=[],o=[];return this.state.scope.forEach((function(e,t){"openid"===e.name?a.push(r.a.createElement("li",{className:"list-group-item",key:t},r.a.createElement("div",{className:"form-group form-check"},r.a.createElement("input",{type:"checkbox",className:"form-check-input",checked:!0,disabled:!0}),r.a.createElement("label",{className:"form-check-label",htmlFor:"grant-"+e.name},e.display_name)))):a.push(r.a.createElement("li",{className:"list-group-item",key:t},r.a.createElement("div",{className:"form-group form-check"},r.a.createElement("input",{type:"checkbox",className:"form-check-input",onChange:function(){return n.handleToggleGrantScope(e)},id:"grant-"+e.name,checked:e.granted}),r.a.createElement("label",{className:"form-check-label",htmlFor:"grant-"+e.name},e.display_name))))})),this.state.infoSomeScopeUnavailable&&(t=r.a.createElement("div",{className:"alert alert-info",role:"alert"},i.a.t("login.info-some-scope-unavailable"))),this.state.authDetails.forEach((function(e,t){var a,s,c,l,u,f,m=[],p=[],d=[],h=[],g=[],y=r.a.createElement("h5",null,i.a.t("login.grant-auth-details-type",{type:e.type}));e.locations.forEach((function(e,t){m.push(r.a.createElement("li",{className:"list-group-item",key:t},e))})),m.length&&(a=r.a.createElement("div",null,r.a.createElement("h5",null,i.a.t("login.grant-auth-details-locations")),r.a.createElement("ul",{className:"list-group"},m))),e.actions.forEach((function(e,t){p.push(r.a.createElement("li",{className:"list-group-item",key:t},e))})),p.length&&(s=r.a.createElement("div",null,r.a.createElement("h5",null,i.a.t("login.grant-auth-details-actions")),r.a.createElement("ul",{className:"list-group"},p))),e.datatypes.forEach((function(e,t){d.push(r.a.createElement("li",{className:"list-group-item",key:t},e))})),d.length&&(c=r.a.createElement("div",null,r.a.createElement("h5",null,i.a.t("login.grant-auth-details-datatypes")),r.a.createElement("ul",{className:"list-group"},d))),e.privileges.forEach((function(e,t){g.push(r.a.createElement("li",{className:"list-group-item",key:t},e))})),g.length&&(u=r.a.createElement("div",null,r.a.createElement("h5",null,i.a.t("login.grant-auth-details-privileges")),r.a.createElement("ul",{className:"list-group"},g))),e.enriched.forEach((function(e,t){var a=e;n.state.config.pattern.user.forEach((function(t){e===t.name&&(a=i.a.t(t.label))})),h.push(r.a.createElement("li",{className:"list-group-item",key:t},a))})),h.length&&(l=r.a.createElement("div",null,r.a.createElement("h5",null,i.a.t("login.grant-auth-details-enriched")),r.a.createElement("ul",{className:"list-group"},h))),e.description&&(f=r.a.createElement("h5",null,i.a.t("login.grant-auth-details-description",{description:e.description}))),o.push(r.a.createElement("li",{className:"list-group-item",key:t},r.a.createElement("div",{className:"form-group form-check"},r.a.createElement("input",{type:"checkbox",className:"form-check-input",onChange:function(){return n.handleToggleAuthDetails(e)},id:"auth-details-"+e.type,checked:e.consent&&e.enabled,disabled:!e.enabled}),r.a.createElement("label",{className:"form-check-label",htmlFor:"auth-details-"+e.type},e.description||e.type),r.a.createElement("button",{className:"btn btn-secondary btn-sm btn-icon-right",type:"button",title:i.a.t("details"),"data-toggle":"collapse","data-target":"#auth-details-collapse-"+e.type,"aria-expanded":"false","aria-controls":"auth-details-collapse-"+e.type},r.a.createElement("i",{className:"fas fa-chevron-circle-down"})),r.a.createElement("div",{className:"collapse",id:"auth-details-collapse-"+e.type},r.a.createElement("div",{className:"card card-body"},r.a.createElement("h4",null,i.a.t("login.grant-auth-details-explanation")),y,f,a,s,c,u,l)))))})),o.length&&(e=r.a.createElement("div",null,r.a.createElement("hr",null),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h3",null,i.a.t("login.grant-auth-details-title")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("ul",{className:"list-group"},o))))),r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h3",null,i.a.t("login.grant-title")))),r.a.createElement("hr",null),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h5",null,i.a.t("login.grant-client-title",{client:this.state.client.name})))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("ul",{className:"list-group"},a))),e,r.a.createElement("hr",{className:"glwd-hr-no-border"}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-2"},r.a.createElement("h5",null,i.a.t("login.grant-client-id"))),r.a.createElement("div",{className:"col-md-10"},r.a.createElement("h5",null,r.a.createElement("span",{className:"badge badge-secondary"},this.state.client.client_id)))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-2"},r.a.createElement("h5",null,i.a.t("login.grant-client-redirect-uri"))),r.a.createElement("div",{className:"col-md-10"},r.a.createElement("h5",null,r.a.createElement("span",{className:"badge badge-secondary"},this.state.client.redirect_uri)))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},t)),r.a.createElement("hr",null),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.handleGrantScope},i.a.t("login.grant")))),r.a.createElement("hr",{className:"glwd-hr-no-border"}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("b",null,i.a.t("login.grant-info-message")))))}}]),n}();function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function C(e,t){return(C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var U=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=R(e);if(t){var r=R(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===k(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return P(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={config:e.config,scheme:e.scheme,identify:e.identify,identifyUsername:"",currentUser:e.currentUser,triggerResult:!1,mockValue:""},a.triggerScheme=a.triggerScheme.bind(P(a)),a.validateMockValue=a.validateMockValue.bind(P(a)),a.handleChangeMockValue=a.handleChangeMockValue.bind(P(a)),a.handleChangeIdentifyUsernameValue=a.handleChangeIdentifyUsernameValue.bind(P(a)),a.triggerScheme(),a}return function(e,t,n){t&&O(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({config:e.config,scheme:e.scheme,identify:e.identify,identifyUsername:"",currentUser:e.currentUser,triggerResult:!1,mockValue:""},(function(){t.triggerScheme()}))}},{key:"triggerScheme",value:function(){var e=this;if(this.state.scheme){if(this.state.currentUser.username)var t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{description:"This is a mock trigger"}};else t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,value:{description:"This is a mock trigger"}};u.a.glewlwydRequest("/auth/scheme/trigger/","POST",t,!0).then((function(t){e.setState({triggerResult:t.code})})).fail((function(e){401===e.status?f.a.sendMessage("Notification",{type:"info",message:i.a.t("login.mock-trigger-must-register")}):f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.error-mock-trigger")})}))}}},{key:"handleChangeMockValue",value:function(e){this.setState({mockValue:e.target.value})}},{key:"handleChangeIdentifyUsernameValue",value:function(e){this.setState({identifyUsername:e.target.value})}},{key:"validateMockValue",value:function(e){e.preventDefault();var t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{code:this.state.mockValue}};this.state.currentUser.username||(t.value.username=this.state.identifyUsername),u.a.glewlwydRequest("/auth/","POST",t).then((function(){f.a.sendMessage("App",{type:"loginSuccess",loginSuccess:!0})})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.error-mock-value")})}))}},{key:"render",value:function(){var e,t=this;return this.state.triggerResult?(this.state.currentUser.username||(e=r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("label",{className:"input-group-text",htmlFor:"identifyUsername"},i.a.t("login.login"))),r.a.createElement("input",{type:"text",className:"form-control",name:"identifyUsername",id:"identifyUsername",autoFocus:!0,required:"",placeholder:i.a.t("login.login-placeholder"),value:this.state.identifyUsername||"",onChange:this.handleChangeIdentifyUsernameValue,autoComplete:"false"})))),r.a.createElement("form",{action:"#",id:"mockSchemeForm"},r.a.createElement("div",{className:"form-group"},r.a.createElement("h5",null,i.a.t("login.enter-mock-scheme-value"))),e,r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("label",{className:"input-group-text",htmlFor:"mockValue"},i.a.t("login.mock-value-label"))),r.a.createElement("input",{type:"text",className:"form-control",name:"mockValue",id:"mockValue",autoFocus:!0,required:"",placeholder:i.a.t("login.error-mock-expected",{value:this.state.triggerResult}),value:this.state.mockValue||"",onChange:this.handleChangeMockValue,autoComplete:"false"}))),r.a.createElement("button",{type:"submit",name:"mockbut",id:"mockbut",className:"btn btn-primary",onClick:function(e){return t.validateMockValue(e)},title:i.a.t("login.mock-value-button-title")},i.a.t("login.btn-ok")))):r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.triggerScheme},i.a.t("login.btn-reload"))}}]),n}();function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var M=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=x(e);if(t){var r=x(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===j(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return A(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={config:e.config,scheme:e.scheme,currentUser:e.currentUser,code:"",showValidate:!1},a.triggerScheme=a.triggerScheme.bind(A(a)),a.validateCode=a.validateCode.bind(A(a)),a.handleChangeCode=a.handleChangeCode.bind(A(a)),a}return function(e,t,n){t&&L(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,scheme:e.scheme,currentUser:e.currentUser,code:"",showValidate:!1})}},{key:"triggerScheme",value:function(e){var t=this;if(e.preventDefault(),this.state.scheme&&this.state.currentUser){var n={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{}};u.a.glewlwydRequest("/auth/scheme/trigger/","POST",n).then((function(e){f.a.sendMessage("Notification",{type:"info",message:i.a.t("login.mail-trigger-ok")}),t.setState({showValidate:!0})})).fail((function(e){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.mail-trigger-error")})}))}}},{key:"handleChangeCode",value:function(e){this.setState({code:e.target.value})}},{key:"validateCode",value:function(e){e.preventDefault();var t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{code:this.state.code}};u.a.glewlwydRequest("/auth/","POST",t,!0).then((function(){f.a.sendMessage("App",{type:"loginSuccess"})})).fail((function(e){401===e.status?f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.mail-code-invalid")}):f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.mail-code-error")})}))}},{key:"render",value:function(){var e,t,n=this;return this.state.showValidate&&(e=r.a.createElement("button",{type:"submit",name:"mailbut",id:"mailbut",className:"btn btn-primary",onClick:function(e){return n.validateCode(e)},title:i.a.t("login.mail-code-button-title")},i.a.t("login.btn-ok")),t=r.a.createElement("input",{type:"text",className:"form-control",name:"code",id:"code",autoFocus:!0,required:"",placeholder:i.a.t("login.mail-code-ph"),value:this.state.code||"",onChange:this.handleChangeCode,autoComplete:"false"})),r.a.createElement("form",{action:"#",id:"mailSchemeForm",onSubmit:function(e){return n.validateCode(e)}},r.a.createElement("div",{className:"form-group"},r.a.createElement("h5",null,i.a.t("login.mail-enter-scheme-code"))),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("label",{className:"input-group-text",htmlFor:"code"},i.a.t("login.mail-code-label"))),t)),r.a.createElement("div",{className:"btn-group",role:"group"},e,r.a.createElement("button",{type:"button",name:"triggerbut",id:"triggerbut",className:"btn btn-primary",onClick:this.triggerScheme,title:i.a.t("login.mail-trigger-button-title")},i.a.t("login.mail-scheme-trigger"))))}}]),n}();function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function G(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function q(e,t){return(q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function B(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V(e){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&q(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=V(e);if(t){var r=V(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===D(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return B(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={config:e.config,scheme:e.scheme,currentUser:e.currentUser,canLogin:!1,webauthnEnabled:!!window.PublicKeyCredential},a.triggerScheme=a.triggerScheme.bind(B(a)),a.login=a.login.bind(B(a)),a.triggerScheme(),a}return function(e,t,n){t&&G(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({config:e.config,scheme:e.scheme,currentUser:e.currentUser},(function(){t.triggerScheme()}))}},{key:"strToBin",value:function(e){return Uint8Array.from(atob(e),(function(e){return e.charCodeAt(0)}))}},{key:"binToStr",value:function(e){return btoa(new Uint8Array(e).reduce((function(e,t){return e+String.fromCharCode(t)}),""))}},{key:"login",value:function(e){var t=this;u.a.glewlwydRequest("/auth/scheme/trigger/","POST",{username:this.state.currentUser.username,scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,value:{}}).then((function(e){var n=[];e.allowCredentials.forEach((function(e){n.push({id:t.strToBin(e.credential_id),type:"public-key"})}));var a={allowCredentials:n,challenge:t.strToBin(e.challenge)};navigator.credentials.get({publicKey:a}).then((function(n){var a={};"id"in n&&(a.id=n.id),"type"in n&&(a.type=n.type),"rawId"in n&&(a.rawId=t.binToStr(n.rawId)),a.response={clientDataJSON:t.binToStr(n.response.clientDataJSON),authenticatorData:t.binToStr(n.response.authenticatorData),signature:t.binToStr(n.response.signature),userHandle:t.binToStr(n.response.userHandle)},n.response.getTransports&&(response.transports=n.response.getTransports()),u.a.glewlwydRequest("/auth/","POST",{username:t.state.currentUser.username,scheme_type:t.state.scheme.scheme_type,scheme_name:t.state.scheme.scheme_name,value:{session:e.session,credential:a}}).then((function(){f.a.sendMessage("App",{type:"loginSuccess"}),f.a.sendMessage("Notification",{type:"info",message:i.a.t("profile.scheme-webauthn-assertion-success")})})).fail((function(e){401===e.status?f.a.sendMessage("Notification",{type:"danger",message:i.a.t("profile.scheme-webauthn-assertion-error")}):f.a.sendMessage("Notification",{type:"danger",message:i.a.t("error-api-connect")})}))})).catch((function(e){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("profile.scheme-webauthn-error-assertion")})}))})).fail((function(e){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("error-api-connect")})}))}},{key:"triggerScheme",value:function(){var e=this;if(this.state.scheme&&this.state.currentUser){var t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{}};u.a.glewlwydRequest("/auth/scheme/trigger/","POST",t).then((function(t){e.setState({canLogin:!0})})).fail((function(t){e.setState({canLogin:!1},(function(){401===t.status?f.a.sendMessage("Notification",{type:"info",message:i.a.t("login.webauthn-trigger-must-register")}):f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.webauthn-error-trigger")})}))}))}}},{key:"render",value:function(){var e,t=this;return this.state.webauthnEnabled||(e=r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"alert alert-danger",role:"alert"},i.a.t("profile.scheme-webauthn-disabled"))))),r.a.createElement("div",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("h5",null,i.a.t("login.webauthn-login-title"))),r.a.createElement("div",{className:"form-group"},e),r.a.createElement("button",{type:"button",name:"loginBut",id:"loginBut",disabled:!this.state.canLogin||!this.state.webauthnEnabled,className:"btn btn-primary",onClick:function(e){return t.login(e)},title:i.a.t("login.webauthn-login-button-title")},i.a.t("login.webauthn-login-authenticate")))}}]),n}();function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function z(e,t){return(z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function J(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function H(e){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var K=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&z(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=H(e);if(t){var r=H(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===F(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return J(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={config:e.config,scheme:e.scheme,currentUser:e.currentUser,value:""},a.validateOTPValue=a.validateOTPValue.bind(J(a)),a.handleChangeOTPValue=a.handleChangeOTPValue.bind(J(a)),a}return function(e,t,n){t&&W(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,scheme:e.scheme,currentUser:e.currentUser})}},{key:"handleChangeOTPValue",value:function(e){this.setState({value:e.target.value})}},{key:"validateOTPValue",value:function(e){e.preventDefault();var t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{value:this.state.value}};u.a.glewlwydRequest("/auth/","POST",t).then((function(){f.a.sendMessage("Notification",{type:"info",message:i.a.t("login.success-login")}),f.a.sendMessage("App",{type:"loginSuccess"})})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.error-login")})}))}},{key:"render",value:function(){var e=this;return r.a.createElement("form",{action:"#",id:"otpSchemeForm"},r.a.createElement("div",{className:"form-group"},r.a.createElement("h5",null,i.a.t("login.otp-enter-value"))),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("label",{className:"input-group-text",htmlFor:"value"},i.a.t("login.otp-value-label"))),r.a.createElement("input",{type:"text",className:"form-control",name:"value",id:"value",required:"",placeholder:i.a.t("login.error-value-expected",{value:this.state.triggerResult}),value:this.state.value||"",onChange:this.handleChangeOTPValue,autoFocus:!0,autoComplete:"false"}))),r.a.createElement("button",{type:"submit",name:"but",id:"but",className:"btn btn-primary",onClick:function(t){return e.validateOTPValue(t)},title:i.a.t("login.otp-button-title")},i.a.t("login.btn-ok")))}}]),n}();function Q(e){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function X(e,t){return(X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var te=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&X(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=ee(e);if(t){var r=ee(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===Q(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Z(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={config:e.config,scheme:e.scheme,currentUser:e.currentUser,value:""},a.validatePasswordValue=a.validatePasswordValue.bind(Z(a)),a.handleChangePasswordValue=a.handleChangePasswordValue.bind(Z(a)),a}return function(e,t,n){t&&Y(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,scheme:e.scheme,currentUser:e.currentUser})}},{key:"handleChangePasswordValue",value:function(e){this.setState({value:e.target.value})}},{key:"validatePasswordValue",value:function(e){e.preventDefault();var t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{password:this.state.value}};u.a.glewlwydRequest("/auth/","POST",t).then((function(){f.a.sendMessage("Notification",{type:"info",message:i.a.t("login.success-login")}),f.a.sendMessage("App",{type:"loginSuccess"})})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.error-login")})}))}},{key:"render",value:function(){var e=this;return r.a.createElement("form",{action:"#",id:"otpSchemeForm"},r.a.createElement("div",{className:"form-group"},r.a.createElement("h5",null,i.a.t("login.password-enter-value"))),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("label",{className:"input-group-text",htmlFor:"value"},i.a.t("login.password-value-label"))),r.a.createElement("input",{type:"password",className:"form-control",name:"value",id:"value",required:"",placeholder:i.a.t("login.error-value-expected",{value:this.state.triggerResult}),value:this.state.value||"",onChange:this.handleChangePasswordValue,autoFocus:!0}))),r.a.createElement("button",{type:"submit",name:"but",id:"but",className:"btn btn-primary",onClick:function(t){return e.validatePasswordValue(t)},title:i.a.t("login.password-button-title")},i.a.t("login.btn-ok")))}}]),n}();function ne(e){return(ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ae(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function re(e,t){return(re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function se(e){return(se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&re(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=se(e);if(t){var r=se(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===ne(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return oe(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={config:e.config,scheme:e.scheme,currentUser:e.currentUser,authResult:!1,authValidated:!1},a.validateCertificate=a.validateCertificate.bind(oe(a)),a}return function(e,t,n){t&&ae(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"validateCertificate",value:function(){var e=this;if(!this.state.authResult){var t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,value:{}};this.state.currentUser.username&&(t.username=this.state.currentUser.username),u.a.glewlwydRequest("/auth/","POST",t).then((function(){e.setState({authResult:!0,authValidated:!0},(function(){f.a.sendMessage("App",{type:"loginSuccess",loginSuccess:!0})}))})).fail((function(){e.setState({authResult:!1,authValidated:!0})}))}}},{key:"render",value:function(){var e,t=this;if(!0===this.state.authResult)e=r.a.createElement("div",{className:"alert alert-success",role:"alert"},i.a.t("login.certificate-scheme-auth-success"));else if(!1===this.state.authResult){var n;this.state.authValidated&&(n=r.a.createElement("div",{className:"alert alert-danger",role:"alert"},i.a.t("login.certificate-scheme-auth-invalid"))),e=r.a.createElement("div",null,n,r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){return t.validateCertificate()}},i.a.t("login.certificate-login-authenticate")))}return r.a.createElement("form",{action:"#",id:"certificateSchemeForm"},r.a.createElement("div",{className:"form-group"},r.a.createElement("h5",null,i.a.t("login.certificate-scheme-title"))),r.a.createElement("div",{className:"form-group"},e))}}]),n}();function ce(e){return(ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function le(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ue(e,t){return(ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fe(e){return(fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var me=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ue(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=fe(e);if(t){var r=fe(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===ce(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={config:e.config,scheme:e.scheme,currentUser:e.currentUser,providerList:[]},a.getProviderList(),a}return function(e,t,n){t&&le(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({config:e.config,scheme:e.scheme,currentUser:e.currentUser},(function(){t.getProviderList()}))}},{key:"getProviderList",value:function(){var e=this;if(this.state.scheme&&this.state.currentUser){var t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,value:{provider_list:!0}};this.state.currentUser.username?t.username=this.state.currentUser.username:t.value.action="provider_list",u.a.glewlwydRequest("/auth/scheme/trigger/","POST",t,!0).then((function(t){e.setState({providerList:t})})).fail((function(e){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("error-api-connect")})}))}}},{key:"connectProvider",value:function(e){if(this.state.scheme&&this.state.currentUser){var t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,value:{provider:e,callback_url:window.location.href}};this.state.currentUser.username?t.username=this.state.currentUser.username:t.value.action="trigger",u.a.glewlwydRequest("/auth/scheme/trigger/","POST",t,!0).then((function(e){document.location.href=e.redirect_to})).fail((function(e){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("error-api-connect")})}))}}},{key:"render",value:function(){var e=this,t=[];return this.state.providerList.forEach((function(n,a){var o;n.logo_uri?o=r.a.createElement("img",{src:n.logo_uri,alt:n.provider,className:"img-fluid logo-img"}):n.logo_fa&&(o=r.a.createElement("i",{className:n.logo_fa})),t.push(r.a.createElement("div",{key:a},r.a.createElement("hr",null),r.a.createElement("div",{className:"row"},r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(){return e.connectProvider(n.provider)}},o,r.a.createElement("span",{className:"btn-icon-right"},i.a.t("login.oauth2-connect",{provider:n.provider}))))))})),r.a.createElement("div",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("h5",null,i.a.t("login.oauth2-title"))),r.a.createElement("div",{className:"form-group"},t))}}]),n}();function pe(e){return(pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function de(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function he(e,t){return(he=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ge(e){return(ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&he(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=ge(e);if(t){var r=ge(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===pe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={config:e.config,scheme:e.scheme,currentUser:e.currentUser},a}return function(e,t,n){t&&de(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,scheme:e.scheme,currentUser:e.currentUser})}},{key:"render",value:function(){return"mock"===this.state.scheme.scheme_type?r.a.createElement(U,{config:this.state.config,scheme:this.state.scheme,currentUser:this.state.currentUser}):"email"===this.state.scheme.scheme_type?r.a.createElement(M,{config:this.state.config,scheme:this.state.scheme,currentUser:this.state.currentUser}):"webauthn"===this.state.scheme.scheme_type?r.a.createElement(I,{config:this.state.config,scheme:this.state.scheme,currentUser:this.state.currentUser}):"otp"===this.state.scheme.scheme_type?r.a.createElement(K,{config:this.state.config,scheme:this.state.scheme,currentUser:this.state.currentUser}):"retype-password"===this.state.scheme.scheme_type||"http"===this.state.scheme.scheme_type?r.a.createElement(te,{config:this.state.config,scheme:this.state.scheme,currentUser:this.state.currentUser}):"certificate"===this.state.scheme.scheme_type?r.a.createElement(ie,{config:this.state.config,scheme:this.state.scheme,currentUser:this.state.currentUser}):"oauth2"===this.state.scheme.scheme_type?r.a.createElement(me,{config:this.state.config,scheme:this.state.scheme,currentUser:this.state.currentUser}):""}}]),n}();function be(e){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ve(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function we(e,t){return(we=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ee(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Se(e){return(Se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&we(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Se(e);if(t){var r=Se(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===be(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ee(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={config:e.config,scheme:e.scheme,schemeListRequired:e.schemeListRequired,client:e.client,currentUser:e.currentUser,canContinue:!e.scheme,show:e.show},a.handleSelectScheme=a.handleSelectScheme.bind(Ee(a)),a}return function(e,t,n){t&&ve(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,scheme:e.scheme,schemeListRequired:e.schemeListRequired,client:e.client,currentUser:e.currentUser,canContinue:!e.scheme,show:e.show})}},{key:"handleSelectScheme",value:function(e,t){e.preventDefault(),this.setState({scheme:t})}},{key:"render",value:function(){var e,t=this;if(this.state.canContinue)return e=this.state.client?i.a.t("login.connect-to",{client:this.state.client.name||this.state.client.client_id}):i.a.t("login.connection"),r.a.createElement("div",null,r.a.createElement("div",{className:"row text-center"},r.a.createElement("div",{className:"col-md-12 "},r.a.createElement("h3",null,e))),r.a.createElement("hr",null),r.a.createElement("div",{className:"row text-center"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,i.a.t("login.wish-message")))));var n="",a="",o=[];this.state.scheme&&(n=r.a.createElement(ye,{config:this.state.config,scheme:this.state.scheme,currentUser:this.state.currentUser}),a=r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("hr",null)))),this.state.schemeListRequired&&this.state.schemeListRequired.forEach((function(e,n){o.push(r.a.createElement("a",{className:"dropdown-item",key:n,href:"#",onClick:function(n){return t.handleSelectScheme(n,e)}},e.scheme_display_name))}));var s=i.a.t("login.login-choose-scheme");return this.state.scheme&&(s=this.state.scheme.scheme_display_name||this.state.scheme.scheme_name),r.a.createElement("div",null,n,a,r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{className:"btn btn-primary dropdown-toggle",type:"button",id:"selectScheme","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},r.a.createElement("i",{className:"fas fa-user-lock btn-icon"}),s),r.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"selectScheme"},o)))}}]),n}();function _e(e){return(_e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ke(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Oe(e,t){return(Oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ce(e){return(Ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Oe(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Ce(e);if(t){var r=Ce(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===_e(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={config:e.config,currentUser:e.currentUser,client:e.client,scope:e.scope,authDetails:e.authDetails,scheme:e.scheme,schemeListRequired:e.schemeListRequired,showGrant:e.showGrant,infoSomeScopeUnavailable:e.infoSomeScopeUnavailable,validLogin:e.validLogin},a}return function(e,t,n){t&&ke(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,currentUser:e.currentUser,client:e.client,scope:e.scope,authDetails:e.authDetails,scheme:e.scheme,schemeListRequired:e.schemeListRequired,showGrant:e.showGrant,infoSomeScopeUnavailable:e.infoSomeScopeUnavailable,validLogin:e.validLogin})}},{key:"render",value:function(){var e,t;if(e=this.state.showGrant?r.a.createElement("div",{id:"carouselBody",className:"carousel slide","data-ride":"carousel"},r.a.createElement("div",{className:"carousel-inner"},r.a.createElement("div",{className:"carousel-item"+(this.state.showGrant?" active":"")},r.a.createElement(_,{config:this.state.config,currentUser:this.state.currentUser,client:this.state.client,scope:this.state.scope,infoSomeScopeUnavailable:this.state.infoSomeScopeUnavailable,authDetails:this.state.authDetails})))):r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement(Ne,{config:this.state.config,currentUser:this.state.currentUser,scheme:this.state.scheme,schemeListRequired:this.state.schemeListRequired,client:this.state.client}))),this.state.config.profilePicture&&this.state.currentUser[this.state.config.profilePicture.property]){var n=this.state.currentUser[this.state.config.profilePicture.property];Array.isArray(n)&&(n=n[0]),t=r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12 text-center"},r.a.createElement("img",{className:"btn-icon-right img-medium",src:"data:"+this.state.config.profilePicture.type+";base64,"+n,alt:this.state.config.profilePicture.property})))}else t=r.a.createElement("div",{className:"glwd-profile-user-picto-large"},r.a.createElement("i",{className:"fas fa-user"}));return this.state.validLogin?r.a.createElement("div",null,t,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12 text-center"},r.a.createElement("h4",null,i.a.t("login.hello",{name:this.state.currentUser.name||this.state.currentUser.username})))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("hr",null))),e):r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12 text-center"},r.a.createElement("h3",null,i.a.t("login.error-invalid-url-parameters")))))}}]),n}();function Re(e){return(Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ue(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function je(e,t){return(je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Le(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Te(e){return(Te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&je(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Te(e);if(t){var r=Te(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===Re(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Le(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={username:e.username,password:"",config:e.config,currentUser:e.currentUser,userList:e.userList},a.handleChangeUsername=a.handleChangeUsername.bind(Le(a)),a.handleChangePassword=a.handleChangePassword.bind(Le(a)),a.validateLogin=a.validateLogin.bind(Le(a)),a}return function(e,t,n){t&&Ue(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({username:e.username,password:"",config:e.config,currentUser:e.currentUser,userList:e.userList})}},{key:"handleChangeUsername",value:function(e){this.setState({username:e.target.value})}},{key:"handleChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"validateLogin",value:function(e){if(e.preventDefault(),this.state.username&&this.state.password){var t={username:this.state.username,password:this.state.password};u.a.glewlwydRequest("/auth/","POST",t).then((function(){f.a.sendMessage("App",{type:"loginSuccess"})})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.error-login")})}))}}},{key:"gotoManageUsers",value:function(){f.a.sendMessage("App",{type:"SelectAccount"})}},{key:"render",value:function(){var e,t,n=this;return e=this.state.currentUser?r.a.createElement("input",{type:"text",className:"form-control",name:"username",id:"username",disabled:!0,value:this.state.currentUser.username}):r.a.createElement("input",{type:"text",className:"form-control",name:"username",id:"username",required:"",placeholder:i.a.t("login.login-placeholder"),value:this.state.username,onChange:this.handleChangeUsername,autoFocus:!0}),this.state.userList.length>0&&(t=r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:this.gotoManageUsers},i.a.t("login.manage-users"))),r.a.createElement("form",{action:"#",id:"passwordForm"},r.a.createElement("div",{className:"form-group"},r.a.createElement("h4",null,i.a.t("login.enter-login-password"))),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("label",{className:"input-group-text",htmlFor:"username"},i.a.t("login.login"))),e)),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("label",{className:"input-group-text",htmlFor:"password"},i.a.t("login.password"))),r.a.createElement("input",{type:"password",className:"form-control",name:"password",id:"password",required:"",placeholder:i.a.t("login.password-placeholder"),value:this.state.password,onChange:this.handleChangePassword,autoFocus:!!this.state.currentUser}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-3"},r.a.createElement("button",{type:"submit",name:"loginbut",id:"loginbut",className:"btn btn-primary btn-lg btn-block",onClick:function(e){return n.validateLogin(e)},title:i.a.t("login.sign-in-title")},i.a.t("login.btn-ok"))),r.a.createElement("div",{className:"col-md-9 text-right mt-2"},t)))}}]),n}();function xe(e){return(xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Me(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function De(e,t){return(De=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ge(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qe(e){return(qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Be=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&De(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=qe(e);if(t){var r=qe(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===xe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ge(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={config:e.config,username:e.username,usernameValidated:!1,scheme:e.scheme,identify:e.identify,userList:e.userList},a.handleChangeUsername=a.handleChangeUsername.bind(Ge(a)),a.validateUsername=a.validateUsername.bind(Ge(a)),a}return function(e,t,n){t&&Me(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,username:e.username,scheme:e.scheme,identify:e.identify,userList:e.userList})}},{key:"handleChangeUsername",value:function(e){this.setState({username:e.target.value})}},{key:"validateUsername",value:function(e){e.preventDefault(),this.state.username&&this.setState({usernameValidated:!0})}},{key:"gotoManageUsers",value:function(){f.a.sendMessage("App",{type:"SelectAccount"})}},{key:"render",value:function(){var e,t=this;if(this.state.userList.length>0&&(e=r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:this.gotoManageUsers},i.a.t("login.manage-users"))),this.state.usernameValidated||this.state.identify){var n=!1;return this.state.config.sessionSchemes.forEach((function(e){e.scheme_name===t.state.scheme&&(n="mock"===e.scheme_type?r.a.createElement(U,{config:t.state.config,scheme:e,identify:t.state.identify,currentUser:{username:t.state.username}}):"email"===e.scheme_type?r.a.createElement(M,{config:t.state.config,scheme:e,currentUser:{username:t.state.username}}):"webauthn"===e.scheme_type?r.a.createElement(I,{config:t.state.config,scheme:e,currentUser:{username:t.state.username}}):"otp"===e.scheme_type?r.a.createElement(K,{config:t.state.config,scheme:e,currentUser:{username:t.state.username}}):"retype-password"===e.scheme_type||"http"===e.scheme_type?r.a.createElement(te,{config:t.state.config,scheme:e,currentUser:{username:t.state.username}}):"certificate"===e.scheme_type?r.a.createElement(ie,{config:t.state.config,scheme:e,identify:t.state.identify,currentUser:{username:t.state.username}}):"oauth2"===e.scheme_type?r.a.createElement(me,{config:t.state.config,scheme:e,identify:t.state.identify,currentUser:{username:t.state.username}}):r.a.createElement("div",null,"No can do"))})),r.a.createElement("div",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("h4",null,i.a.t("login.welcome-login",{username:this.state.username}))),r.a.createElement("div",{className:"form-group"},n),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12 text-right mt-2"},e))))}return r.a.createElement("form",{action:"#",id:"passwordForm"},r.a.createElement("div",{className:"form-group"},r.a.createElement("h4",null,i.a.t("login.enter-login"))),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("label",{className:"input-group-text",htmlFor:"username"},i.a.t("login.login"))),r.a.createElement("input",function(e,t,n){return t in e?Object.defineProperty(e,t,{value:!0,enumerable:!0,configurable:!0,writable:!0}):e[t]=!0,e}({type:"text",className:"form-control",name:"username",id:"username",autoFocus:!0,required:"",placeholder:i.a.t("login.login-placeholder"),value:this.state.username,onChange:this.handleChangeUsername},"autoFocus")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-3"},r.a.createElement("button",{type:"submit",name:"usernamebut",id:"usernamebut",className:"btn btn-primary btn-lg btn-block",onClick:function(e){return t.validateUsername(e)},title:i.a.t("login.sign-in-title")},i.a.t("login.btn-ok"))),r.a.createElement("div",{className:"col-md-9 text-right mt-2"},e)))}}]),n}();function Ve(e){return(Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ie(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Fe(e,t){return(Fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function We(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ze(e){return(ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Je=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fe(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=ze(e);if(t){var r=ze(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===Ve(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return We(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={config:e.config,userList:e.userList||[],currentUser:e.currentUser||[]},a.handleBack=a.handleBack.bind(We(a)),a.handleToggleGrantScope=a.handleToggleGrantScope.bind(We(a)),a.handleNewAccount=a.handleNewAccount.bind(We(a)),a.handleLogoutAccount=a.handleLogoutAccount.bind(We(a)),a}return function(e,t,n){t&&Ie(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,userList:e.userList||[],currentUser:e.currentUser||[]})}},{key:"handleBack",value:function(){f.a.sendMessage("App",{type:"SelectAccountComplete"})}},{key:"handleToggleGrantScope",value:function(e){var t=this;this.setState({currentUser:e},(function(){return u.a.glewlwydRequest("/auth/","POST",{username:t.state.currentUser.username}).then((function(){f.a.sendMessage("Notification",{type:"success",message:i.a.t("login.select-login",{username:t.state.currentUser.username})})})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.error-login")})}))}))}},{key:"handleNewAccount",value:function(){f.a.sendMessage("App",{type:"NewUser"})}},{key:"handleLogoutAccount",value:function(e){u.a.glewlwydRequest("/auth/?username="+e,"DELETE").then((function(){f.a.sendMessage("App",{type:"InitProfile"})})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.error-login")})}))}},{key:"handleLogoutAll",value:function(){u.a.glewlwydRequest("/auth/","DELETE").then((function(){f.a.sendMessage("App",{type:"SessionClosed"})})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.error-login")})}))}},{key:"render",value:function(){var e,t=this,n=[],a=-1;return this.state.userList.forEach((function(e,n){e.username===t.state.currentUser.username&&(a=n)})),this.state.userList.forEach((function(o,s){var c;if(o.picture){var l=o.picture;e=r.a.createElement("img",{className:"img-thumb glwd-select-user-picture",src:"data:*;base64,"+l})}else e=r.a.createElement("i",{className:"fas fa-user glwd-select-user-picto"});c=r.a.createElement("div",{className:"input-group",id:"select-user-"+o.username},r.a.createElement("label",{className:"glwd-select-user-label"},r.a.createElement("div",{className:"col input-group-prepend glwd-select-user-col"},e),r.a.createElement("input",{type:"radio",className:"input-hidden",onChange:function(){return t.handleToggleGrantScope(o)},name:"select-user"}),r.a.createElement("div",{className:"col input-group-append glwd-select-user-username"},r.a.createElement("div",{className:"col btn-icon-left glwd-select-user-username v-align-middle"},o.name||o.username),r.a.createElement("button",{type:"button",disabled:!0,className:"glwd-select-user-hidden-button"},r.a.createElement("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8z/C/HgAGgwJ/lK3Q6wAAAABJRU5ErkJggg=="}))))),n.push(r.a.createElement("li",{className:"list-group-item"+(a===s?" active":""),key:s},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col glwd-no-padding-right"},c),r.a.createElement("div",{className:"col-auto text-right glwd-no-padding-left"},r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(){return t.handleLogoutAccount(o.username)}},i.a.t("login.logout"))))))})),r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,i.a.t("login.select-acount-title")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("ul",{className:"list-group"},n))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("hr",null))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6"},r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.handleBack},i.a.t("login.back")),r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.handleNewAccount},i.a.t("login.login-another-new")))),r.a.createElement("div",{className:"col-md-6 text-right"},r.a.createElement("button",{type:"button",className:"btn btn-danger",onClick:this.handleLogoutAll},i.a.t("login.logout-all")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("hr",null))))}}]),n}();function He(e){return(He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ke(e,t){return(Ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ye(e){return(Ye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Xe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ke(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Ye(e);if(t){var r=Ye(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===He(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Qe(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={config:e.config,userList:e.userList||[],currentUser:e.currentUser||[],pluginList:e.pluginList,sessionList:!1,showEndSessionIframes:!1,endSessionIframesComplete:0,revokeSession:!1,revokeTokens:!1,logoutIgnored:!1},a.handleIgnoreLogout=a.handleIgnoreLogout.bind(Qe(a)),a.setRevokeAll=a.setRevokeAll.bind(Qe(a)),a.iframeLoaded=a.iframeLoaded.bind(Qe(a)),a.getFrontchannelLogoutUrls(),a}return function(e,t,n){t&&$e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,userList:e.userList||[],currentUser:e.currentUser||[],pluginList:e.pluginList})}},{key:"getFrontchannelLogoutUrls",value:function(){var e=this;if(this.state.config.params.sid&&this.state.config.params.plugin&&this.state.config.params.client_id){var t="";this.state.config.params.post_redirect_to&&(t="?post_redirect_to="+encodeURIComponent(this.state.config.params.post_redirect_to)),u.a.glewlwydRequestSub("/"+this.state.config.params.plugin+"/session/"+this.state.config.params.sid+"/"+this.state.config.params.client_id+t).then((function(t){e.setState({sessionList:t})})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("error-api-connect")})}))}}},{key:"handleIgnoreLogout",value:function(){this.state.sessionList.post_redirect_to?document.location=this.state.config.params.callback_url:document.location=this.state.config.ProfileUrl}},{key:"setRevokeAll",value:function(e,t,n){var a=this;e.preventDefault(),this.setState({revokeSession:t,revokeTokens:n,showEndSessionIframes:!0},(function(){a.state.sessionList.client.length?setTimeout((function(){a.state.endSessionIframesComplete!==a.state.sessionList.client.length&&a.completeRevocation()}),15e3):a.completeRevocation()}))}},{key:"iframeLoaded",value:function(e,t){var n=this;this.setState({endSessionIframesComplete:this.state.endSessionIframesComplete+1},(function(){n.state.endSessionIframesComplete===n.state.sessionList.client.length&&n.completeRevocation()}))}},{key:"completeRevocation",value:function(){var e=this;u.a.glewlwydRequestSub("/"+this.state.config.params.plugin+"/session/"+this.state.config.params.sid,"DELETE").then((function(t){return e.handleRevokeTokens().then((function(){return e.handleRevokeSession().then((function(){return u.a.glewlwydRequest("/auth/","DELETE").always((function(){e.state.sessionList.post_redirect_to?document.location=e.state.config.params.callback_url:f.a.sendMessage("App",{type:"SessionClosed"})}))}))}))})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("error-api-connect")})}))}},{key:"handleRevokeTokens",value:function(){if(this.state.revokeTokens){var e=[];return this.state.pluginList.forEach((function(t){"oauth2-glewlwyd"===t.module?e.push(u.a.glewlwydRequestSub("/"+t.name+"/profile/token/","DELETE").fail((function(){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.error-delete-session")})}))):"oidc"===t.module&&e.push(u.a.glewlwydRequestSub("/"+t.name+"/token/","DELETE").fail((function(){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.error-delete-session")})})))})),Promise.all(e)}return Promise.resolve(!0)}},{key:"handleRevokeSession",value:function(){return this.state.revokeSession?u.a.glewlwydRequest("/profile/session/","DELETE").fail((function(){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.error-delete-session")})})):Promise.resolve(!0)}},{key:"render",value:function(){var e,t,n=this,a=[];return this.state.showEndSessionIframes?(this.state.sessionList.client.forEach((function(e,t){var o=e.frontchannel_logout_uri+"?iss="+n.state.sessionList.iss;e.frontchannel_logout_session_required&&(o+="&sid="+n.state.sessionList.sid),a.push(r.a.createElement("iframe",{key:t,src:o,width:"0",height:"0",frameBorder:"0",marginHeight:"0",marginWidth:"0",onLoad:function(e){return n.iframeLoaded(e,t)}}))})),e=r.a.createElement("h4",null,i.a.t("login.end-session-message-post-redirect-ongoing"))):(e=r.a.createElement("h4",null,i.a.t("login.end-session-message-post-redirect",{client:this.state.sessionList.client_name||this.state.sessionList.client_id})),this.state.config.params.callback_url&&(t=r.a.createElement("h4",null,i.a.t("login.end-session-message-post-redirect-url")," ",this.state.config.params.callback_url))),r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h3",null,i.a.t("login.end-session-title")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},e,t,a)),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("hr",null))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{type:"button",className:"btn btn-danger",onClick:function(e){return n.setRevokeAll(e,!1,!1)}},r.a.createElement("i",{className:"fas fa-sign-out-alt btn-icon"}),i.a.t("login.logout")),r.a.createElement("div",{className:"btn-group btn-icon",role:"group"},r.a.createElement("button",{className:"btn btn-danger dropdown-toggle",type:"button",id:"logoutDropdown","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}),r.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"logoutDropdown"},r.a.createElement("a",{className:"dropdown-item",href:"#",onClick:function(e){return n.setRevokeAll(e,!0,!0)}},i.a.t("login.logout-all-sessions-tokens")),r.a.createElement("a",{className:"dropdown-item",href:"#",onClick:function(e){return n.setRevokeAll(e,!0,!1)}},i.a.t("login.logout-all-sessions")),r.a.createElement("a",{className:"dropdown-item",href:"#",onClick:function(e){return n.setRevokeAll(e,!1,!0)}},i.a.t("login.logout-all-tokens"))))),r.a.createElement("button",{type:"button",className:"btn btn-primary btn-icon-right",onClick:this.handleIgnoreLogout},i.a.t("login.ignore-logout")))))}}]),n}();function Ze(e){return(Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function et(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function tt(e,t){return(tt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function at(e){return(at=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tt(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=at(e);if(t){var r=at(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===Ze(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return nt(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={config:e.config,userList:e.userList||[],currentUser:e.currentUser||[],pluginList:e.pluginList},a.handleLogout=a.handleLogout.bind(nt(a)),a.handleIgnoreLogout=a.handleIgnoreLogout.bind(nt(a)),a}return function(e,t,n){t&&et(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,userList:e.userList||[],currentUser:e.currentUser||[],pluginList:e.pluginList})}},{key:"isCallbackUrlValid",value:function(){if(this.state.config.params.callback_url){var e=window.location.protocol+"//"+window.location.host;return this.state.config.params.callback_url.startsWith(e)}return!1}},{key:"handleLogout",value:function(){var e=this;this.state.config.params.sid&&this.state.config.params.plugin?this.setState({showEndSessionIframes:!0}):u.a.glewlwydRequest("/auth/","DELETE").fail((function(){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.error-delete-session")})})).always((function(){e.isCallbackUrlValid()?document.location.href=e.state.config.params.callback_url:f.a.sendMessage("App",{type:"SessionClosed"})}))}},{key:"revokeAll",value:function(e,t,n){var a=this;e.preventDefault();var r=[];n&&this.state.pluginList.forEach((function(e){"oauth2-glewlwyd"===e.module?r.push(u.a.glewlwydRequestSub("/"+e.name+"/profile/token/","DELETE").fail((function(){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.error-delete-session")})}))):"oidc"===e.module&&r.push(u.a.glewlwydRequestSub("/"+e.name+"/token/","DELETE").fail((function(){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.error-delete-session")})})))})),r.length?Promise.all(r).then((function(e){return t?(a.isCallbackUrlValid()?document.location.href=a.state.config.params.callback_url:f.a.sendMessage("App",{type:"SessionClosed"}),u.a.glewlwydRequest("/profile/session/","DELETE").then((function(){return u.a.glewlwydRequest("/auth/","DELETE")}))):e})).then((function(){f.a.sendMessage("Notification",{type:"info",message:i.a.t("login.logout-all-success")})})):t&&u.a.glewlwydRequest("/profile/session/","DELETE").then((function(){return u.a.glewlwydRequest("/auth/","DELETE")})).then((function(){f.a.sendMessage("Notification",{type:"info",message:i.a.t("login.logout-all-success")}),a.isCallbackUrlValid()?document.location.href=a.state.config.params.callback_url:f.a.sendMessage("App",{type:"SessionClosed"})})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.error-delete-session")})}))}},{key:"handleIgnoreLogout",value:function(){document.location.href=this.state.config.params.callback_url}},{key:"render",value:function(){var e,t,n=this;return this.isCallbackUrlValid()&&(e=r.a.createElement("button",{type:"button",className:"btn btn-primary btn-icon-right",onClick:this.handleIgnoreLogout},i.a.t("login.ignore-logout"))),t=r.a.createElement("h4",null,i.a.t("login.end-all-session-message")),r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h3",null,i.a.t("login.end-session-title")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},t)),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("hr",null))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{type:"button",className:"btn btn-danger",onClick:this.handleLogout},r.a.createElement("i",{className:"fas fa-sign-out-alt btn-icon"}),i.a.t("login.logout")),r.a.createElement("div",{className:"btn-group btn-icon",role:"group"},r.a.createElement("button",{className:"btn btn-danger dropdown-toggle",type:"button",id:"logoutDropdown","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}),r.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"logoutDropdown"},r.a.createElement("a",{className:"dropdown-item",href:"#",onClick:function(e){return n.revokeAll(e,!0,!0)}},i.a.t("login.logout-all-sessions-tokens")),r.a.createElement("a",{className:"dropdown-item",href:"#",onClick:function(e){return n.revokeAll(e,!0,!1)}},i.a.t("login.logout-all-sessions")),r.a.createElement("a",{className:"dropdown-item",href:"#",onClick:function(e){return n.revokeAll(e,!1,!0)}},i.a.t("login.logout-all-tokens"))))),e)))}}]),n}();function ot(e){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function st(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function it(e,t){return(it=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ct(e){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var lt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&it(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=ct(e);if(t){var r=ct(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===ot(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={config:e.config},a}return function(e,t,n){t&&st(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"login",value:function(){f.a.sendMessage("App",{type:"SessionReopen"})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12 text-center"},r.a.createElement("h3",null,i.a.t("login.session-closed-title")))),r.a.createElement("hr",null),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12 text-center"},r.a.createElement("h4",null,i.a.t("login.session-closed-message")))),r.a.createElement("hr",null),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12 text-center"},r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.login},i.a.t("title-login")))))}}]),n}();function ut(e){return(ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ft(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function mt(e,t){return(mt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dt(e){return(dt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ht=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mt(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=dt(e);if(t){var r=dt(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===ut(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return pt(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={config:e.config,userCode:""},a.handleValidCode=a.handleValidCode.bind(pt(a)),a.handleChangeUserCode=a.handleChangeUserCode.bind(pt(a)),a}return function(e,t,n){t&&ft(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,userCode:""})}},{key:"handleChangeUserCode",value:function(e){var t=e.target.value.replace(/[\W\s\._\-]+/g,"").toUpperCase();t.length>8&&(t=t.substring(0,8)),t.length>=4&&(t=t.substring(0,4)+"-"+t.substring(4)),this.setState({userCode:t})}},{key:"handleValidCode",value:function(){document.location=this.state.config.params.callback_url+"?code="+this.state.userCode}},{key:"render",value:function(){var e,t;return"deviceComplete"===this.state.config.params.prompt?e=r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,i.a.t("login.device-authorization-complete-message")))):"deviceServerError"===this.state.config.params.prompt?e=r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,i.a.t("login.device-authorization-server-error-message")))):"deviceCodeError"===this.state.config.params.prompt?(e=r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,i.a.t("login.device-authorization-message"))),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("label",{className:"input-group-text",htmlFor:"username"},i.a.t("login.device-auth-user-code"))),r.a.createElement("input",{type:"text",maxLength:"9",placeholder:i.a.t("login.device-auth-user-code-ph"),value:this.state.userCode,onChange:this.handleChangeUserCode})))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,i.a.t("login.device-authorization-code-error-message"))))),t=r.a.createElement("button",{type:"button",className:"btn btn-primary btn-icon",onClick:this.handleValidCode,disabled:this.state.userCode.length<9},r.a.createElement("i",{className:"fas fa-sign-out-alt btn-icon"}),i.a.t("login.btn-ok"))):(e=r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,i.a.t("login.device-authorization-message"))),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("label",{className:"input-group-text",htmlFor:"username"},i.a.t("login.device-auth-user-code"))),r.a.createElement("input",{type:"text",maxLength:"9",placeholder:i.a.t("login.device-auth-user-code-ph"),value:this.state.userCode,onChange:this.handleChangeUserCode})))),t=r.a.createElement("button",{type:"button",className:"btn btn-primary btn-icon",onClick:this.handleValidCode,disabled:this.state.userCode.length<9},r.a.createElement("i",{className:"fas fa-sign-out-alt btn-icon"}),i.a.t("login.btn-ok"))),r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h3",null,i.a.t("login.device-authorization-title")))),r.a.createElement("hr",null),e,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},t)))}}]),n}();function gt(e){return(gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function bt(e,t){return(bt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vt(e){return(vt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bt(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=vt(e);if(t){var r=vt(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===gt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={config:e.config,resetCredentials:e.resetCredentials,username:{},code:{}},a}return function(e,t,n){t&&yt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,resetCredentials:e.resetCredentials})}},{key:"sendEmail",value:function(e,t){return e.preventDefault(),u.a.glewlwydRequest("/"+t.name+"/reset-credentials-email","POST",{username:this.state.username["email-"+t.name],callback_url:encodeURIComponent(document.location.href)}).then((function(){f.a.sendMessage("App",{type:"message",title:i.a.t("login.reset-credentials-title"),label:i.a.t("login.reset-credentials-email-message-label")})})).fail((function(e){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("error-api-connect")})})),!1}},{key:"sendCode",value:function(e,t){var n=this;return e.preventDefault(),u.a.glewlwydRequest("/"+t.name+"/reset-credentials-code","POST",{username:this.state.username["code-"+t.name],code:this.state.code[t.name]}).then((function(){document.location.href=n.state.config.ProfileUrl+"?resetCredentials="+t.name+"&callback_url="+encodeURIComponent(document.location.href)})).fail((function(e){403==e.status?f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.reset-credentials-code-invalid")}):f.a.sendMessage("Notification",{type:"danger",message:i.a.t("error-api-connect")})})),!1}},{key:"changeUsername",value:function(e,t,n){var a=this.state.username;a[(n?"email-":"code-")+t]=e.target.value,this.setState({username:a})}},{key:"changeCode",value:function(e,t){var n=this.state.code;n[t]=e.target.value,this.setState({code:n})}},{key:"render",value:function(){var e=this,t=[],n=[];return this.state.resetCredentials.forEach((function(a,o){a.code&&(n.length&&n.push(r.a.createElement("div",{className:"col-12 col-md-4 text-center",key:n.length},r.a.createElement("h4",null,i.a.t("admin.or")))),n.push(r.a.createElement("div",{className:"col-12 col-md-4 card",key:n.length},r.a.createElement("div",{className:"card-body"},r.a.createElement("h5",{className:"card-title"},i.a.t("login.reset-credentials-code-title")),r.a.createElement("form",{noValidate:!0,onSubmit:function(t){return e.sendCode(t,a)}},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"username"},i.a.t("login.login")),r.a.createElement("input",{type:"text",className:"form-control",name:"username",id:"username",value:e.state.username["code-"+a.name]||"",onChange:function(t){return e.changeUsername(t,a.name,!1)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"code"},i.a.t("login.reset-credentials-code-label")),r.a.createElement("input",{type:"text",className:"form-control",name:"code",id:"code",value:e.state.code[a.name]||"",onChange:function(t){return e.changeCode(t,a.name)}})),r.a.createElement("button",{type:"submit",className:"btn btn-primary",disabled:!e.state.username["code-"+a.name]||!e.state.code[a.name]},i.a.t("login.reset-credentials-code-button"))))))),a.email&&((n.length||t.length)&&t.push(r.a.createElement("div",{className:"col-12 col-md-4 text-center",key:n.length+t.length},r.a.createElement("h4",null,i.a.t("admin.or")))),t.push(r.a.createElement("div",{className:"col-12 col-md-4 card",key:n.length+t.length},r.a.createElement("div",{className:"card-body"},r.a.createElement("h5",{className:"card-title"},i.a.t("login.reset-credentials-email-title")),r.a.createElement("form",{noValidate:!0,onSubmit:function(t){return e.sendEmail(t,a)}},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"username"},i.a.t("login.login")),r.a.createElement("input",{type:"text",className:"form-control",name:"username",id:"username",value:e.state.username["email-"+a.name]||"",onChange:function(t){return e.changeUsername(t,a.name,!0)}})),r.a.createElement("button",{type:"submit",className:"btn btn-primary",disabled:!e.state.username["email-"+a.name]},i.a.t("login.reset-credentials-email-button")))))))})),r.a.createElement("div",null,r.a.createElement("h3",null,i.a.t("login.reset-credentials-title")),r.a.createElement("hr",null),r.a.createElement("div",{className:"row d-flex justify-content-around"},n,t))}}]),n}();function Et(e){return(Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function St(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Nt(e,t){return(Nt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _t(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kt(e){return(kt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ot=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Nt(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=kt(e);if(t){var r=kt(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===Et(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _t(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={config:e.config,ciba_message:e.ciba_message},a.handleLogout=a.handleLogout.bind(_t(a)),a}return function(e,t,n){t&&St(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,ciba_message:e.ciba_message})}},{key:"handleLogout",value:function(){var e=this;u.a.glewlwydRequest("/auth/","DELETE").fail((function(){f.a.sendMessage("Notification",{type:"danger",message:i.a.t("login.error-delete-session")})})).always((function(){e.state.config.params.callback_url?document.location.href=e.state.config.params.callback_url:f.a.sendMessage("App",{type:"SessionClosed"})}))}},{key:"render",value:function(){var e;return"complete"===this.state.ciba_message?e=i.a.t("login.ciba-message-message-complete"):"invalid"===this.state.ciba_message?e=i.a.t("login.ciba-message-message-invalid"):"not_found"===this.state.ciba_message?e=i.a.t("login.ciba-message-message-not-found"):"server_error"===this.state.ciba_message?e=i.a.t("login.ciba-message-message-server-error"):"cancelled"===this.state.ciba_message&&(e=i.a.t("login.ciba-message-message-cancelled")),r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h3",null,i.a.t("login.ciba-message-title")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,e))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("hr",null))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("button",{type:"button",className:"btn btn-primary btn-icon",onClick:this.handleLogout},r.a.createElement("i",{className:"fas fa-sign-out-alt btn-icon"}),i.a.t("login.logout")))))}}]),n}(),Ct=n(9);function Pt(e){return(Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ut(e,t){return(Ut=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lt(e){return(Lt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Tt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ut(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Lt(e);if(t){var r=Lt(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===Pt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return jt(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={newUser:!1,userList:[],currentUser:!1,config:e.config,loaded:!1,lang:i.a.language,scope:[],mustRegisterScheme:!1,scheme:e.config.params.scheme,identify:a.isSchemeIdentify(e.config.params.scheme,e.config.sessionSchemes),schemeListRequired:!1,passwordRequired:!1,client:!1,showGrant:!0,showGrantAsterisk:!1,showAuthDetailsAsterisk:!1,canContinue:!1,prompt:e.config.params.prompt,refresh_login:e.config.params.refresh_login,forceShowGrant:!1,selectAccount:!1,endSession:!1,singleLogout:!1,sessionClosed:!1,deviceAuth:!1,login_hint:e.config.params.login_hint||"",ciba_message:e.config.params.ciba_message,errorScopesUnavailable:!1,infoSomeScopeUnavailable:!1,errorScheme:!1,registration:[],resetCredentials:[],resetCredentialsShow:!1,authDetails:[],pluginList:[],messageModal:{title:"",label:"",message:""}},a.initProfile=a.initProfile.bind(jt(a)),a.checkClientScope=a.checkClientScope.bind(jt(a)),a.checkScopeScheme=a.checkScopeScheme.bind(jt(a)),a.changeLang=a.changeLang.bind(jt(a)),a.parseSchemes=a.parseSchemes.bind(jt(a)),a.state.config&&a.initProfile(!0),f.a.subscribe("App",(function(e){if("InitProfile"===e.type)a.initProfile(!1);else if("loginSuccess"===e.type)a.setState({selectAccount:!1,newUser:!1,refresh_login:!1,prompt:!1,resetCredentialsShow:!1},(function(){a.initProfile(!1)}));else if("NewUser"===e.type)a.setState({selectAccount:!1,newUser:!0,currentUser:!1,scheme:a.state.config.params.scheme,identify:!1,resetCredentialsShow:!1});else if("GrantComplete"===e.type)a.setState({selectAccount:!1,showGrant:!1,prompt:!1,forceShowGrant:!1,resetCredentialsShow:!1},(function(){a.initProfile(!1)}));else if("SelectAccount"===e.type)a.setState({selectAccount:!0,newUser:!1},(function(){a.initProfile(!1)}));else if("SelectAccountComplete"===e.type)a.setState({selectAccount:!1,prompt:!1},(function(){a.initProfile(!1)}));else if("ToggleGrant"===e.type)a.setState({showGrant:!a.state.showGrant});else if("newUserScheme"===e.type)a.setState({scheme:e.scheme,identify:e.identify});else if("SessionClosed"===e.type)a.setState({endSession:!1,singleLogout:!1,sessionClosed:!0});else if("SessionReopen"===e.type)a.setState({sessionClosed:!1,newUser:!0,currentUser:!1,login_hint:""},(function(){a.initProfile(!0)}));else if("ResetCredentials"===e.type)a.setState({selectAccount:!1,newUser:!1,refresh_login:!1,prompt:!1,resetCredentialsShow:!0});else if("message"===e.type){var t=a.state.messageModal;t.title=e.title,t.label=e.label,t.message=e.message,a.setState({messageModal:t},(function(){$("#messageModal").modal({keyboard:!1,show:!0})}))}})),a}return function(e,t,n){t&&Rt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"isSchemeIdentify",value:function(e,t){if(t){var n=!1;return t.forEach((function(t){t.scheme_name===e&&(n=t.identify)})),n}return!1}},{key:"initProfile",value:function(e){var t=this;if(this.state.config.register){var n=[],a=[];this.state.config.register.forEach((function(e,r){u.a.glewlwydRequest("/"+e.name+"/config").then((function(r){r.registration&&n.push({name:e.name,message:e.message}),(r["reset-credentials"].email||r["reset-credentials"].code)&&a.push({name:e.name,message:e["reset-credentials-message"],email:r["reset-credentials"].email,code:r["reset-credentials"].code}),t.setState({registration:n,resetCredentials:a})})).fail((function(e){t.setState({registerValid:!1,registering:!1},(function(){404===e.status?f.a.sendMessage("Notification",{type:"danger",message:i.a.t("profile.register-invalid-url")}):f.a.sendMessage("Notification",{type:"danger",message:i.a.t("error-api-connect")})}))}))}))}u.a.glewlwydRequest("/profile_list").then((function(n){var a={};n.length&&(a.currentUser=n[0],a.login_hint=n[0].username,a.errorScopesUnavailable=!t.userHasScope(n[0],t.state.config.params.scope)),a.userList=n,a.loaded=!0,e&&("login"===t.state.prompt?(a.currentUser=!1,a.newUser=!0):"consent"===t.state.prompt?a.forceShowGrant=!0:"select_account"===t.state.prompt?a.selectAccount=!0:"single_logout"===t.state.prompt?(a.endSession=!1,a.singleLogout=!0,a.newUser=!1,a.currentUser=!1):"end_session"===t.state.prompt?(a.endSession=!0,a.singleLogout=!1,a.newUser=!1,a.currentUser=!1):t.state.prompt&&"device"===t.state.prompt.substring(0,6)?a.deviceAuth=!0:a.newUser=!1),t.setState(a,(function(){t.state.config.params.client_id&&t.state.config.params.scope?t.checkClientScope(t.state.config.params.client_id,t.state.config.params.scope).then((function(){t.checkAuthorizationDetails(t.state.config.params.authorization_details)})):t.state.config.params.scope?t.checkScopeScheme(t.state.config.params.scope):t.setState({showGrantAsterisk:!1}),u.a.glewlwydRequest("/profile/plugin").then((function(e){t.setState({pluginList:e})})).fail((function(e){401!=e.status&&f.a.sendMessage("Notification",{type:"warning",message:i.a.t("error-api-connect")})}))}))})).fail((function(e){401!=e.status&&f.a.sendMessage("Notification",{type:"warning",message:i.a.t("error-api-connect")}),"device"===t.state.prompt?t.setState({deviceAuth:!0,currentUser:!1,userList:[],loaded:!0,scheme:t.state.config.params.scheme}):t.setState({newUser:!!t.state.config.params.callback_url&&!!t.state.config.params.scope,showGrant:!1,currentUser:!1,userList:[],loaded:!0,scheme:t.state.config.params.scheme})}))}},{key:"checkClientScope",value:function(e,t){var n=this;return u.a.glewlwydRequest("/auth/grant/"+encodeURIComponent(e)+"/"+encodeURIComponent(t)).then((function(e){var a=[],r=!0,o=!1,s=decodeURIComponent(n.state.config.params.callback_url);if(s){var c=new URLSearchParams(s);e.client.redirect_uri=c.get("redirect_uri")}if(e.scope.length){var l=t.split(" ").length>e.scope.length;return"openid"===t?(r=n.state.forceShowGrant,a.push("openid")):e.scope.forEach((function(e){"openid"===e.name&&(e.granted=!0),e.granted?("openid"!==e.name&&(r=n.state.forceShowGrant),a.push(e.name)):o=!0})),a.length?u.a.glewlwydRequest("/auth/scheme/?scope="+encodeURIComponent(a.join(" "))).then((function(t){return n.setState({client:e.client,scope:e.scope,scheme:t,showGrant:r,showGrantAsterisk:o,infoSomeScopeUnavailable:l,errorScopesUnavailable:!1},(function(){return n.parseSchemes()}))})).fail((function(e){f.a.sendMessage("Notification",{type:"warning",message:i.a.t("login.error-scheme-scope-api")})})):n.setState({client:e.client,scope:e.scope,showGrant:!0,showGrantAsterisk:!0,errorScopesUnavailable:!1,infoSomeScopeUnavailable:l})}return n.setState({errorScopesUnavailable:!0,infoSomeScopeUnavailable:!1})})).fail((function(e){404===e.status?f.a.sendMessage("Notification",{type:"warning",message:i.a.t("login.error-scheme-scope-unavailable")}):f.a.sendMessage("Notification",{type:"warning",message:i.a.t("login.error-grant-api")})}))}},{key:"checkScopeScheme",value:function(e){var t=this;u.a.glewlwydRequest("/auth/scheme/?scope="+e).then((function(e){t.setState({scheme:e,showGrant:!1,showGrantAsterisk:!1},(function(){t.parseSchemes()}))})).fail((function(e){404===e.status?f.a.sendMessage("Notification",{type:"warning",message:i.a.t("login.error-scheme-scope-unavailable")}):f.a.sendMessage("Notification",{type:"warning",message:i.a.t("login.error-scheme-scope-api")})}))}},{key:"checkAuthorizationDetails",value:function(e){var t=this;if(e){var n=[];e.split(",").forEach((function(e){u.a.glewlwydRequest("/"+t.state.config.params.plugin+"/rar/"+t.state.config.params.client_id+"/"+e).then((function(e){if(e.scopes&&e.scopes.length){var a=!1;t.state.scope.forEach((function(t){e.scopes.indexOf(t.name)>-1&&(a=!0)})),e.enabled=a}else e.enabled=!0;n.push(e),t.setState({authDetails:n,showAuthDetailsAsterisk:!1|!e.consent})})).fail((function(e){404!==e.status&&f.a.sendMessage("Notification",{type:"warning",message:i.a.t("login.error-scheme-scope-api")})}))}))}}},{key:"parseSchemes",value:function(){var e=!!this.state.config.params.callback_url,t=!1,n=!1,a=!1,r=!1;for(var o in this.state.scheme)if(e){var s=this.state.scheme[o];if(s.available&&s.password_required&&!s.password_authenticated){e=!1,t=!0,n=!1,a=!1;break}if(!n&&e)for(var i in s.schemes){var c=s.schemes[i],l=s.scheme_required[i],u=0;if(n=c,c.forEach((function(e){r=!1,e.scheme_authenticated?u++:(!a||a.scheme_last_login<e.scheme_last_login)&&e.scheme_registered?a=e:e.scheme_registered||a||(r=!0)})),u<l){e=!1;break}n=!1}}return!t&&this.state.refresh_login&&(t=!0),e&&(a=!1),this.setState({canContinue:e,passwordRequired:t,schemeListRequired:n,scheme:a,errorScheme:!a&&!e&&!t,mustRegisterScheme:r})}},{key:"changeLang",value:function(e,t){var n=this;i.a.changeLanguage(t).then((function(){n.setState({lang:t})}))}},{key:"userHasScope",value:function(e,t){var n=!1;return t&&t.split(" ").forEach((function(t){e.scope.indexOf(t)>-1&&(n=!0)})),n}},{key:"render",value:function(){var e=this;if(this.state.config){var t,n,a,o,s="";if(this.state.loaded)if(this.state.resetCredentialsShow)s=r.a.createElement(wt,{config:this.state.config,resetCredentials:this.state.resetCredentials});else if(this.state.endSession)s=r.a.createElement(Xe,{config:this.state.config,userList:this.state.userList,currentUser:this.state.currentUser,pluginList:this.state.pluginList});else if(this.state.singleLogout)s=r.a.createElement(rt,{config:this.state.config,userList:this.state.userList,currentUser:this.state.currentUser,pluginList:this.state.pluginList});else if(this.state.sessionClosed)s=r.a.createElement(lt,{config:this.state.config});else if(this.state.deviceAuth)s=r.a.createElement(ht,{config:this.state.config,userList:this.state.userList,currentUser:this.state.currentUser});else if(this.state.ciba_message)s=r.a.createElement(Ot,{config:this.state.config,ciba_message:this.state.ciba_message});else{if(this.state.mustRegisterScheme&&!this.state.errorScopesUnavailable)t=r.a.createElement("div",{className:"alert alert-warning",role:"alert"},i.a.t("login.warning-not-registered-scheme"));else if(this.state.errorScheme&&!this.state.errorScopesUnavailable)t=r.a.createElement("div",{className:"alert alert-warning",role:"alert"},i.a.t("login.warning-error-scheme"));else{var c,l;this.state.config.params.callback_url||(c=r.a.createElement("div",{className:"alert alert-warning",role:"alert"},i.a.t("login.warning-no-callback-url"))),this.state.config.params.scope||(l=r.a.createElement("div",{className:"alert alert-warning",role:"alert"},i.a.t("login.warning-no-scope"))),t=r.a.createElement("div",null,c,l)}this.state.config.params.ciba_binding_message&&(n=r.a.createElement("div",{className:"alert alert-info",role:"alert"},this.state.config.params.ciba_binding_message)),this.state.config.params.ciba_login_hint&&this.state.config.params.login_hint!==this.state.currentUser.username&&(a=r.a.createElement("div",{className:"alert alert-success",role:"alert"},i.a.t("login.ciba-login-hint",{username:this.state.config.params.login_hint}))),this.state.newUser||this.state.passwordRequired?s=this.state.scheme?r.a.createElement(Be,{config:this.state.config,username:this.state.login_hint,userList:this.state.userList,callbackInitProfile:this.initProfile,identify:this.state.identify,scheme:this.state.scheme}):r.a.createElement(Ae,{config:this.state.config,username:this.state.login_hint,currentUser:this.state.currentUser,userList:this.state.userList,callbackInitProfile:this.initProfile}):this.state.selectAccount?s=r.a.createElement(Je,{config:this.state.config,userList:this.state.userList,currentUser:this.state.currentUser}):(s=r.a.createElement(Pe,{config:this.state.config,currentUser:this.state.currentUser,client:this.state.client,scope:this.state.scope,scheme:this.state.scheme,schemeListRequired:this.state.schemeListRequired,showGrant:this.state.showGrant,infoSomeScopeUnavailable:this.state.infoSomeScopeUnavailable,validLogin:!!this.state.config.params.callback_url&&!!this.state.config.params.scope,authDetails:this.state.authDetails}),this.state.errorScopesUnavailable&&(o=r.a.createElement("div",{className:"alert alert-danger",role:"alert"},i.a.t("login.error-scope-unavailable"))))}var u=[];return this.state.config.lang.forEach((function(t,n){t===i.a.language?u.push(r.a.createElement("a",{className:"dropdown-item active",href:"#",key:n},t)):u.push(r.a.createElement("a",{className:"dropdown-item",href:"#",onClick:function(n){return e.changeLang(n,t)},key:n},t))})),r.a.createElement("div",{"aria-live":"polite","aria-atomic":"true",className:"glwd-container"},r.a.createElement("div",{className:"card center glwd-card",id:"userCard",tabIndex:"-1",role:"dialog"},r.a.createElement("div",{className:"card-header"},r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light"},r.a.createElement("a",{className:"navbar-brand",href:"#","data-toggle":"collapse"},r.a.createElement("img",{className:"mr-3",src:"img/logo-login.png",alt:"logo"}),i.a.t("login.menu-title")),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent"},r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{className:"btn btn-secondary dropdown-toggle",type:"button",id:"dropdownLang","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},r.a.createElement("i",{className:"fas fa-language"})),r.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"dropdownLang"},u))))),n,a,t,r.a.createElement("div",{className:"card-body"},o,s),r.a.createElement("div",{className:"card-footer"},r.a.createElement(b,{config:this.state.config,currentUser:this.state.currentUser,userList:this.state.userList,client:this.state.client,showGrant:this.state.showGrant,showGrantAsterisk:this.state.showGrantAsterisk||this.state.showAuthDetailsAsterisk,newUser:this.state.newUser,newUserScheme:this.state.scheme,canContinue:this.state.canContinue&&!this.state.errorScopesUnavailable,schemeListRequired:this.state.schemeListRequired,selectAccount:this.state.selectAccount,registration:this.state.registration,resetCredentials:this.state.resetCredentials,resetCredentialsShow:this.state.resetCredentialsShow,pluginList:this.state.pluginList,sessionClosed:this.state.sessionClosed}))),r.a.createElement(m.a,{loggedIn:!0}),r.a.createElement(Ct.a,{title:this.state.messageModal.title,label:this.state.messageModal.label,message:this.state.messageModal.message}))}return r.a.createElement("div",{"aria-live":"polite","aria-atomic":"true",className:"glwd-container"},r.a.createElement("div",{className:"card center glwd-card",id:"userCard",tabIndex:"-1",role:"dialog"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h4",null,r.a.createElement("span",{className:"badge badge-danger"},i.a.t("error-api-connect"))))))}}]),n}(),At=n(8),xt=new URLSearchParams(window.location.search),Mt={fallbackLng:"en",ns:["translations"],defaultNS:"translations",backend:{loadPath:"locales/{{lng}}/{{ns}}.json"}};xt.get("ui_locales")&&(Mt.lng=xt.get("ui_locales").split(" ")[0]);try{i.a.use(c.a).use(l.a).init(Mt).then((function(){u.a.request("config.json").then((function(e){e.lang||(e.lang=["en","fr","nl","de"]),u.a.request(e.GlewlwydUrl+"config/").then((function(t){u.a.setConfig(e.GlewlwydUrl+t.api_prefix),u.a.setConfigSub(e.GlewlwydUrl+t.api_prefix);var n=Object.assign({params:{scope:xt.get("scope")||!1,client_id:xt.get("client_id")||!1,callback_url:xt.get("callback_url")||!1,scheme:xt.get("scheme")||e.defaultScheme||!1,prompt:xt.get("prompt")||!1,refresh_login:!!xt.get("refresh_login"),login_hint:xt.get("login_hint")||!1,authorization_details:xt.get("authorization_details")||!1,plugin:xt.get("plugin")||!1,ciba_message:xt.get("ciba_message")||!1,ciba_binding_message:xt.get("ciba_binding_message")||!1,ciba_login_hint:xt.get("ciba_login_hint")||!1,sid:xt.get("sid")||!1,post_redirect_to:xt.get("post_redirect_to")||!1}},e,t);s.a.render(r.a.createElement(Tt,{config:n}),document.getElementById("root"))})).fail((function(e){s.a.render(r.a.createElement(Tt,{config:!1}),document.getElementById("root"))}))})).fail((function(e){s.a.render(r.a.createElement(At.a,null),document.getElementById("root"))}))}))}catch(e){$("#root").html('<div class="alert alert-danger" role="alert"><i class="fas fa-exclamation-triangle"></i><span class="btn-icon-right">You must use a browser compatible with Glewlwyd SSO</span></div>')}},3:function(e,t,n){"use strict";var a=n(2);function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var o=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.GlewlwydApiPrefix="",this.GlewlwydApiPrefixSub=""}return function(e,t,n){t&&r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"setConfig",value:function(e){this.GlewlwydApiPrefix=e}},{key:"getConfig",value:function(e){return this.GlewlwydApiPrefix}},{key:"setConfigSub",value:function(e){this.GlewlwydApiPrefixSub=e}},{key:"getConfigSub",value:function(e){return this.GlewlwydApiPrefixSub}},{key:"request",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n&&"GET"!==t?$.ajax({method:t,url:e,data:JSON.stringify(n),contentType:"application/json; charset=utf-8"}):$.ajax({method:t,url:e})}},{key:"glewlwydRequest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.request(this.GlewlwydApiPrefix+e,t,n).fail((function(e){r&&401===e.status&&a.a.sendMessage("App",{type:"loggedIn",loggedIn:!1})}))}},{key:"glewlwydRequestSub",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.request(this.GlewlwydApiPrefixSub+e,t,n)}}]),e}());t.a=o},4:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(2);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=u(e);if(t){var r=u(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return l(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={message:[],counter:0,loggedIn:e.loggedIn},o.a.subscribe("Notification",(function(e){if(e.type){var t=a.state.message;t.push({type:e.type,message:e.message,id:a.state.counter}),a.setState({message:t,counter:a.state.counter+1},(function(){a.timeoutClose(a.state.counter-1)}))}})),a.close=a.close.bind(l(a)),a.timeoutClose=a.timeoutClose.bind(l(a)),a}return function(e,t,n){t&&i(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({loggedIn:e.loggedIn})}},{key:"timeoutClose",value:function(e){var t=this;setTimeout((function(){t.close(e)}),5e3)}},{key:"close",value:function(e){var t=this,n=this.state.message;n.forEach((function(a,r){a.id===e&&(n.splice(r,1),t.setState({message:n}))}))}},{key:"render",value:function(){var e=this,t=[],n=this.state.loggedIn;return this.state.message.forEach((function(e){"danger"!==e.type&&"warning"!==e.type||(n=!0)})),n&&this.state.message.forEach((function(n,a){var o;o="success"===n.type?r.a.createElement("strong",{className:"mr-auto"},r.a.createElement("span",{className:"badge badge-success btn-icon"},r.a.createElement("i",{className:"fas fa-check-circle"})),"Glewlwyd"):"danger"===n.type?r.a.createElement("strong",{className:"mr-auto"},r.a.createElement("span",{className:"badge badge-danger btn-icon"},r.a.createElement("i",{className:"fas fa-exclamation-circle"})),"Glewlwyd"):"warning"===n.type?r.a.createElement("strong",{className:"mr-auto"},r.a.createElement("span",{className:"badge badge-warning btn-icon"},r.a.createElement("i",{className:"fas fa-exclamation-circle"})),"Glewlwyd"):r.a.createElement("strong",{className:"mr-auto"},r.a.createElement("span",{className:"badge badge-info btn-icon"},r.a.createElement("i",{className:"fas fa-info-circle"})),"Glewlwyd"),t.push(r.a.createElement("div",{className:"toast-container",style:{top:95+90*a,right:5},key:a},r.a.createElement("div",{className:"toast glwd-toast",role:"alert","aria-live":"assertive","aria-atomic":"true"},r.a.createElement("div",{className:"toast-header"},o,r.a.createElement("button",{type:"button",className:"ml-2 mb-1 close","data-dismiss":"toast","aria-label":"Close",onClick:function(){return e.close(n.id)}},r.a.createElement("span",{"aria-hidden":"true"},""))),r.a.createElement("div",{className:"toast-body"},n.message))))})),r.a.createElement("div",null,t)}}]),n}();t.a=f},8:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(1);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=l(e);if(t){var r=l(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}(n);function n(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this,e)}return function(e,t,n){t&&i(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"render",value:function(){return r.a.createElement("div",{className:"alert alert-danger perfect-centering",role:"alert"},o.a.t("error-config"))}}]),n}();t.a=u},9:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(1);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(n,a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=u(e);if(t){var r=u(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return l(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={title:e.title,label:e.label,message:e.message},a.closeModal=a.closeModal.bind(l(a)),a}return function(e,t,n){t&&i(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({title:e.title,label:e.label,message:e.message})}},{key:"closeModal",value:function(e,t){$("#messageModal").modal("hide")}},{key:"render",value:function(){var e,t=this,n=[];return this.state.label&&(e=r.a.createElement("h5",null,this.state.label)),this.state.message&&this.state.message.forEach((function(e,t){n.push(r.a.createElement("li",{key:t},e))})),r.a.createElement("div",{className:"modal fade on-top",id:"messageModal",tabIndex:"-1",role:"dialog","aria-labelledby":"messageModalLabel","aria-hidden":"true"},r.a.createElement("div",{className:"modal-dialog",role:"document"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title",id:"messageModalLabel"},this.state.title),r.a.createElement("button",{type:"button",className:"close","aria-label":o.a.t("modal.close"),onClick:function(e){return t.closeModal(e,!1)}},r.a.createElement("span",{"aria-hidden":"true"},""))),r.a.createElement("div",{className:"modal-body"},e,r.a.createElement("ul",null,n)),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(e){return t.closeModal(e,!1)}},o.a.t("modal.close"))))))}}]),n}();t.a=f}})}));