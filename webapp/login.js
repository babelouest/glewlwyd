!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var a=t();for(var n in a)("object"==typeof exports?exports:e)[n]=a[n]}}(window,(function(){return function(e){function t(t){for(var n,l,o=t[0],i=t[1],c=t[2],f=0,d=[];f<o.length;f++)l=o[f],Object.prototype.hasOwnProperty.call(r,l)&&r[l]&&d.push(r[l][0]),r[l]=0;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n]);for(u&&u(t);d.length;)d.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],n=!0,o=1;o<a.length;o++){var i=a[o];0!==r[i]&&(n=!1)}n&&(s.splice(t--,1),e=l(l.s=a[0]))}return e}var n={},r={3:0},s=[];function l(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.m=e,l.c=n,l.d=function(e,t,a){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)l.d(a,n,function(t){return e[t]}.bind(null,n));return a},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="";var o=window.webpackJsonp=window.webpackJsonp||[],i=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=i;return s.push([63,0]),a()}([,,function(e,t,a){"use strict";function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.subscriberList={}}Object.defineProperty(t,"__esModule",{value:!0});var s=new(function(e,t,a){t&&n(e.prototype,t)}(r,[{key:"subscribe",value:function(e,t){this.subscriberList[e]=t}},{key:"sendMessage",value:function(e,t){if(Array.isArray(e)||(e=[e]),"broadcast"===e[0])this.subscriberList.forEach((function(e,a){e({type:"broadcast",message:t})}));else for(var a in this.subscriberList)0<=e.indexOf(a)&&this.subscriberList[a](t)}}]),r);t.default=s},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r,s=(r=a(2))&&r.__esModule?r:{default:r};function l(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),this.GlewlwydApiPrefix="",this.GlewlwydApiPrefixSub=""}var o=new(function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(l,[{key:"setConfig",value:function(e){this.GlewlwydApiPrefix=e}},{key:"getConfig",value:function(e){return this.GlewlwydApiPrefix}},{key:"setConfigSub",value:function(e){this.GlewlwydApiPrefixSub=e}},{key:"getConfigSub",value:function(e){return this.GlewlwydApiPrefixSub}},{key:"request",value:function(e,t,a){var n=1<arguments.length&&void 0!==t?t:"GET",r=2<arguments.length&&void 0!==a&&a;return r&&"GET"!==n?$.ajax({method:n,url:e,data:JSON.stringify(r),contentType:"application/json; charset=utf-8"}):$.ajax({method:n,url:e})}},{key:"glewlwydRequest",value:function(e,t,a,n){var r=1<arguments.length&&void 0!==t?t:"GET",l=2<arguments.length&&void 0!==a&&a,o=3<arguments.length&&void 0!==n&&n;return this.request(this.GlewlwydApiPrefix+e,r,l).fail((function(e){o&&401===e.status&&s.default.sendMessage("App",{type:"loggedIn",message:!1})}))}},{key:"glewlwydRequestSub",value:function(e,t,a){var n=1<arguments.length&&void 0!==t?t:"GET",r=2<arguments.length&&void 0!==a&&a;return this.request(this.GlewlwydApiPrefixSub+e,n,r)}}]),l);t.default=o},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=a(0),s=o(r),l=o(a(2));function o(e){return e&&e.__esModule?e:{default:e}}var i=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,r.Component),function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(c,[{key:"timeoutClose",value:function(e){var t=this;setTimeout((function(){t.close(e)}),5e3)}},{key:"close",value:function(e){var t=this,a=this.state.message;a.forEach((function(n,r){n.id===e&&(a.splice(r,1),t.setState({message:a}))}))}},{key:"render",value:function(){var e=this,t=[];return this.state.message.forEach((function(a,n){var r;r="success"===a.type?s.default.createElement("strong",{className:"mr-auto"},s.default.createElement("span",{className:"badge badge-success btn-icon"},s.default.createElement("i",{className:"fas fa-check-circle"})),"Glewlwyd"):"danger"===a.type?s.default.createElement("strong",{className:"mr-auto"},s.default.createElement("span",{className:"badge badge-danger btn-icon"},s.default.createElement("i",{className:"fas fa-exclamation-circle"})),"Glewlwyd"):"warning"===a.type?s.default.createElement("strong",{className:"mr-auto"},s.default.createElement("span",{className:"badge badge-warning btn-icon"},s.default.createElement("i",{className:"fas fa-exclamation-circle"})),"Glewlwyd"):s.default.createElement("strong",{className:"mr-auto"},s.default.createElement("span",{className:"badge badge-info btn-icon"},s.default.createElement("i",{className:"fas fa-info-circle"})),"Glewlwyd"),t.push(s.default.createElement("div",{className:"toast-container",style:{top:85+90*n,right:5},key:n},s.default.createElement("div",{className:"toast",role:"alert","aria-live":"assertive","aria-atomic":"true"},s.default.createElement("div",{className:"toast-header"},r,s.default.createElement("button",{type:"button",className:"ml-2 mb-1 close","data-dismiss":"toast","aria-label":"Close",onClick:function(){return e.close(a.id)}},s.default.createElement("span",{"aria-hidden":"true"},"Ã—"))),s.default.createElement("div",{className:"toast-body"},a.message))))})),s.default.createElement("div",null,t)}}]),c);function c(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,e));return t.state={message:[],counter:0},l.default.subscribe("Notification",(function(e){if(e.type){var a=t.state.message;a.push({type:e.type,message:e.message,id:t.state.counter}),t.setState({message:a,counter:t.state.counter+1},(function(){t.timeoutClose(t.state.counter-1)}))}})),t.close=t.close.bind(t),t.timeoutClose=t.timeoutClose.bind(t),t}t.default=i},,,,,,,,,,,function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=a(0),s=c(r),l=c(a(1)),o=c(a(3)),i=c(a(2));function c(e){return e&&e.__esModule?e:{default:e}}var u=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,r.Component),function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(f,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({config:e.config,scheme:e.scheme,currentUser:e.currentUser,triggerResult:!1,mockValue:""},(function(){t.triggerScheme()}))}},{key:"triggerScheme",value:function(){var e=this;if(this.state.scheme&&this.state.currentUser){var t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{description:"This is a mock trigger"}};o.default.glewlwydRequest("/auth/scheme/trigger/","POST",t,!0).then((function(t){e.setState({triggerResult:t.code})})).fail((function(e){401===e.status?i.default.sendMessage("Notification",{type:"info",message:l.default.t("login.mock-trigger-must-register")}):i.default.sendMessage("Notification",{type:"danger",message:l.default.t("login.error-mock-trigger")})}))}}},{key:"handleChangeMockValue",value:function(e){this.setState({mockValue:e.target.value})}},{key:"validateMockValue",value:function(e){e.preventDefault();var t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{code:this.state.mockValue}};o.default.glewlwydRequest("/auth/","POST",t).then((function(){i.default.sendMessage("App",{type:"loginSuccess",loginSuccess:!0})})).fail((function(){i.default.sendMessage("Notification",{type:"danger",message:l.default.t("login.error-mock-value")})}))}},{key:"render",value:function(){var e=this;return this.state.triggerResult?s.default.createElement("form",{action:"#",id:"mockSchemeForm"},s.default.createElement("div",{className:"form-group"},s.default.createElement("h5",null,l.default.t("login.enter-mock-scheme-value"))),s.default.createElement("div",{className:"form-group"},s.default.createElement("div",{className:"input-group mb-3"},s.default.createElement("div",{className:"input-group-prepend"},s.default.createElement("label",{className:"input-group-text",htmlFor:"mockValue"},l.default.t("login.mock-value-label"))),s.default.createElement("input",{type:"text",className:"form-control",name:"mockValue",id:"mockValue",autoFocus:!0,required:"",placeholder:l.default.t("login.error-mock-expected",{value:this.state.triggerResult}),value:this.state.mockValue||"",onChange:this.handleChangeMockValue,autoComplete:"false"}))),s.default.createElement("button",{type:"submit",name:"mockbut",id:"mockbut",className:"btn btn-primary",onClick:function(t){return e.validateMockValue(t)},title:l.default.t("login.mock-value-button-title")},l.default.t("login.btn-ok"))):s.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.triggerScheme},l.default.t("login.btn-reload"))}}]),f);function f(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,e));return t.state={config:e.config,scheme:e.scheme,currentUser:e.currentUser,triggerResult:!1,mockValue:""},t.triggerScheme=t.triggerScheme.bind(t),t.validateMockValue=t.validateMockValue.bind(t),t.handleChangeMockValue=t.handleChangeMockValue.bind(t),t.triggerScheme(),t}t.default=u},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=a(0),s=c(r),l=c(a(1)),o=c(a(3)),i=c(a(2));function c(e){return e&&e.__esModule?e:{default:e}}var u=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,r.Component),function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(f,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,scheme:e.scheme,currentUser:e.currentUser,code:"",showValidate:!1})}},{key:"triggerScheme",value:function(e){var t=this;if(e.preventDefault(),this.state.scheme&&this.state.currentUser){var a={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{}};o.default.glewlwydRequest("/auth/scheme/trigger/","POST",a).then((function(e){i.default.sendMessage("Notification",{type:"info",message:l.default.t("login.mail-trigger-ok")}),t.setState({showValidate:!0})})).fail((function(e){i.default.sendMessage("Notification",{type:"danger",message:l.default.t("login.mail-trigger-error")})}))}}},{key:"handleChangeCode",value:function(e){this.setState({code:e.target.value})}},{key:"validateCode",value:function(e){e.preventDefault();var t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{code:this.state.code}};o.default.glewlwydRequest("/auth/","POST",t,!0).then((function(){i.default.sendMessage("App",{type:"loginSuccess"})})).fail((function(e){401===e.status?i.default.sendMessage("Notification",{type:"danger",message:l.default.t("login.mail-code-invalid")}):i.default.sendMessage("Notification",{type:"danger",message:l.default.t("login.mail-code-error")})}))}},{key:"render",value:function(){var e,t,a=this;return this.state.showValidate&&(e=s.default.createElement("button",{type:"submit",name:"mailbut",id:"mailbut",className:"btn btn-primary",onClick:function(e){return a.validateCode(e)},title:l.default.t("login.mail-code-button-title")},l.default.t("login.btn-ok")),t=s.default.createElement("input",{type:"text",className:"form-control",name:"code",id:"code",autoFocus:!0,required:"",placeholder:l.default.t("login.mail-code-ph"),value:this.state.code||"",onChange:this.handleChangeCode,autoComplete:"false"})),s.default.createElement("form",{action:"#",id:"mailSchemeForm",onSubmit:function(e){return a.validateCode(e)}},s.default.createElement("div",{className:"form-group"},s.default.createElement("h5",null,l.default.t("login.mail-enter-scheme-code"))),s.default.createElement("div",{className:"form-group"},s.default.createElement("div",{className:"input-group mb-3"},s.default.createElement("div",{className:"input-group-prepend"},s.default.createElement("label",{className:"input-group-text",htmlFor:"code"},l.default.t("login.mail-code-label"))),t)),s.default.createElement("div",{className:"btn-group",role:"group"},e,s.default.createElement("button",{type:"button",name:"triggerbut",id:"triggerbut",className:"btn btn-primary",onClick:this.triggerScheme,title:l.default.t("login.mail-trigger-button-title")},l.default.t("login.mail-scheme-trigger"))))}}]),f);function f(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,e));return t.state={config:e.config,scheme:e.scheme,currentUser:e.currentUser,code:"",showValidate:!1},t.triggerScheme=t.triggerScheme.bind(t),t.validateCode=t.validateCode.bind(t),t.handleChangeCode=t.handleChangeCode.bind(t),t}t.default=u},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=a(0),s=c(r),l=c(a(1)),o=c(a(3)),i=c(a(2));function c(e){return e&&e.__esModule?e:{default:e}}var u=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,r.Component),function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(f,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({config:e.config,scheme:e.scheme,currentUser:e.currentUser},(function(){t.triggerScheme()}))}},{key:"strToBin",value:function(e){return Uint8Array.from(atob(e),(function(e){return e.charCodeAt(0)}))}},{key:"binToStr",value:function(e){return btoa(new Uint8Array(e).reduce((function(e,t){return e+String.fromCharCode(t)}),""))}},{key:"login",value:function(e){var t=this;o.default.glewlwydRequest("/auth/scheme/trigger/","POST",{username:this.state.currentUser.username,scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,value:{}}).then((function(e){var a=[];e.allowCredentials.forEach((function(e){a.push({id:t.strToBin(e.credential_id),type:"public-key"})}));var n={allowCredentials:a,challenge:t.strToBin(e.challenge)};navigator.credentials.get({publicKey:n}).then((function(a){var n={};"id"in a&&(n.id=a.id),"type"in a&&(n.type=a.type),"rawId"in a&&(n.rawId=t.binToStr(a.rawId)),n.response={clientDataJSON:t.binToStr(a.response.clientDataJSON),authenticatorData:t.binToStr(a.response.authenticatorData),signature:t.binToStr(a.response.signature),userHandle:t.binToStr(a.response.userHandle)},a.response.getTransports&&(response.transports=a.response.getTransports()),o.default.glewlwydRequest("/auth/","POST",{username:t.state.currentUser.username,scheme_type:t.state.scheme.scheme_type,scheme_name:t.state.scheme.scheme_name,value:{session:e.session,credential:n}}).then((function(){i.default.sendMessage("App",{type:"loginSuccess"}),i.default.sendMessage("Notification",{type:"info",message:l.default.t("profile.scheme-webauthn-assertion-success")})})).fail((function(e){401===e.status?i.default.sendMessage("Notification",{type:"danger",message:l.default.t("profile.scheme-webauthn-assertion-error")}):i.default.sendMessage("Notification",{type:"danger",message:l.default.t("error-api-connect")})}))})).catch((function(e){i.default.sendMessage("Notification",{type:"danger",message:l.default.t("profile.scheme-webauthn-error-assertion")})}))})).fail((function(e){i.default.sendMessage("Notification",{type:"danger",message:l.default.t("error-api-connect")})}))}},{key:"triggerScheme",value:function(){var e=this;if(this.state.scheme&&this.state.currentUser){var t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{}};o.default.glewlwydRequest("/auth/scheme/trigger/","POST",t).then((function(t){e.setState({canLogin:!0})})).fail((function(t){e.setState({canLogin:!1},(function(){401===t.status?i.default.sendMessage("Notification",{type:"info",message:l.default.t("login.webauthn-trigger-must-register")}):i.default.sendMessage("Notification",{type:"danger",message:l.default.t("login.webauthn-error-trigger")})}))}))}}},{key:"render",value:function(){var e,t=this;return this.state.webauthnEnabled||(e=s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"col-md-12"},s.default.createElement("div",{className:"alert alert-danger",role:"alert"},l.default.t("profile.scheme-webauthn-disabled"))))),s.default.createElement("div",null,s.default.createElement("div",{className:"form-group"},s.default.createElement("h5",null,l.default.t("login.webauthn-login-title"))),s.default.createElement("div",{className:"form-group"},e),s.default.createElement("button",{type:"button",name:"loginBut",id:"loginBut",disabled:!this.state.canLogin||!this.state.webauthnEnabled,className:"btn btn-primary",onClick:function(e){return t.login(e)},title:l.default.t("login.webauthn-login-button-title")},l.default.t("login.webauthn-login-authenticate")))}}]),f);function f(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,e));return t.state={config:e.config,scheme:e.scheme,currentUser:e.currentUser,canLogin:!1,webauthnEnabled:!!window.PublicKeyCredential},t.triggerScheme=t.triggerScheme.bind(t),t.login=t.login.bind(t),t.triggerScheme(),t}t.default=u},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=a(0),s=c(r),l=c(a(1)),o=c(a(3)),i=c(a(2));function c(e){return e&&e.__esModule?e:{default:e}}var u=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,r.Component),function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(f,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,scheme:e.scheme,currentUser:e.currentUser})}},{key:"handleChangeOTPValue",value:function(e){this.setState({value:e.target.value})}},{key:"validateOTPValue",value:function(e){e.preventDefault();var t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{value:this.state.value}};o.default.glewlwydRequest("/auth/","POST",t).then((function(){i.default.sendMessage("Notification",{type:"info",message:l.default.t("login.success-login")}),i.default.sendMessage("App",{type:"loginSuccess"})})).fail((function(){i.default.sendMessage("Notification",{type:"danger",message:l.default.t("login.error-login")})}))}},{key:"render",value:function(){var e=this;return s.default.createElement("form",{action:"#",id:"otpSchemeForm"},s.default.createElement("div",{className:"form-group"},s.default.createElement("h5",null,l.default.t("login.otp-enter-value"))),s.default.createElement("div",{className:"form-group"},s.default.createElement("div",{className:"input-group mb-3"},s.default.createElement("div",{className:"input-group-prepend"},s.default.createElement("label",{className:"input-group-text",htmlFor:"value"},l.default.t("login.otp-value-label"))),s.default.createElement("input",{type:"text",className:"form-control",name:"value",id:"value",required:"",placeholder:l.default.t("login.error-value-expected",{value:this.state.triggerResult}),value:this.state.value||"",onChange:this.handleChangeOTPValue,autoFocus:!0,autoComplete:"false"}))),s.default.createElement("button",{type:"submit",name:"but",id:"but",className:"btn btn-primary",onClick:function(t){return e.validateOTPValue(t)},title:l.default.t("login.otp-button-title")},l.default.t("login.btn-ok")))}}]),f);function f(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,e));return t.state={config:e.config,scheme:e.scheme,currentUser:e.currentUser,value:""},t.validateOTPValue=t.validateOTPValue.bind(t),t.handleChangeOTPValue=t.handleChangeOTPValue.bind(t),t}t.default=u},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=a(0),s=c(r),l=c(a(1)),o=c(a(3)),i=c(a(2));function c(e){return e&&e.__esModule?e:{default:e}}var u=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,r.Component),function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(f,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,scheme:e.scheme,currentUser:e.currentUser})}},{key:"handleChangePasswordValue",value:function(e){this.setState({value:e.target.value})}},{key:"validatePasswordValue",value:function(e){e.preventDefault();var t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{password:this.state.value}};o.default.glewlwydRequest("/auth/","POST",t).then((function(){i.default.sendMessage("Notification",{type:"info",message:l.default.t("login.success-login")}),i.default.sendMessage("App",{type:"loginSuccess"})})).fail((function(){i.default.sendMessage("Notification",{type:"danger",message:l.default.t("login.error-login")})}))}},{key:"render",value:function(){var e=this;return s.default.createElement("form",{action:"#",id:"otpSchemeForm"},s.default.createElement("div",{className:"form-group"},s.default.createElement("h5",null,l.default.t("login.password-enter-value"))),s.default.createElement("div",{className:"form-group"},s.default.createElement("div",{className:"input-group mb-3"},s.default.createElement("div",{className:"input-group-prepend"},s.default.createElement("label",{className:"input-group-text",htmlFor:"value"},l.default.t("login.password-value-label"))),s.default.createElement("input",{type:"password",className:"form-control",name:"value",id:"value",required:"",placeholder:l.default.t("login.error-value-expected",{value:this.state.triggerResult}),value:this.state.value||"",onChange:this.handleChangePasswordValue,autoFocus:!0}))),s.default.createElement("button",{type:"submit",name:"but",id:"but",className:"btn btn-primary",onClick:function(t){return e.validatePasswordValue(t)},title:l.default.t("login.password-button-title")},l.default.t("login.btn-ok")))}}]),f);function f(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,e));return t.state={config:e.config,scheme:e.scheme,currentUser:e.currentUser,value:""},t.validatePasswordValue=t.validatePasswordValue.bind(t),t.handleChangePasswordValue=t.handleChangePasswordValue.bind(t),t}t.default=u},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=a(0),s=c(r),l=c(a(1)),o=c(a(3)),i=c(a(2));function c(e){return e&&e.__esModule?e:{default:e}}var u=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,r.Component),function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(f,[{key:"validateCertificate",value:function(){var e=this;if(!this.state.authResult){var t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{}};o.default.glewlwydRequest("/auth/","POST",t).then((function(){e.setState({authResult:!0,authValidated:!0},(function(){i.default.sendMessage("App",{type:"loginSuccess",loginSuccess:!0})}))})).fail((function(){e.setState({authResult:!1,authValidated:!0})}))}}},{key:"render",value:function(){var e,t=this;if(!0===this.state.authResult)e=s.default.createElement("div",{className:"alert alert-success",role:"alert"},l.default.t("login.certificate-scheme-auth-success"));else if(!1===this.state.authResult){var a;this.state.authValidated&&(a=s.default.createElement("div",{className:"alert alert-danger",role:"alert"},l.default.t("login.certificate-scheme-auth-invalid"))),e=s.default.createElement("div",null,a,s.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){return t.validateCertificate()}},l.default.t("login.certificate-login-authenticate")))}return s.default.createElement("form",{action:"#",id:"certificateSchemeForm"},s.default.createElement("div",{className:"form-group"},s.default.createElement("h5",null,l.default.t("login.certificate-scheme-title"))),s.default.createElement("div",{className:"form-group"},e))}}]),f);function f(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,e));return t.state={config:e.config,scheme:e.scheme,currentUser:e.currentUser,authResult:!1,authValidated:!1},t.validateCertificate=t.validateCertificate.bind(t),t}t.default=u},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=a(0),s=c(r),l=c(a(1)),o=c(a(3)),i=c(a(2));function c(e){return e&&e.__esModule?e:{default:e}}var u=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,r.Component),function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(f,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({config:e.config,scheme:e.scheme,currentUser:e.currentUser},(function(){t.getProviderList()}))}},{key:"getProviderList",value:function(){var e=this;if(this.state.scheme&&this.state.currentUser){var t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{provider_list:!0}};o.default.glewlwydRequest("/auth/scheme/trigger/","POST",t,!0).then((function(t){e.setState({providerList:t})})).fail((function(e){i.default.sendMessage("Notification",{type:"danger",message:l.default.t("error-api-connect")})}))}}},{key:"connectProvider",value:function(e){if(this.state.scheme&&this.state.currentUser){var t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{provider:e,callback_url:window.location.href}};o.default.glewlwydRequest("/auth/scheme/trigger/","POST",t,!0).then((function(e){document.location.href=e.redirect_to})).fail((function(e){i.default.sendMessage("Notification",{type:"danger",message:l.default.t("error-api-connect")})}))}}},{key:"render",value:function(){var e=this,t=[];return this.state.providerList.forEach((function(a,n){var r;a.logo_uri?r=s.default.createElement("img",{src:a.logo_uri,alt:a.provider,className:"img-fluid logo-img"}):a.logo_fa&&(r=s.default.createElement("i",{className:a.logo_fa})),t.push(s.default.createElement("div",{key:n},s.default.createElement("hr",null),s.default.createElement("div",{className:"row"},s.default.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(){return e.connectProvider(a.provider)}},r,s.default.createElement("span",{className:"btn-icon-right"},l.default.t("login.oauth2-connect",{provider:a.provider}))))))})),s.default.createElement("div",null,s.default.createElement("div",{className:"form-group"},s.default.createElement("h5",null,l.default.t("login.oauth2-title"))),s.default.createElement("div",{className:"form-group"},t))}}]),f);function f(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,e));return t.state={config:e.config,scheme:e.scheme,currentUser:e.currentUser,providerList:[]},t.getProviderList(),t}t.default=u},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";var n=u(a(0)),r=u(a(8)),s=u(a(1)),l=u(a(9)),o=u(a(10)),i=u(a(3)),c=u(a(64));function u(e){return e&&e.__esModule?e:{default:e}}function f(e,t){t=t||window.location.href,e=e.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null}var d={fallbackLng:"en",ns:["translations"],defaultNS:"translations",backend:{loadPath:"locales/{{lng}}/{{ns}}.json"}};f("ui_locales")&&(d.lng=f("ui_locales").split(" ")[0]);try{s.default.use(l.default).use(o.default).init(d).then((function(){i.default.request("config.json").then((function(e){e.lang||(e.lang=["en","fr","nl"]),i.default.request(e.GlewlwydUrl+"config/").then((function(t){i.default.setConfig(e.GlewlwydUrl+t.api_prefix);var a=Object.assign({params:{scope:f("scope")||!1,client_id:f("client_id")||!1,callback_url:f("callback_url")||!1,scheme:f("scheme")||e.defaultScheme||!1,prompt:f("prompt")||!1,refresh_login:!!f("refresh_login"),login_hint:f("login_hint")||!1}},e,t);r.default.render(n.default.createElement(c.default,{config:a}),document.getElementById("root"))})).fail((function(e){r.default.render(n.default.createElement(c.default,{config:!1}),document.getElementById("root"))}))}))}))}catch(e){$("#root").html('<div class="alert alert-danger" role="alert"><i class="fas fa-exclamation-triangle"></i><span class="btn-icon-right">You must use a browser compatible with Glewlwyd SSO</span></div>')}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=a(0),s=g(r),l=g(a(1)),o=g(a(3)),i=g(a(2)),c=g(a(4)),u=g(a(65)),f=g(a(66)),d=g(a(70)),m=g(a(71)),h=g(a(72)),p=g(a(73));function g(e){return e&&e.__esModule?e:{default:e}}var b=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(v,r.Component),function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(v,[{key:"initProfile",value:function(){var e=this;o.default.glewlwydRequest("/profile_list").then((function(t){var a={};t.length&&(a.currentUser=t[0],a.login_hint=t[0].username),a.userList=t,a.loaded=!0,"login"===e.state.prompt?(a.currentUser=!1,a.newUser=!0):"consent"===e.state.prompt?a.forceShowGrant=!0:"select_account"===e.state.prompt?a.selectAccount=!0:"end_session"===e.state.prompt?(a.endSession=!0,a.newUser=!1,a.currentUser=!1):a.newUser=!1,e.setState(a,(function(){e.state.config.params.client_id&&e.state.config.params.scope?e.checkClientScope(e.state.config.params.client_id,e.state.config.params.scope):e.state.config.params.scope?e.checkScopeScheme(e.state.config.params.scope):e.setState({showGrantAsterisk:!1})}))})).fail((function(t){401!=t.status&&i.default.sendMessage("Notification",{type:"warning",message:l.default.t("error-api-connect")}),e.setState({newUser:!0,currentUser:!1,userList:[],loaded:!0})}))}},{key:"checkClientScope",value:function(e,t){var a=this;o.default.glewlwydRequest("/auth/grant/"+encodeURIComponent(e)+"/"+encodeURIComponent(t)).then((function(e){var n=[],r={},s=!0,c=!1;if(e.scope.length){var u=t.split(" ").length>e.scope.length;e.scope.forEach((function(e){e.granted?(s=a.state.forceShowGrant,n.push(e.name),r[e.name]=e):c=!0})),n.length?o.default.glewlwydRequest("/auth/scheme/?scope="+encodeURIComponent(n.join(" "))).then((function(t){a.setState({client:e.client,scope:e.scope,scheme:t,showGrant:s,showGrantAsterisk:c,infoSomeScopeUnavailable:u,errorScopesUnavailable:!1},(function(){a.parseSchemes()}))})).fail((function(e){i.default.sendMessage("Notification",{type:"warning",message:l.default.t("login.error-scheme-scope-api")})})):a.setState({client:e.client,scope:e.scope,showGrant:!0,showGrantAsterisk:!0,errorScopesUnavailable:!1,infoSomeScopeUnavailable:u})}else a.setState({errorScopesUnavailable:!0,infoSomeScopeUnavailable:!1})})).fail((function(e){404===e.status?i.default.sendMessage("Notification",{type:"warning",message:l.default.t("login.error-scheme-scope-unavailable")}):i.default.sendMessage("Notification",{type:"warning",message:l.default.t("login.error-grant-api")})}))}},{key:"checkScopeScheme",value:function(e){var t=this;o.default.glewlwydRequest("/auth/scheme/?scope="+e).then((function(e){t.setState({scheme:e,showGrant:!1,showGrantAsterisk:!1},(function(){t.parseSchemes()}))})).fail((function(e){404===e.status?i.default.sendMessage("Notification",{type:"warning",message:l.default.t("login.error-scheme-scope-unavailable")}):i.default.sendMessage("Notification",{type:"warning",message:l.default.t("login.error-scheme-scope-api")})}))}},{key:"parseSchemes",value:function(){var e=!!this.state.config.params.callback_url,t=!1,a=!1,n=!1,r=!1;for(var s in this.state.scheme)if(e){var l=this.state.scheme[s];if(l.available&&l.password_required&&!l.password_authenticated){n=a=!(t=!(e=!1));break}if(!a&&e)for(var o in l.schemes){var i=l.schemes[o],c=!1;if((a=i).forEach((function(e){r=!1,e.scheme_authenticated?n=a=!(c=!0):(!n||n.scheme_last_login<e.scheme_last_login)&&e.scheme_registered?n=e:e.scheme_registered||n||(r=!0)})),!c){e=!1;break}}}!t&&this.state.refresh_login&&(t=!0),e&&(n=!1),this.setState({canContinue:e,passwordRequired:t,schemeListRequired:a,scheme:n,errorScheme:!n&&!e,mustRegisterScheme:r})}},{key:"changeLang",value:function(e,t){var a=this;l.default.changeLanguage(t).then((function(){a.setState({lang:t})}))}},{key:"render",value:function(){var e=this;if(this.state.config){var t,a="";this.state.loaded&&(a=this.state.endSession?s.default.createElement(p.default,{config:this.state.config,userList:this.state.userList,currentUser:this.state.currentUser}):(this.state.mustRegisterScheme&&!this.state.errorScopesUnavailable?t=s.default.createElement("div",{className:"alert alert-warning",role:"alert"},l.default.t("login.warning-not-registered-scheme")):this.state.errorScheme&&!this.state.errorScopesUnavailable?t=s.default.createElement("div",{className:"alert alert-warning",role:"alert"},l.default.t("login.warning-error-scheme")):this.state.config.params.callback_url||(t=s.default.createElement("div",{className:"alert alert-warning",role:"alert"},l.default.t("login.warning-no-callback-url"))),this.state.errorScopesUnavailable?s.default.createElement("div",{className:"alert alert-danger",role:"alert"},l.default.t("login.error-scope-unavailable")):this.state.newUser||this.state.passwordRequired?this.state.scheme?s.default.createElement(m.default,{config:this.state.config,username:this.state.login_hint,callbackInitProfile:this.initProfile,scheme:this.state.scheme}):s.default.createElement(d.default,{config:this.state.config,username:this.state.login_hint,currentUser:this.state.currentUser,callbackInitProfile:this.initProfile}):this.state.selectAccount?s.default.createElement(h.default,{config:this.state.config,userList:this.state.userList,currentUser:this.state.currentUser}):s.default.createElement(f.default,{config:this.state.config,currentUser:this.state.currentUser,client:this.state.client,scope:this.state.scope,scheme:this.state.scheme,schemeListRequired:this.state.schemeListRequired,showGrant:this.state.showGrant,infoSomeScopeUnavailable:this.state.infoSomeScopeUnavailable})));var n=[];return this.state.config.lang.forEach((function(t,a){t===l.default.language?n.push(s.default.createElement("a",{className:"dropdown-item active",href:"#",key:a},t)):n.push(s.default.createElement("a",{className:"dropdown-item",href:"#",onClick:function(a){return e.changeLang(a,t)},key:a},t))})),s.default.createElement("div",{"aria-live":"polite","aria-atomic":"true",style:{position:"relative",minHeight:"200px"}},s.default.createElement("div",{className:"card center",id:"userCard",tabIndex:"-1",role:"dialog",style:{marginTop:"20px",marginBottom:"20px"}},s.default.createElement("div",{className:"card-header"},s.default.createElement("div",{className:"float-right"},s.default.createElement("div",{className:"dropdown"},s.default.createElement("button",{className:"btn btn-secondary dropdown-toggle",type:"button",id:"dropdownLang","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},s.default.createElement("i",{className:"fas fa-globe-africa"})),s.default.createElement("div",{className:"dropdown-menu","aria-labelledby":"dropdownLang"},n))),s.default.createElement("h2",null,s.default.createElement("img",{className:"mr-3",src:"img/logo-login.png",alt:"logo"}),l.default.t("login.menu-title"))),t,s.default.createElement("div",{className:"card-body"},a),s.default.createElement("div",{className:"card-footer"},s.default.createElement(u.default,{config:this.state.config,currentUser:this.state.currentUser,userList:this.state.userList,showGrant:this.state.showGrant,showGrantAsterisk:this.state.showGrantAsterisk,newUser:this.state.newUser,newUserScheme:this.state.scheme,canContinue:this.state.canContinue,schemeListRequired:this.state.schemeListRequired}))),s.default.createElement(c.default,null))}return s.default.createElement("div",{"aria-live":"polite","aria-atomic":"true",style:{position:"relative",minHeight:"200px"}},s.default.createElement("div",{className:"card center",id:"userCard",tabIndex:"-1",role:"dialog",style:{marginTop:"20px",marginBottom:"20px"}},s.default.createElement("div",{className:"card-header"},s.default.createElement("h4",null,s.default.createElement("span",{className:"badge badge-danger"},l.default.t("error-api-connect"))))))}}]),v);function v(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(v.__proto__||Object.getPrototypeOf(v)).call(this,e));return t.state={newUser:!1,userList:[],currentUser:!1,config:e.config,loaded:!1,lang:l.default.language,scope:[],mustRegisterScheme:!1,scheme:e.config.params.scheme,schemeListRequired:!1,passwordRequired:!1,client:!1,showGrant:!0,showGrantAsterisk:!1,canContinue:!1,prompt:e.config.params.prompt,refresh_login:e.config.params.refresh_login,forceShowGrant:!1,selectAccount:!1,endSession:!1,login_hint:e.config.params.login_hint||"",errorScopesUnavailable:!1,infoSomeScopeUnavailable:!1,errorScheme:!1},t.initProfile=t.initProfile.bind(t),t.checkClientScope=t.checkClientScope.bind(t),t.checkScopeScheme=t.checkScopeScheme.bind(t),t.changeLang=t.changeLang.bind(t),t.parseSchemes=t.parseSchemes.bind(t),t.state.config&&t.initProfile(),i.default.subscribe("App",(function(e){"InitProfile"===e.type?t.initProfile():"loginSuccess"===e.type?t.setState({selectAccount:!1,refresh_login:!1,prompt:!1},(function(){t.initProfile()})):"NewUser"===e.type?t.setState({selectAccount:!1,newUser:!0,currentUser:!1,scheme:t.state.config.params.scheme},(function(){})):"GrantComplete"===e.type?t.setState({selectAccount:!1,showGrant:!1,prompt:!1,forceShowGrant:!1},(function(){t.initProfile()})):"SelectAccount"===e.type?t.setState({selectAccount:!0},(function(){t.initProfile()})):"SelectAccountComplete"===e.type?t.setState({selectAccount:!1,prompt:!1},(function(){t.initProfile()})):"ToggleGrant"===e.type?t.setState({showGrant:!t.state.showGrant}):"newUserScheme"===e.type&&t.setState({scheme:e.scheme})})),t}t.default=b},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=a(0),s=c(r),l=c(a(1)),o=c(a(3)),i=c(a(2));function c(e){return e&&e.__esModule?e:{default:e}}var u=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,r.Component),function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(f,[{key:"componentWillReceiveProps",value:function(e){this.setState({userList:e.userList,currentUser:e.currentUser,config:e.config,showGrant:e.showGrant,newUser:e.newUser,newUserScheme:e.newUserScheme,canContinue:e.canContinue,schemeListRequired:e.schemeListRequired,bGrantTitle:e.showGrant?l.default.t("login.grant-auth-title"):l.default.t("login.grant-change-title"),bGrant:e.showGrant?l.default.t("login.grant-auth"):l.default.t("login.grant-change"),showGrantAsterisk:e.showGrantAsterisk})}},{key:"clickLogout",value:function(){o.default.glewlwydRequest("/auth/","DELETE").then((function(){i.default.sendMessage("App",{type:"InitProfile"})})).fail((function(){i.default.sendMessage("Notification",{type:"danger",message:l.default.t("login.error-delete-session")}),i.default.sendMessage("App",{type:"InitProfile"})}))}},{key:"clickGrant",value:function(){i.default.sendMessage("App",{type:"ToggleGrant"})}},{key:"clickContinue",value:function(){this.state.config.params.callback_url&&(document.location.href=this.state.config.params.callback_url+(0<this.state.config.params.callback_url.indexOf("?")?"&g_continue":"?g_continue"))}},{key:"newUser",value:function(e,t){e.preventDefault(),t?o.default.glewlwydRequest("/auth/","POST",{username:t}).then((function(){i.default.sendMessage("App",{type:"InitProfile"})})).fail((function(){i.default.sendMessage("Notification",{type:"danger",message:l.default.t("login.error-login")})})):i.default.sendMessage("App",{type:"NewUser"})}},{key:"registerNewUser",value:function(e,t){e.preventDefault(),document.location.href=this.state.config.ProfileUrl+"?register="+encodeURIComponent(t)}},{key:"managerUsers",value:function(e){e.preventDefault(),i.default.sendMessage("App",{type:"SelectAccount"})}},{key:"changeSessionScheme",value:function(e,t){e.preventDefault(),i.default.sendMessage("App",{type:"newUserScheme",scheme:t})}},{key:"render",value:function(){var e=this,t="",a="",n="",r=[];if(this.state.canContinue&&(n=s.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.clickContinue,title:l.default.t("login.continue-title")},s.default.createElement("i",{className:"fas fa-play btn-icon"}),l.default.t("login.continue"))),s.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.clickGrant,title:this.state.bGrantTitle||""},s.default.createElement("i",{className:"fas fa-user-cog btn-icon"}),this.state.bGrant),this.state.showGrantAsterisk&&(a=s.default.createElement("small",null,s.default.createElement("i",{className:"fas fa-asterisk btn-icon-right"}))),this.state.currentUser){this.state.config.register&&this.state.config.register.forEach((function(t,a){r.push(s.default.createElement("a",{key:a,className:"dropdown-item",href:"#",onClick:function(a){return e.registerNewUser(a,t.name)}},l.default.t(t.message)))}));var o=[];return this.state.userList&&this.state.userList.forEach((function(t,a){e.state.currentUser.username===t.username?o.push(s.default.createElement("a",{className:"dropdown-item active",href:"#",onClick:function(a){return e.newUser(a,t.username)},key:a,alt:t.name||t.username},t.name||t.username)):o.push(s.default.createElement("a",{className:"dropdown-item",href:"#",onClick:function(a){return e.newUser(a,t.username)},key:a,alt:t.name||t.username},t.name||t.username))})),t=s.default.createElement("div",{className:"btn-group",role:"group"},s.default.createElement("button",{className:"btn btn-primary dropdown-toggle",type:"button",id:"selectNewUser","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},s.default.createElement("i",{className:"fas fa-users btn-icon"}),l.default.t("login.login-another")),s.default.createElement("div",{className:"dropdown-menu","aria-labelledby":"selectNewUser"},s.default.createElement("a",{className:"dropdown-item",href:"#",onClick:function(t){return e.newUser(t,!1)}},l.default.t("login.login-another-new")),s.default.createElement("a",{className:"dropdown-item",href:"#",onClick:function(t){return e.managerUsers(t)}},l.default.t("login.manage-users")),r,s.default.createElement("div",{className:"dropdown-divider"}),o)),s.default.createElement("div",null,s.default.createElement("div",{className:"btn-group",role:"group"},n,s.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.clickLogout},s.default.createElement("i",{className:"fas fa-sign-out-alt btn-icon"}),l.default.t("login.logout"))),s.default.createElement("hr",null),s.default.createElement("div",{className:"btn-group",role:"group"},s.default.createElement("div",{className:"btn-group",role:"group"},s.default.createElement("button",{className:"btn btn-primary dropdown-toggle",type:"button",id:"selectGrant","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},s.default.createElement("i",{className:"fas fa-user-cog btn-icon"}),l.default.t("login.login-handle"),a),s.default.createElement("div",{className:"dropdown-menu","aria-labelledby":"selectGrant"},s.default.createElement("a",{className:"dropdown-item",href:"#",onClick:this.clickGrant,alt:this.state.bGrantTitle},this.state.bGrant,a),s.default.createElement("div",{className:"dropdown-divider"}),s.default.createElement("a",{className:"dropdown-item",href:this.state.config.ProfileUrl||"",target:"_blank"},l.default.t("login.update-profile")))),t))}if(this.state.newUser){this.state.config.register&&this.state.config.register.forEach((function(t,a){r.push(s.default.createElement("button",{key:a,type:"button",className:"btn btn-primary",onClick:function(a){return e.registerNewUser(a,t.name)}},l.default.t(t.message)))}));var i=[];return this.state.config.sessionSchemes&&this.state.config.sessionSchemes.length?(this.state.newUserScheme?i.push(s.default.createElement("a",{key:0,className:"dropdown-item",href:"#",onClick:function(t){return e.changeSessionScheme(t,!1)},alt:l.default.t("login.password-title")},l.default.t("login.password-title"))):i.push(s.default.createElement("a",{key:0,className:"dropdown-item active",href:"#",onClick:function(t){return e.changeSessionScheme(t,!1)},alt:l.default.t("login.password-title")},l.default.t("login.password-title"))),i.push(s.default.createElement("div",{key:1,className:"dropdown-divider"})),this.state.config.sessionSchemes.forEach((function(t,a){!1!==t.show_nopassword_form&&(t.scheme_name===e.state.newUserScheme?i.push(s.default.createElement("a",{key:a+2,className:"dropdown-item active",href:"#",onClick:function(a){return e.changeSessionScheme(a,t.scheme_name)},alt:l.default.t(t.scheme_display_name)},l.default.t(t.scheme_display_name))):i.push(s.default.createElement("a",{key:a+2,className:"dropdown-item",href:"#",onClick:function(a){return e.changeSessionScheme(a,t.scheme_name)},alt:l.default.t(t.scheme_display_name)},l.default.t(t.scheme_display_name))))})),s.default.createElement("div",{className:"btn-group",role:"group"},s.default.createElement("div",{className:"btn-group",role:"group"},s.default.createElement("button",{className:"btn btn-primary dropdown-toggle",type:"button",id:"selectScheme","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},s.default.createElement("i",{className:"fas fa-user-lock btn-icon"}),l.default.t("login.login-choose-scheme")),s.default.createElement("div",{className:"dropdown-menu","aria-labelledby":"selectScheme"},i)),r)):s.default.createElement("div",null,r)}return""}}]),f);function f(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,e));return t.state={config:e.config,userList:e.userList,currentUser:e.currentUser,newUser:e.newUser,newUserScheme:e.newUserScheme,canContinue:e.canContinue,showGrant:e.showGrant,schemeListRequired:e.schemeListRequired,bGrantTitle:e.showGrant?l.default.t("login.grant-auth-title"):l.default.t("login.grant-change-title"),bGrant:e.showGrant?l.default.t("login.grant-auth"):l.default.t("login.grant-change"),showGrantAsterisk:e.showGrantAsterisk},t.clickLogout=t.clickLogout.bind(t),t.clickGrant=t.clickGrant.bind(t),t.clickContinue=t.clickContinue.bind(t),t.newUser=t.newUser.bind(t),t.managerUsers=t.managerUsers.bind(t),t.changeSessionScheme=t.changeSessionScheme.bind(t),t.registerNewUser=t.registerNewUser.bind(t),t}t.default=u},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=a(0),s=u(r),l=u(a(1)),o=(u(a(3)),u(a(2))),i=u(a(67)),c=u(a(68));function u(e){return e&&e.__esModule?e:{default:e}}var f=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(d,r.Component),function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(d,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,currentUser:e.currentUser,client:e.client,scope:e.scope,scheme:e.scheme,schemeListRequired:e.schemeListRequired,showGrant:e.showGrant,infoSomeScopeUnavailable:e.infoSomeScopeUnavailable})}},{key:"render",value:function(){var e,t;if(e=this.state.showGrant?s.default.createElement("div",{id:"carouselBody",className:"carousel slide","data-ride":"carousel"},s.default.createElement("div",{className:"carousel-inner"},s.default.createElement("div",{className:"carousel-item"+(this.state.showGrant?" active":"")},s.default.createElement(i.default,{config:this.state.config,currentUser:this.state.currentUser,client:this.state.client,scope:this.state.scope,infoSomeScopeUnavailable:this.state.infoSomeScopeUnavailable})))):s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"col-md-12"},s.default.createElement(c.default,{config:this.state.config,currentUser:this.state.currentUser,scheme:this.state.scheme,schemeListRequired:this.state.schemeListRequired,client:this.state.client}))),this.state.config.profilePicture&&this.state.currentUser[this.state.config.profilePicture.property]){var a=this.state.currentUser[this.state.config.profilePicture.property];Array.isArray(a)&&(a=a[0]),t=s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"col-md-12 text-center"},s.default.createElement("img",{className:"btn-icon-right img-medium",src:"data:"+this.state.config.profilePicture.type+";base64,"+a,alt:this.state.config.profilePicture.property})))}return s.default.createElement("div",null,t,s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"col-md-12 text-center"},s.default.createElement("h4",null,l.default.t("login.hello",{name:this.state.currentUser.name||this.state.currentUser.username})))),s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"col-md-12"},s.default.createElement("hr",null))),e)}}]),d);function d(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,e));return t.state={config:e.config,currentUser:e.currentUser,client:e.client,scope:e.scope,scheme:e.scheme,schemeListRequired:e.schemeListRequired,showGrant:e.showGrant,infoSomeScopeUnavailable:e.infoSomeScopeUnavailable},o.default.subscribe("Body",(function(e){})),t}t.default=f},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=a(0),s=c(r),l=c(a(1)),o=c(a(3)),i=c(a(2));function c(e){return e&&e.__esModule?e:{default:e}}var u=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,r.Component),function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(f,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,currentUser:e.currentUser,client:e.client,scope:e.scope,show:e.show,infoSomeScopeUnavailable:e.infoSomeScopeUnavailable})}},{key:"handleToggleGrantScope",value:function(e){var t=this.state.scope;t.forEach((function(t){t.name===e.name&&(t.granted=!t.granted)})),this.setState({scope:t})}},{key:"handleGrantScope",value:function(){var e=[];this.state.scope.forEach((function(t){t.granted&&e.push(t.name)})),o.default.glewlwydRequest("/auth/grant/"+encodeURIComponent(this.state.client.client_id),"PUT",{scope:e.join(" ")}).then((function(){i.default.sendMessage("App",{type:"GrantComplete"})})).fail((function(){i.default.sendMessage("Notification",{type:"danger",message:l.default.t("login.error-set-grant")})}))}},{key:"render",value:function(){var e,t=this,a=[];return this.state.scope.forEach((function(e,n){a.push(s.default.createElement("li",{className:"list-group-item",key:n},s.default.createElement("div",{className:"form-group form-check"},s.default.createElement("input",{type:"checkbox",className:"form-check-input",onChange:function(){return t.handleToggleGrantScope(e)},id:"grant-"+e.name,checked:e.granted}),s.default.createElement("label",{className:"form-check-label",htmlFor:"grant-"+e.name},e.display_name))))})),this.state.infoSomeScopeUnavailable&&(e=s.default.createElement("div",{className:"alert alert-info",role:"alert"},l.default.t("login.info-some-scope-unavailable"))),s.default.createElement("div",null,s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"col-md-12"},s.default.createElement("h4",null,l.default.t("login.grant-title",{client:this.state.client.name})))),s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"col-md-12"},s.default.createElement("ul",{className:"list-group"},a))),s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"col-md-12"},e)),s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"col-md-12"},s.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.handleGrantScope},l.default.t("login.grant")))),s.default.createElement("hr",null),s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"col-md-12"},s.default.createElement("h5",null,l.default.t("login.grant-info-message")))))}}]),f);function f(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,e));return t.state={config:e.config,currentUser:e.currentUser,client:e.client,scope:e.scope,show:e.show,infoSomeScopeUnavailable:e.infoSomeScopeUnavailable},t.handleToggleGrantScope=t.handleToggleGrantScope.bind(t),t.handleGrantScope=t.handleGrantScope.bind(t),i.default.subscribe("GrantScope",(function(e){})),t}t.default=u},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=a(0),s=i(r),l=i(a(1)),o=(i(a(3)),i(a(2)),i(a(69)));function i(e){return e&&e.__esModule?e:{default:e}}var c=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(u,r.Component),function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(u,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,scheme:e.scheme,schemeListRequired:e.schemeListRequired,client:e.client,currentUser:e.currentUser,canContinue:!e.scheme,show:e.show})}},{key:"handleSelectScheme",value:function(e,t){e.preventDefault(),this.setState({scheme:t})}},{key:"render",value:function(){var e,t=this;if(this.state.canContinue)return e=this.state.client?l.default.t("login.connect-to",{client:this.state.client.name||this.state.client.client_id}):l.default.t("login.connection"),s.default.createElement("div",null,s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"col-md-12"},s.default.createElement("h3",null,e))),s.default.createElement("hr",null),s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"col-md-12"},s.default.createElement("h4",null,l.default.t("login.wish-message")))));var a="",n="",r=[];return this.state.scheme&&(a=s.default.createElement(o.default,{config:this.state.config,scheme:this.state.scheme,currentUser:this.state.currentUser}),n=s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"col-md-12"},s.default.createElement("hr",null)))),this.state.schemeListRequired&&this.state.schemeListRequired.forEach((function(e,a){r.push(s.default.createElement("a",{className:"dropdown-item",key:a,href:"#",onClick:function(a){return t.handleSelectScheme(a,e)}},e.scheme_display_name))})),s.default.createElement("div",null,a,n,s.default.createElement("div",{className:"btn-group",role:"group"},s.default.createElement("button",{className:"btn btn-primary dropdown-toggle",type:"button",id:"selectScheme","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},s.default.createElement("i",{className:"fas fa-user-lock btn-icon"}),l.default.t("login.login-choose-scheme")),s.default.createElement("div",{className:"dropdown-menu","aria-labelledby":"selectScheme"},r)))}}]),u);function u(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,e));return t.state={config:e.config,scheme:e.scheme,schemeListRequired:e.schemeListRequired,client:e.client,currentUser:e.currentUser,canContinue:!e.scheme,show:e.show},t.handleSelectScheme=t.handleSelectScheme.bind(t),t}t.default=c},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=a(0),s=m(r),l=(m(a(1)),m(a(3)),m(a(2)),m(a(15))),o=m(a(16)),i=m(a(17)),c=m(a(18)),u=m(a(19)),f=m(a(20)),d=m(a(21));function m(e){return e&&e.__esModule?e:{default:e}}var h=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(p,r.Component),function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(p,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,scheme:e.scheme,currentUser:e.currentUser})}},{key:"render",value:function(){return"mock"===this.state.scheme.scheme_type?s.default.createElement(l.default,{config:this.state.config,scheme:this.state.scheme,currentUser:this.state.currentUser}):"email"===this.state.scheme.scheme_type?s.default.createElement(o.default,{config:this.state.config,scheme:this.state.scheme,currentUser:this.state.currentUser}):"webauthn"===this.state.scheme.scheme_type?s.default.createElement(i.default,{config:this.state.config,scheme:this.state.scheme,currentUser:this.state.currentUser}):"otp"===this.state.scheme.scheme_type?s.default.createElement(c.default,{config:this.state.config,scheme:this.state.scheme,currentUser:this.state.currentUser}):"retype-password"===this.state.scheme.scheme_type||"http"===this.state.scheme.scheme_type?s.default.createElement(u.default,{config:this.state.config,scheme:this.state.scheme,currentUser:this.state.currentUser}):"certificate"===this.state.scheme.scheme_type?s.default.createElement(f.default,{config:this.state.config,scheme:this.state.scheme,currentUser:this.state.currentUser}):"oauth2"===this.state.scheme.scheme_type?s.default.createElement(d.default,{config:this.state.config,scheme:this.state.scheme,currentUser:this.state.currentUser}):""}}]),p);function p(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(p.__proto__||Object.getPrototypeOf(p)).call(this,e));return t.state={config:e.config,scheme:e.scheme,currentUser:e.currentUser},t}t.default=h},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=a(0),s=c(r),l=c(a(1)),o=c(a(3)),i=c(a(2));function c(e){return e&&e.__esModule?e:{default:e}}var u=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,r.Component),function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(f,[{key:"componentWillReceiveProps",value:function(e){this.setState({username:e.username,password:"",config:e.config,currentUser:e.currentUser})}},{key:"handleChangeUsername",value:function(e){this.setState({username:e.target.value})}},{key:"handleChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"validateLogin",value:function(e){if(e.preventDefault(),this.state.username&&this.state.password){var t={username:this.state.username,password:this.state.password};o.default.glewlwydRequest("/auth/","POST",t).then((function(){i.default.sendMessage("App",{type:"loginSuccess"})})).fail((function(){i.default.sendMessage("Notification",{type:"danger",message:l.default.t("login.error-login")})}))}}},{key:"render",value:function(){var e,t=this;return e=this.state.currentUser?s.default.createElement("input",{type:"text",className:"form-control",name:"username",id:"username",disabled:!0,value:this.state.currentUser.username}):s.default.createElement("input",{type:"text",className:"form-control",name:"username",id:"username",required:"",placeholder:l.default.t("login.login-placeholder"),value:this.state.username,onChange:this.handleChangeUsername,autoFocus:!0}),s.default.createElement("form",{action:"#",id:"passwordForm"},s.default.createElement("div",{className:"form-group"},s.default.createElement("h4",null,l.default.t("login.enter-login-password"))),s.default.createElement("div",{className:"form-group"},s.default.createElement("div",{className:"input-group mb-3"},s.default.createElement("div",{className:"input-group-prepend"},s.default.createElement("label",{className:"input-group-text",htmlFor:"username"},l.default.t("login.login"))),e)),s.default.createElement("div",{className:"form-group"},s.default.createElement("div",{className:"input-group mb-3"},s.default.createElement("div",{className:"input-group-prepend"},s.default.createElement("label",{className:"input-group-text",htmlFor:"password"},l.default.t("login.password"))),s.default.createElement("input",{type:"password",className:"form-control",name:"password",id:"password",required:"",placeholder:l.default.t("login.password-placeholder"),value:this.state.password,onChange:this.handleChangePassword,autoFocus:!!this.state.currentUser}))),s.default.createElement("button",{type:"submit",name:"loginbut",id:"loginbut",className:"btn btn-primary",onClick:function(e){return t.validateLogin(e)},title:l.default.t("login.sign-in-title")},l.default.t("login.btn-ok")))}}]),f);function f(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,e));return t.state={username:e.username,password:"",config:e.config,currentUser:e.currentUser},t.handleChangeUsername=t.handleChangeUsername.bind(t),t.handleChangePassword=t.handleChangePassword.bind(t),t.validateLogin=t.validateLogin.bind(t),t}t.default=u},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=a(0),s=h(r),l=h(a(1)),o=(h(a(3)),h(a(2)),h(a(15))),i=h(a(16)),c=h(a(17)),u=h(a(18)),f=h(a(19)),d=h(a(20)),m=h(a(21));function h(e){return e&&e.__esModule?e:{default:e}}var p=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(g,r.Component),function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(g,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,username:e.username,scheme:e.scheme})}},{key:"handleChangeUsername",value:function(e){this.setState({username:e.target.value})}},{key:"validateUsername",value:function(e){e.preventDefault(),this.state.username&&this.setState({usernameValidated:!0})}},{key:"render",value:function(){var e=this;if(this.state.usernameValidated){var t=!1;return this.state.config.sessionSchemes.forEach((function(a){a.scheme_name===e.state.scheme&&(t="mock"===a.scheme_type?s.default.createElement(o.default,{config:e.state.config,scheme:a,currentUser:{username:e.state.username}}):"email"===a.scheme_type?s.default.createElement(i.default,{config:e.state.config,scheme:a,currentUser:{username:e.state.username}}):"webauthn"===a.scheme_type?s.default.createElement(c.default,{config:e.state.config,scheme:a,currentUser:{username:e.state.username}}):"otp"===a.scheme_type?s.default.createElement(u.default,{config:e.state.config,scheme:a,currentUser:{username:e.state.username}}):"retype-password"===a.scheme_type||"http"===a.scheme_type?s.default.createElement(f.default,{config:e.state.config,scheme:a,currentUser:{username:e.state.username}}):"certificate"===a.scheme_type?s.default.createElement(d.default,{config:e.state.config,scheme:a,currentUser:{username:e.state.username}}):"oauth2"===a.scheme_type?s.default.createElement(m.default,{config:e.state.config,scheme:a,currentUser:{username:e.state.username}}):s.default.createElement("div",null,"No can do"))})),s.default.createElement("div",null,s.default.createElement("div",{className:"form-group"},s.default.createElement("h4",null,l.default.t("login.welcome-login",{username:this.state.username}))),s.default.createElement("div",{className:"form-group"},t),s.default.createElement("div",{className:"form-group"}))}return s.default.createElement("form",{action:"#",id:"passwordForm"},s.default.createElement("div",{className:"form-group"},s.default.createElement("h4",null,l.default.t("login.enter-login"))),s.default.createElement("div",{className:"form-group"},s.default.createElement("div",{className:"input-group mb-3"},s.default.createElement("div",{className:"input-group-prepend"},s.default.createElement("label",{className:"input-group-text",htmlFor:"username"},l.default.t("login.login"))),s.default.createElement("input",function(e,t,a){return t in e?Object.defineProperty(e,t,{value:!0,enumerable:!0,configurable:!0,writable:!0}):e[t]=!0,e}({type:"text",className:"form-control",name:"username",id:"username",autoFocus:!0,required:"",placeholder:l.default.t("login.login-placeholder"),value:this.state.username,onChange:this.handleChangeUsername},"autoFocus")))),s.default.createElement("button",{type:"submit",name:"usernamebut",id:"usernamebut",className:"btn btn-primary",onClick:function(t){return e.validateUsername(t)},title:l.default.t("login.sign-in-title")},l.default.t("login.btn-ok")))}}]),g);function g(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,g);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,e));return t.state={config:e.config,username:e.username,usernameValidated:!1,scheme:e.scheme},t.handleChangeUsername=t.handleChangeUsername.bind(t),t.validateUsername=t.validateUsername.bind(t),t}t.default=p},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=a(0),s=c(r),l=c(a(1)),o=c(a(3)),i=c(a(2));function c(e){return e&&e.__esModule?e:{default:e}}var u=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,r.Component),function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(f,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState({config:e.config,userList:e.userList||[],currentUser:e.currentUser||[]})}},{key:"handleSelectAccount",value:function(){o.default.glewlwydRequest("/auth/","POST",{username:this.state.currentUser.username}).then((function(){i.default.sendMessage("App",{type:"SelectAccountComplete"})})).fail((function(){i.default.sendMessage("Notification",{type:"danger",message:l.default.t("login.error-login")})}))}},{key:"handleToggleGrantScope",value:function(e){this.setState({currentUser:e})}},{key:"handleNewAccount",value:function(){i.default.sendMessage("App",{type:"NewUser"})}},{key:"handleLogoutAccount",value:function(e){var t=this;o.default.glewlwydRequest("/auth/?username="+e,"DELETE").then((function(){var a=t.state.userList;a.forEach((function(t,n){t.username===e&&a.splice(n,1)})),t.setState({userList:a})})).fail((function(){i.default.sendMessage("Notification",{type:"danger",message:l.default.t("login.error-login")})}))}},{key:"render",value:function(){var e=this,t=[];return this.state.userList.forEach((function(a,n){var r;if(e.state.config.profilePicture&&a[e.state.config.profilePicture.userProperty]){var o=a[e.state.config.profilePicture.userProperty];Array.isArray(o)&&(o=o[0]),r=s.default.createElement("div",null,s.default.createElement("input",{type:"radio",className:"input-hidden",onChange:function(){return e.handleToggleGrantScope(a)},name:"select-user",id:"select-user-"+a.username,checked:i}),s.default.createElement("label",{htmlFor:"select-user-"+a.username},s.default.createElement("img",{className:"img-thumb",src:"data:"+e.state.config.profilePicture.type+";base64,"+o,alt:e.state.config.profilePicture.userProperty})))}else r=s.default.createElement("input",{type:"radio",className:"form-control",onChange:function(){return e.handleToggleGrantScope(a)},name:"select-user",id:"select-user-"+a.username,checked:i});var i=a.username===e.state.currentUser.username;t.push(s.default.createElement("li",{className:"list-group-item"+(i?" active":""),key:n},s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"col"},s.default.createElement("div",{className:"input-group mb-3"},s.default.createElement("div",{className:"input-group-prepend"},r),s.default.createElement("div",{className:"btn-icon-right"},s.default.createElement("label",{className:"form-check-label",htmlFor:"select-user-"+a.username},a.name||a.username)))),s.default.createElement("div",{className:"col text-right"},s.default.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(){return e.handleLogoutAccount(a.username)}},l.default.t("login.logout"))))))})),s.default.createElement("div",null,s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"col-md-12"},s.default.createElement("h4",null,l.default.t("login.select-acount-title")))),s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"col-md-12"},s.default.createElement("ul",{className:"list-group"},t))),s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"col-md-12"},s.default.createElement("hr",null))),s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"col-md-12"},s.default.createElement("div",{className:"btn-group",role:"group"},s.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.handleSelectAccount},l.default.t("login.select")),s.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.handleNewAccount},l.default.t("login.login-another-new"))))),s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"col-md-12"},s.default.createElement("hr",null))))}}]),f);function f(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,e));return t.state={config:e.config,userList:e.userList||[],currentUser:e.currentUser||[]},t.handleSelectAccount=t.handleSelectAccount.bind(t),t.handleToggleGrantScope=t.handleToggleGrantScope.bind(t),t.handleNewAccount=t.handleNewAccount.bind(t),t.handleLogoutAccount=t.handleLogoutAccount.bind(t),t}t.default=u},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=a(0),s=c(r),l=c(a(1)),o=c(a(3)),i=c(a(2));function c(e){return e&&e.__esModule?e:{default:e}}var u=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,r.Component),function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(f,[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,userList:e.userList||[],currentUser:e.currentUser||[]})}},{key:"handleLogout",value:function(){var e=this;o.default.glewlwydRequest("/auth/","DELETE").fail((function(){i.default.sendMessage("Notification",{type:"danger",message:l.default.t("login.error-delete-session")})})).always((function(){e.state.config.params.callback_url&&(document.location.href=e.state.config.params.callback_url)}))}},{key:"handleIgnoreLogout",value:function(){document.location.href=this.state.config.params.callback_url}},{key:"render",value:function(){var e;return this.state.config.params.callback_url&&(e=s.default.createElement("button",{type:"button",className:"btn btn-primary btn-icon-right",onClick:this.handleIgnoreLogout},l.default.t("login.ignore-logout"))),s.default.createElement("div",null,s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"col-md-12"},s.default.createElement("h3",null,l.default.t("login.end-session-title")))),s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"col-md-12"},s.default.createElement("h4",null,l.default.t("login.end-session-message")))),s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"col-md-12"},s.default.createElement("hr",null))),s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"col-md-12"},s.default.createElement("button",{type:"button",className:"btn btn-primary btn-icon",onClick:this.handleLogout},s.default.createElement("i",{className:"fas fa-sign-out-alt btn-icon"}),l.default.t("login.logout")),e)))}}]),f);function f(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,e));return t.state={config:e.config,userList:e.userList||[],currentUser:e.currentUser||[]},t.handleLogout=t.handleLogout.bind(t),t.handleIgnoreLogout=t.handleIgnoreLogout.bind(t),t}t.default=u}])}));